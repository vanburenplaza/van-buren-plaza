/*! For license information please see 49.05c06851d0b0470cefae.js.LICENSE.txt */
(self.webpackChunkrm_frontend=self.webpackChunkrm_frontend||[]).push([[49],{1069:function(t,e,i){var n={"./":[1010,20,36,22,37,29,28,32,35,34,39,26],"./add-to-cart":[1011,28],"./add-to-cart.js":[1011,28],"./audio":[1014,29],"./audio.js":[1014,29],"./background":[1018],"./background.js":[1018],"./button":[1023],"./button.js":[1023],"./e-commerce-cart":[1025,30],"./e-commerce-cart.js":[1025,30],"./facebook":[1027,31],"./facebook.js":[1027,31],"./form":[1029,32],"./form.js":[1029,32],"./gmaps":[1032,33],"./gmaps.js":[1032,33],"./hotspot":[1033,34],"./hotspot.js":[1033,34],"./iframe":[1039,36,35],"./iframe.js":[1039,36,35],"./index":[1010,20,36,22,37,29,28,32,35,34,39,26],"./index.js":[1010,20,36,22,37,29,28,32,35,34,39,26],"./loader":[1068],"./loader.ts":[1068],"./picture":[1031],"./picture.js":[1031],"./rm-footer":[1056,20,23],"./rm-footer.js":[1056,20,23],"./rm-header":[1049,20,22,39],"./rm-header.js":[1049,20,22,39],"./shape":[1043],"./shape.js":[1043],"./shots":[1058,27],"./shots.tsx":[1058,27],"./slideshow":[1044,37],"./slideshow.js":[1044,37],"./text":[1046],"./text-v2":[1037],"./text-v2.js":[1037],"./text-v3":[1038],"./text-v3.tsx":[1038],"./text.ts":[1046],"./twitter":[1047,38],"./twitter.js":[1047,38],"./video":[1021],"./video.js":[1021]};function r(t){if(!i.o(n,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=n[t],r=e[0];return Promise.all(e.slice(1).map(i.e)).then((function(){return i(r)}))}r.keys=function(){return Object.keys(n)},r.id=1069,t.exports=r},683:function(t,e,i){"use strict";i.d(e,{wF:function(){return n}});i(351);var n="textIndent"},668:function(t,e,i){"use strict";i.d(e,{fB:function(){return r},z3:function(){return a}});var n=i(351);i(620),i(655),i(653);var r="lineHeight",a=function(t){var e=t.block,i=t.editorState,a=t.lineHeight;return n.Z.setBlockData({editorState:i,block:e,key:r,value:a})}},669:function(t,e,i){"use strict";i.d(e,{gg:function(){return n}});i(351);var n="paddings"},722:function(t,e,i){"use strict";i.d(e,{Yv:function(){return r},w7:function(){return a}});var n=i(351),r="sizesLinkedStatus",a=function(t){var e=t.block,i=t.editorState,a=t.linkedStatus;return n.Z.setBlockData({editorState:i,block:e,key:r,value:a})}},621:function(t,e,i){"use strict";i.d(e,{Hb:function(){return l},m7:function(){return c},AJ:function(){return d},Oh:function(){return u}});var n=i(622),r=i(351);function a(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function o(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(Object(i),!0).forEach((function(e){s(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var c,l="align";!function(t){t.AlignLeft="align-left",t.AlignCenter="align-center",t.AlignRight="align-right",t.AlignJustify="align-justify"}(c||(c={}));var d=o(o(o(o({},(0,n.w)({className:c.AlignLeft,label:"Left",styles:"\n      text-align: left !important;\n    "})),(0,n.w)({className:c.AlignCenter,label:"Center",styles:"\n      text-align: center !important;\n    "})),(0,n.w)({className:c.AlignRight,label:"Right",styles:"\n      text-align: right !important;\n    "})),(0,n.w)({className:c.AlignJustify,label:"Justify",styles:"\n      text-align: justify !important;\n      ".concat(Modernizr.safari?"white-space: normal !important;":"","\n    ")})),u=function(t){var e=t.block,i=t.editorState,n=t.align;return r.Z.setBlockData({editorState:i,block:e,key:l,value:n})}},622:function(t,e,i){"use strict";i.d(e,{w:function(){return n}});var n=function(t){var e,i,n,r=t.className,a=t.selector,o=t.label,s=t.styles,c=String(r||a);return e={},i=c,n={label:o,style:"".concat(a||"."+r," { ").concat(s," }")},i in e?Object.defineProperty(e,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[i]=n,e}},982:function(t,e,i){"use strict";i.d(e,{T:function(){return l}});i(352),i(440);var n=i(621),r=i(659),a=i(620);i(655),i(983);function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach((function(e){c(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function c(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var l=s(s(s({},n.AJ),r.pb),a.Wo)},659:function(t,e,i){"use strict";i.d(e,{iC:function(){return g},Hf:function(){return m},dY:function(){return f},pb:function(){return v},iZ:function(){return b},nq:function(){return w},XZ:function(){return S}});var n,r=i(352),a=i.n(r),o=i(622),s=i(351),c=i(660);function l(){return(l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function d(t,e){if(null==t)return{};var i,n,r=function(t,e){if(null==t)return{};var i,n,r={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(r[i]=t[i]);return r}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(r[i]=t[i])}return r}function u(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function h(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?u(Object(i),!0).forEach((function(e){p(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):u(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function p(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var f,g="listStyle",m="ordered-key";!function(t){t.Unordered="unordered-list-item",t.Ordered="ordered-list-item"}(f||(f={}));p(n={},f.Unordered,{element:"li"}),p(n,f.Ordered,{element:"li"});var v=h(h({},(0,o.w)({className:f.Unordered,label:"Unordered list",styles:'\n      padding: 0;\n      margin: 0;\n      list-style-type: none;\n\n      div[data-offset-key]:before, & > li:before {\n        content: "• ";\n      }\n    '})),(0,o.w)({className:f.Ordered,label:"Ordered list",styles:"\n      padding: 0;\n      margin: 0;\n      list-style-type: none;\n\n      div[data-offset-key]:before, & > li:before {\n        counter-increment: ".concat(m,";\n        content: counter(").concat(m,')".";\n      }\n    ')})),y=function(t){var e=t.children,i=t.type,n=d(t,["children","type"]);return i===f.Ordered?a().createElement("ol",l({style:{counterReset:m}},n),e):a().createElement("ul",n,e)},b=(0,c.default)((function(t){var e=t.children,i=d(t,["children"]);return a().createElement(y,i,a().createElement("li",null,e))})).withConfig({displayName:"list__ListViewerWrapper"})([""]),w=function(t){return t===f.Ordered||t===f.Unordered},S=function(t){var e=t.editorState,i=t.block,n=s.Z.getBlockData({editorState:e,block:i,key:g});return"string"==typeof n?n:""}},620:function(t,e,i){"use strict";i.d(e,{BX:function(){return s},dP:function(){return o},Wo:function(){return c}});var n=i(622);function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var o,s={fontSize:18,lineHeight:26,fontFamily:"Roboto",fontWeight:400,fontStyle:"normal",fontWeights:["n1","i1","n3","i3","n4","i4","n5","i5","n7","i7","n9","i9"],textAlign:i(621).m7.AlignLeft};!function(t){t.Unstyled="unstyled"}(o||(o={}));a({},o.Unstyled,{element:"p"});var c=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){a(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},(0,n.w)({selector:'[data-block="true"], .widget-text-v3 p:not([class]), .widget-text-v3 p[class=""]',label:"Unstyled",styles:""}))},682:function(t,e,i){"use strict";i.d(e,{hk:function(){return d},_:function(){return u}});var n=i(655),r=i(621),a=i(669),o=i(668),s=(i(623),i(624),i(671)),c=i(683),l=i(351);i(620);var d=function(t){var e=window.RM.constructorRouter,i=e.mag,n=e.getCurrentPageNum,r=t.attributes,a=t.target,o=t.classList,c=t.dataset,d=r.getNamedItem("href"),u=d&&d.value?d.value.toLowerCase():"",h=c.anchorLinkPos?parseInt(c.anchorLinkPos):0,p=c.pid,f={id:l.Z.generateRandomKey(),linkStyle:o[0],target:"_blank"===a?"_blank":"_self"};if(u.startsWith("mailto:"))f.url=u.replace("mailto:",""),f.type=s.dr.Email;else if(u.startsWith("tel:"))f.url=u.replace("tel:",""),f.type=s.dr.Phone;else if("__rm_anchor"===u)f.url="".concat(h,"px"),f.pageNum=n()||void 0,f.type=s.dr.Anchor,f.anchorPosition=h;else if("back to top"===u)f.url="",f.type=s.dr.ScrollToTop;else if("__rm_goback"===u)f.url="",f.type=s.dr.GoBack;else if(p||i.getPageId(u)){var g=i.getPageId(u);f.url=""+(p&&i.getPageUri(p)||g||u);var m=p||g;f.pageNum=m&&i.getPageNum(m)||void 0,f.type=s.dr.Page}else f.url=u,f.type=s.dr.URL;return f},u=function(t,e){var i,s={},l=(null==e?void 0:e.ignore)||{};if(!l.textStyles&&null!==(i=t.classList)&&void 0!==i&&i.length){var d=Array.from(t.classList).filter((function(t){return t.startsWith("paragraph")}));s[n.MX]=d[0]}if(!l.textAlign&&t.style.textAlign){var u=t.style.textAlign;s[r.Hb]="right"===u?r.m7.AlignRight:"center"===u?r.m7.AlignCenter:"justify"===u?r.m7.AlignJustify:r.m7.AlignLeft}if(!l.paddings){var h={};t.style.paddingLeft&&(h.left=parseInt(t.style.paddingLeft)),t.style.paddingTop&&(h.top=parseInt(t.style.paddingTop)),t.style.paddingRight&&(h.right=parseInt(t.style.paddingRight)),t.style.paddingBottom&&(h.bottom=parseInt(t.style.paddingBottom)),s[a.gg]=h}return!l.lineHeight&&t.style.lineHeight&&(s[o.fB]=parseInt(t.style.lineHeight)),!l.textIndent&&t.style.textIndent&&(s[c.wF]=parseInt(t.style.textIndent)),s}},670:function(t,e,i){"use strict";i.d(e,{b3:function(){return a},qY:function(){return o}});var n=i(352),r=i.n(n),a="BR_ENTITY",o={strategy:function(t,e,i){t.findEntityRanges((function(t){var e=t.getEntity();return null!==e&&i.getEntity(e).getType()===a}),e)},component:function(){return r().createElement("br",null)}}},708:function(t,e,i){"use strict";i.d(e,{t:function(){return s}});var n=i(445),r=i(671),a=i(703),o=i(670),s=new n.CompositeDecorator([r.ez,a.eq,a.$X,o.qY])},988:function(t,e,i){"use strict";i.d(e,{z:function(){return c}});i(352);var n=i(624),r=i(680);function a(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function o(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(Object(i),!0).forEach((function(e){s(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var c=function(t){var e=t||{},i=e.type,a=void 0===i?r.BM.None:i,s=e.color,c=void 0===s?"00000064":s,l=e.size,d=void 0===l?1:l,u=e.padding,h=void 0===u?0:u,p=(0,n.gn)(c),f=p.r,g=p.g,m=p.b,v=p.a,y="rgba(".concat(f,", ").concat(g,", ").concat(m,", ").concat(v,")"),b="repeat-x",w=d+h,S=w>0?"0 100%":"0 ".concat(100+w,"%"),P={textDecoration:"none",paddingBottom:Math.max(0,w)};switch(a){case r.BM.Solid:return o(o({},P),{},{background:"linear-gradient(to right, ".concat(y," 0%, ").concat(y," 100%) ").concat(S,"/1px ").concat(d,"px ").concat(b)});case r.BM.Dotted:return o(o({},P),{},{background:"linear-gradient(to right, ".concat(y," 0%, ").concat(y," 50%, transparent 50%, transparent 100%) ").concat(S,"/").concat(2*d,"px ").concat(d,"px ").concat(b)});case r.BM.Dashed:return o(o({},P),{},{background:"linear-gradient(to right, ".concat(y," 0%, ").concat(y," 66.6666%, transparent 66.6666%, transparent 100%) ").concat(S,"/").concat(3*d,"px ").concat(d,"px ").concat(b)});default:return o(o({},P),{},{background:"none"})}}},671:function(t,e,i){"use strict";i.d(e,{kM:function(){return S},dr:function(){return w},TF:function(){return P},rU:function(){return k},ez:function(){return C}});var n=i(352),r=i.n(n),a=i(672),o=i.n(a),s=(i(445),i(673)),c=i(674),l=i(680),d=i(351),u=i(623);function h(){return(h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function p(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function f(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?p(Object(i),!0).forEach((function(e){g(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function g(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function m(t){return function(t){if(Array.isArray(t))return b(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||y(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){r=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return i}(t,e)||y(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){if(t){if("string"==typeof t)return b(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?b(t,e):void 0}}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var w,S="LINK";!function(t){t.URL="URL",t.Page="Page",t.Email="Email",t.Phone="Phone",t.Anchor="Anchor",t.ScrollToTop="ScrollToTop",t.GoBack="GoBack"}(w||(w={}));var P={name:"link-1",label:"Default Link Style",style:{link:{textColor:"0080FF64",color:"0080FF64",type:l.BM.Solid,size:1,padding:0},hover:{textColor:"0080FF64",color:"0080FF64",type:l.BM.None,size:1,padding:0},current:{textColor:"0080FF64",color:"0080FF64",type:l.BM.None,size:1,padding:0}}},k=function(t){var e=(0,n.useContext)(c.BackboneContext).model,i=(0,n.useContext)(s.T).model,a=(0,n.useContext)(s.x).model,l=v(a?a.useTextWidgetStore({partial:!1}):(0,n.useState)(null),1)[0],p=(window.RM.viewerRouter||window.RM.constructorRouter&&window.RM.constructorRouter.preview||{}).mag,g=t.contentState&&t.entityKey?t.contentState.getEntity(t.entityKey).getData():t.data||{},y=g.url,b=g.target,S=void 0===b?"_self":b,k=g.type,C=g.linkStyle,x=g.anchorPosition,T=g.pageNum,_=g.pageUri,Z=g.id,M=g.pageId,I=t.contentState&&t.blockKey&&"number"==typeof t.start&&"number"==typeof t.end?function(t){var e=t.contentState,i=t.start,n=t.end,r=t.blockKey,a=e.getBlockForKey(r).getCharacterList().slice(i,n),o={};if(a.size){var s=a.reduce((function(t,e){if(void 0===t)return 0;if(e){var i=e.getStyle().find((function(t){return Boolean(null==t?void 0:t.startsWith(u.f.FontSize))})),n=i&&d.Z.getCurrentInlineStylesFromString(i,u.f.FontSize),r=null!=n&&n.length?parseInt(n[0]):0;return r>t?r:t}return t}),0);s>0&&(o.fontSize=s)}return o}({contentState:t.contentState,start:t.start,end:t.end,blockKey:t.blockKey}):{},$=function(t){var e=[C||P.name].concat(m("string"==typeof t?[t]:t));if(a&&a.currentLinkStyle&&"link"!==a.currentLinkStyle&&l){var i=O(l);i&&i.id===Z&&e.push(a.currentLinkStyle)}return e.join(" ")},E=function(){var t;if(!p||!T&&!_)return"";var e=window.RM.common&&window.RM.common.isDownloadedSource&&!window.RM.common.homepageRewrite&&(null===(t=window.RM.config)||void 0===t?void 0:t.root)||"/";if(M){var i=p.getPageUri(M);return i?"".concat(e).concat(i):"javascript:void(0)"}if(_){var n=p.getPage(_);if(n&&n._id)return"".concat(e).concat(p.getPageUri(n._id))}if(T){var r=p.getPage(T);if(r&&r._id)return"".concat(e).concat(p.getPageUri(r._id))}return"javascript:void(0)"},D=function(){if(window.RM.constructorRouter&&!window.RM.constructorRouter.previewMode)return[];if(!p||!(T||_||M))return[];var n=[],r=t.is_global||e&&e.is_global,a=t.is_above||e&&e.is_above,o=T;if(_){var s=p.getPage(_);s&&s._id&&(o=s.num)}else if(M){var c=p.getPageNum(M);c&&(o=c)}var l=t.currentPageNum?t.currentPageNum===o:i&&i.currentPage&&i.currentPage.num===o,d=t.page?t.page.num===o:i&&i.page&&i.page.num===o;return(a?l:d)&&(n.push("back-to-top"),r&&n.push("current")),n};return r().createElement("a",h({},function(){switch(k){case w.URL:return{href:(t=y,/^(.*):\/\/[^\s$.?#].[^\s]*$/i.test(t)?t:"http://".concat(t)),target:S,rel:"noopener noreferrer",className:$("external-link")};case w.Email:return{href:"mailto:".concat(y),className:$("external-link")};case w.Phone:return{href:"tel:".concat(y),className:$("external-link")};case w.Anchor:return{href:"javascript:void(0)",className:$("anchor-link"),"data-anchor-link-pos":x,"data-page-uri":p&&T?T:"","data-page-id":p&&M?M:void 0};case w.ScrollToTop:return{href:"javascript:void(0)",className:$(["maglink","back-to-top"])};case w.GoBack:return{href:"javascript:void(0)",className:$("goback-link")};case w.Page:return{href:E(),target:S,className:$([].concat(m("_blank"===S?[]:["maglink"]),m(D())))};default:return{}}var t}(),{style:f({pointerEvents:p?void 0:"none"},I),dangerouslySetInnerHTML:"string"==typeof t.children?{__html:o().sanitize(t.children)}:void 0}),"string"!=typeof t.children?t.children:null)},C={strategy:function(t,e,i){t.findEntityRanges((function(t){var e=t.getEntity();return null!==e&&i.getEntity(e).getType()===S}),e)},component:k},x=function(t){var e=t.getSelection(),i=t.getCurrentContent(),n=e.getStartKey(),r=e.getStartOffset();return i.getBlockForKey(n).getEntityAt(r)},O=function(t){var e=x(t);return e?t.getCurrentContent().getEntity(e).getData()||{}:null}},703:function(t,e,i){"use strict";i.d(e,{eq:function(){return v},$X:function(){return y}});var n=i(352),r=i.n(n),a=i(677),o=i(705),s=i(706),c=i(660),l=i(704),d=i(351);function u(){return(u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}var h=String.fromCharCode(160),p=String.fromCharCode(8239),f=c.default.span.withConfig({displayName:"spaces__SpaceIcon"})(["&:before{content:'';height:",";padding-right:",";margin-right:-",";position:relative;left:-0.1em;background-repeat:no-repeat;"," "," ","}"],(function(t){return t.size}),(function(t){return t.size}),(function(t){return t.size}),l.backgroundImage,l.backgroundPosition,l.backgroundSize),g=o.Z.replace(/currentColor/g,a.colors.blue),m=s.Z.replace(/currentColor/g,a.colors.blue),v={strategy:function(t,e){d.Z.findSubstringIndexes(t,h).forEach((function(t){e(t,t+1)}))},component:function(t){return r().createElement(f,u({size:"0.5em",backgroundSize:"0.4em",backgroundPosition:"bottom",backgroundImage:"url('data:image/svg+xml,".concat(encodeURIComponent(g),"')")},t))}},y={strategy:function(t,e){d.Z.findSubstringIndexes(t,p).forEach((function(t){e(t,t+1)}))},component:function(t){return r().createElement(f,u({size:"0.4em",backgroundSize:"0.4em",backgroundPosition:"top",backgroundImage:"url('data:image/svg+xml,".concat(encodeURIComponent(m),"')")},t))}}},681:function(t,e,i){"use strict";i.d(e,{Ue:function(){return l}});i(445),i(460),i(511);var n=i(441),r=i(351),a=i(682),o=i(620),s=i(671),c=i(623),l=(i(684),i(655),(0,n.h4)({htmlToEntity:function(t,e,i){if("a"===t)return i(s.kM,"MUTABLE",(0,a.hk)(e))},htmlToStyle:function(t,e,i){return"b"===t?i.add(r.Z.getStyleValueString(c.f.FontWeight,"700")):"i"===t?i.add(r.Z.getStyleValueString(c.f.FontStyle,"italic")):i},htmlToBlock:function(t,e){if("p"===t)return{type:o.dP.Unstyled,data:(0,a._)(e,{ignore:{lineHeight:!0,textStyles:!0}})}}}))},635:function(t,e,i){"use strict";var n,r;function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,{e:function(){return r}}),function(t){t.Smallcaps="smcp",t.StandardLigatures="liga",t.DiscretionaryLigatures="dlig",t.RequiredLigatures="rlig",t.HistoricalLigatures="hlig",t.Fractions="frac",t.Alternates="salt",t.StylisticSet01="ss01",t.StylisticSet02="ss02",t.StylisticSet03="ss03",t.StylisticSet04="ss04",t.StylisticSet05="ss05",t.StylisticSet06="ss06",t.StylisticSet07="ss07",t.StylisticSet08="ss08",t.StylisticSet09="ss09",t.StylisticSet10="ss10",t.StylisticSet11="ss11",t.StylisticSet12="ss12",t.StylisticSet13="ss13",t.StylisticSet14="ss14",t.StylisticSet15="ss15",t.StylisticSet16="ss16",t.StylisticSet17="ss17",t.StylisticSet18="ss18",t.StylisticSet19="ss19",t.StylisticSet20="ss20",t.LiningFigures="lnum",t.OldstyleFigures="onum",t.ProportionalFigures="pnum",t.TabularFigures="tnum"}(r||(r={}));a(n={},r.LiningFigures,"Lining Figures"),a(n,r.OldstyleFigures,"Oldstyle Figures"),a(n,r.ProportionalFigures,"Proportional Figures"),a(n,r.TabularFigures,"Tabular Figures")},623:function(t,e,i){"use strict";i.d(e,{f:function(){return r},b:function(){return f}});var n,r,a=i(351),o=i(624);function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){r=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return l(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}!function(t){t.LetterSpacing="LETTER_SPACING",t.Color="COLOR",t.FontFeature="FONT_FEATURE",t.Stroke="STROKE",t.FontSize="FONT_SIZE",t.FontFamily="FONT_FAMILY",t.FontWeight="FONT_WEIGHT",t.FontStyle="FONT_STYLE",t.FontVariable="FONT_VARIABLE",t.IsLinkedLetterSpacing="IS_LINKED_LETTER_SPACING",t.Decoration="DECORATION",t.Transform="TRANSFORM",t.Features="FEATURES",t.FontKerning="FONT_KERNING"}(r||(r={}));var d=(s(n={},r.LetterSpacing,{name:"letterSpacing",value:function(t){return"".concat(t,"px")}}),s(n,r.FontFamily,{name:"fontFamily",value:function(t){return t}}),s(n,r.FontStyle,{name:"fontStyle",value:function(t){return t}}),s(n,r.FontWeight,{name:"fontWeight",value:function(t){return t}}),s(n,r.FontSize,{name:"fontSize",value:function(t){return"".concat(t,"px")}}),s(n,r.Color,{name:"color",value:function(t){var e=(0,o.gn)(t),i=e.r,n=e.g,r=e.b,a=e.a;return"rgba(".concat(i,", ").concat(n,", ").concat(r,", ").concat(a,")")}}),s(n,r.FontFeature,{name:"fontFeatureSettings",value:function(t){return t.split(a.Z.INLINE_STYLE_DELIMITER).filter((function(t){return t})).map((function(t){return'"'.concat(t,'"')})).join(", ")}}),s(n,r.FontVariable,{name:"fontVariationSettings",value:function(t){return t.split(a.Z.INLINE_STYLE_DELIMITER).filter((function(t){return t})).map((function(t){var e=c(t.split("|"),2),i=e[0],n=e[1];return"'".concat(i,"' ").concat(n)})).join(", ")}}),s(n,r.Stroke,{styleFn:function(t){var e=c(t.split(a.Z.INLINE_STYLE_DELIMITER),2),i=e[0],n=e[1],r=(0,o.gn)(n),s=r.r,l=r.g,d=r.b,u=r.a,h="rgba(".concat(s,", ").concat(l,", ").concat(d,", ").concat(u,")"),p="".concat(i,"px ").concat(h);return{WebkitTextStroke:p,textStroke:p}}}),s(n,r.Decoration,{name:"textDecoration",value:function(t){return t}}),s(n,r.Transform,{name:"textTransform",value:function(t){return t}}),s(n,r.Features,{styleFn:function(t){switch(t){case"superscript":return{verticalAlign:"baseline",position:"relative",top:"-0.4em",fontSize:"smaller"};case"subscript":return{verticalAlign:"baseline",position:"relative",top:"0.4em",fontSize:"smaller"};default:return{}}}}),s(n,r.FontKerning,{styleFn:function(t){return"none"===t?{}:{fontKerning:"auto",WebkitFontKerning:"auto"}}}),n);function u(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function h(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?u(Object(i),!0).forEach((function(e){p(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):u(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function p(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var f=function(t){return Object.keys(d).reduce((function(e,i){var n=t.filter((function(t){return!!t&&t.startsWith(i)})).first();if(n){var r=n.replace("".concat(i).concat(a.Z.INLINE_STYLE_DELIMITER),""),o=d[i];if(o.styleFn)return h(h({},e),o.styleFn(r));if(o.name&&o.value)return h(h({},e),{},p({},o.name,o.value(r)))}return e}),{})}},619:function(t,e,i){"use strict";i.d(e,{J:function(){return r}});i(351);var n=["The follies of others are obvious, but our own hide from us; we love to parse others’ missteps but we cover up our own, as the cheat conceals the false die. It is in the nature of men to lay blame: we see others’ mistakes while our own passions swell, carrying us ever farther from improvement. — Buddhist wisdom","No one can long stand on tiptoe. He who thrusts himself forward is not a source of light. No glory comes to the self-satisfied, no honor to the boastful. The proud will not rise high. In the court of good sense, such people are like table discards, repellent to all. The sensible person does not rely on self. — Lao-Tzu","Simplicity in life, language and habits strengthens a nation, but a life of luxury, fancy language and effeminate habit leads to weakness and death. — John Ruskin","Truth is not a matter of talking but comes only through labor and observation. And when you have one truth in hand, two others, like the first leaves of a dicotyledonous plant, will probably appear. — John Ruskin","All things have a beginning and an end. So it is with mankind: there is a beginning and end to all  human affairs. He who understands what is a beginning and what is an end is closer to the truth. — Confucius","Most people are dismayed if deprived of their pleasures. The right course belongs to him who relishes even the passing away of the reason for his joy and is not bitter. — Pascal","When we are clear about things, we have knowledge; with knowledge, we seek the path of truth; when the search is rewarded, the heart becomes good; with the heart made good, the moral view of things that leads to virtue is attained. — Confucius","Wisdom has three faces: when seen from afar, it is grand and severe; on closer approach, it is tender and welcoming; when we are close enough to hear it, the words of  wisdom are severe and demanding. — Chinese wisdom","The sun constantly floods the world with its light, but its light is not exhausted; so your mind should send its light in all directions and not be exhausted. It should flow everywhere, without diminishment, and when it encounters an obstacle, it should react, not with annoyance or anger but should serenely clarify all that yearns to accept it, without any lessening or weariness, bringing light to all that is turned to it, leaving in shadow only that which turns its face away. — Marcus Aurelius","As torches and fireworks pale to invisibility in the sun, so the mind, even the mind of genius, and beauty pale and are eclipsed by the heart’s goodness. — Schopenhauer","Music and sweet treats bring the wanderer to a stop, but wisdom has neither flavor nor smell. When looked for, it is invisible; when listened for, it is inaudible, yet its goodness is inexhaustible. The most powerful thing in the world cannot be seen, heard or touched. — Lao-Tzu","The best ideas are usually those that come without effort, out of the blue. The great intellectual creations come easily. Only a great person can create something great, and such a one works without strain. — John Ruskin","He who talks much rarely puts his words into action. But the wise person fears that his words may not be translated into action. The wise do not utter empty words, lest their actions be inconsistent with their words. — Chinese wisdom","Fear ignorance, but fear false knowledge even more. Turn your eyes from the deceptive world and do not trust your feelings, for they lie; rather look inward to the impersonal, eternal self. Truly, ignorance is like a sealed and airless chamber; in it, the soul sits like a caged bird, neither singing nor spreading its wings. But ignorance is better than any school of thought that is not guided by the wisdom of the soul. — Buddhist wisdom","Some seek their good or happiness in power; others in science, and others in the pleasures of the flesh. But those who come truly close to the good understand that it cannot consist in what can only be mastered by a few. They understand that the true good of humankind is that which can be achieved by all people, without division and without envy; its nature  is such that none can lose it if they do not so choose. — Pascal","The wise person asks only of himself; the unwise man demands everything from others. — Chinese wisdom","To know much and not to put one’s self forward as knowing is the height of morality. To know little and put one’s self forward as knowledgeable is an illness. Only by understanding the disease can one expunge it. — Lao-Tzu","Speak only of that which is as clear to you as the morning, or be silent. — Talmud","Conquer ferocity with love, evil with good, miserliness with generosity, the liar with truth. — Buddhist wisdom","People seek satisfaction, throwing themselves from one thing to another because they feel the emptiness of their lives but do not yet realize the emptiness of the new delight that attracts them. — Pascal","The skilled warrior does not rage. The skilled fighter is not angry. He who is skilled in the use of people is not provocative. This is the virtue of non-resistance. This is being in agreement with Heaven. — Lao-Tzu","The first and principal characteristic of a good and wise person is his consciousness that he knows very little, that many people know more and he seeks always to learn, to study, and not to teach. Those who wish to teach or direct neither teach nor lead well. — John Ruskin","The virtuous person seeks to follow the direct path to the end. What is to be feared is to go halfway and then to weaken. — Chinese wisdom"],r=function(){return n[Math.floor(Math.random()*n.length)]}},978:function(t,e,i){"use strict";i.d(e,{vY:function(){return p},$w:function(){return g}});var n=i(980),r=i(624),a=(i(343),i(680)),o=i(308),s=(i(979),i(682),i(620));i(671);function c(t,e){if(null==t)return{};var i,n,r=function(t,e){if(null==t)return{};var i,n,r={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(r[i]=t[i]);return r}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(r[i]=t[i])}return r}function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function d(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){u(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var h=function(t,e){if(!t)return"";var i="number"==typeof e?e:100;return"".concat(t).concat((0,r.vx)(i))},p=function(t){var e=["none",0,"baseline"],i=["opacity"];return t.map((function(t){var a=t._name,l=t._caption,h=t.tag,p=(t._sort,c(t,["_name","_caption","tag","_sort"])),f=Object.keys(p).reduce((function(t,a){var o=(0,n.eV)(a),c=p[a];if(i.includes(a)||e.includes(c))return d({},t);if("textAlign"===o&&"start"===c)c="left";else if("color"===o){var l=p.opacity>0?parseFloat((p.opacity/100).toFixed(2)):1,h=(0,r.vK)(c,l);c=(0,r.tZ)(h)}else o.includes("padding")?c=parseInt(c):"fontWeight"===o&&"normal"===c&&(c=s.BX.fontWeight);return d(d({},t),{},u({},o,c))}),{});return f.paddingLeft=f.paddingLeft||0,f.paddingRight=f.paddingRight||0,f.paddingTop=f.paddingTop||0,f.paddingBottom=f.paddingBottom||0,{name:a,label:l,tag:h||o.ZP.AVAILABLE_TEXT_TAGS[0],cssProperties:f}}))},f=function(t,e){var i=function(t){return e?"".concat(e,"-").concat(t):t},n=void 0!==t[i("color")]?t[i("color")]:t.color,r=void 0!==t[i("opacity")]?t[i("opacity")]:t.opacity,o=void 0!==t[i("u-color")]?t[i("u-color")]:t["u-color"],s=void 0!==t[i("u-opacity")]?t[i("u-opacity")]:t["u-opacity"],c=void 0!==t[i("u-size")]?t[i("u-size")]:t["u-size"],l=void 0!==t[i("u-offset")]?t[i("u-offset")]:t["u-offset"],d=void 0!==t[i("u-style")]?t[i("u-style")]:t["u-style"];return{textColor:h(String("inherit"===n?t.color:n),Number("inherit"===r?t.opacity:r)),color:h(String("inherit"===o?t["u-color"]:o),Number("inherit"===s?t["u-opacity"]:s)),size:Number("inherit"===c?t["u-size"]:c),padding:Number("inherit"===l?t["u-offset"]:l),type:function(t){switch(t){case"none":return a.BM.None;case"dotted":return a.BM.Dotted;case"dashed":return a.BM.Dashed;case"solid":return a.BM.Solid}}(d)}},g=function(t){return t.map((function(t){return{name:t._name,label:t._caption,style:{link:f(t),hover:f(t,"hover"),current:f(t,"current")}}}))}},684:function(t,e,i){"use strict";i(445),i(685),i(351),i(683),i(668),i(623),i(340),i(653),i(655);var n;i(620),i(621),i(703);!function(t){t.InsertNbsp="InsertNbsp",t.InsertThinsp="InsertThinsp",t.InsertEnsp="InsertEnsp",t.IncreaseIndent="IncreaseIndent",t.DecreaseIndent="DecreaseIndent",t.DecreaseLineHeight="DecreaseLineHeight",t.IncreaseLineHeight="IncreaseLineHeight",t.DecreaseLetterSpacing="DecreaseLetterSpacing",t.IncreaseLetterSpacing="IncreaseLetterSpacing",t.ToggleTypographyPanel="ToggleTypographyPanel",t.ToggleLinkPanel="ToggleLinkPanel",t.IncreaseFontSize="IncreaseFontSize",t.DecreaseFontSize="DecreaseFontSize",t.AlignLeft="AlignLeft",t.AlignRight="AlignRight",t.AlignCenter="AlignCenter",t.SelectParagraph="SelectParagraph",t.ToggleBold="ToggleBold",t.ToggleUnderline="ToggleUnderline",t.ToggleItalic="ToggleItalic"}(n||(n={}))},653:function(t,e,i){"use strict";i.d(e,{sJ:function(){return s},XZ:function(){return c},H$:function(){return d},kh:function(){return u},SZ:function(){return p},we:function(){return f}});var n=i(654);function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){r=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return a(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var o=r((0,n.M)({global:[],project:[]}),3),s=o[0],c=(o[1],o[2]),l=r((0,n.M)({global:[],project:[]}),3),d=l[0],u=(l[1],l[2]),h=r((0,n.M)({global:[],project:[]}),3),p=h[0],f=(h[1],h[2]);r((0,n.M)({}),1)[0]},680:function(t,e,i){"use strict";var n,r,a,o,s;i.d(e,{Rr:function(){return n},m5:function(){return r},BM:function(){return o}}),function(t){t.top="top",t.bottom="bottom"}(n||(n={})),function(t){t.LTR="LTR",t.RTL="RTL"}(r||(r={})),function(t){t.global="global",t.project="project"}(a||(a={})),function(t){t.None="None",t.Solid="Solid",t.Dotted="Dotted",t.Dashed="Dashed"}(o||(o={})),function(t){t.Added="Added",t.Removed="Removed",t.Replaced="Replaced",t.NotChanged="NotChanged"}(s||(s={}))},977:function(t,e,i){"use strict";i.d(e,{j:function(){return r},O:function(){return a}});var n=i(620),r=[{name:"style-h1",label:"H1",tag:"h1",cssProperties:{color:"22222264",fontFamily:"Roboto",fontStyle:"normal",textAlign:"left",fontSize:48,fontWeight:700,letterSpacing:0,lineHeight:60,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0}},{name:"style-h2",label:"H2",tag:"h2",cssProperties:{color:"22222264",fontFamily:"Georgia",fontStyle:"normal",textAlign:"left",fontSize:24,fontWeight:400,letterSpacing:0,lineHeight:30,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0}},{name:"style-text",label:"Text",tag:"p",cssProperties:{color:"22222264",fontFamily:"Georgia",fontStyle:"normal",textAlign:"left",fontSize:18,fontWeight:400,letterSpacing:0,lineHeight:23,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0}},{name:"style-caption",label:"Caption",tag:"p",cssProperties:{color:"22222232",fontFamily:"Georgia",fontStyle:"italic",textAlign:"left",fontSize:14,lineHeight:18,letterSpacing:0,fontWeight:400,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0}}],a=[{name:"list-style",label:"List item",cssProperties:{color:"22222264",fontFamily:n.BX.fontFamily,fontStyle:n.BX.fontStyle,textAlign:"left",fontSize:n.BX.fontSize,fontWeight:Number(n.BX.fontWeight),letterSpacing:0,lineHeight:n.BX.lineHeight,paddingRight:0,paddingLeft:0,width:26}}]},976:function(t,e,i){"use strict";i.d(e,{IB:function(){return _}});var n,r=i(352),a=i.n(r),o=i(600),s=i.n(o),c=i(636),l=i(977),d=i(978),u=i(671),h=i(660),p=i(653),f=i(982),g=i(655),m=i(988);function v(t){return function(t){if(Array.isArray(t))return k(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||P(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function b(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?y(Object(i),!0).forEach((function(e){w(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):y(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function w(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function S(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){r=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return i}(t,e)||P(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(t,e){if(t){if("string"==typeof t)return k(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?k(t,e):void 0}}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var C,x,O=(0,h.createGlobalStyle)(n||(C=["\n  ","\n  ","\n  ","\n  ","\n"],x||(x=C.slice(0)),n=Object.freeze(Object.defineProperties(C,{raw:{value:Object.freeze(x)}}))),(function(t){return t.blockStyles}),(function(t){return t.textStyleSheet}),(function(t){return t.linkStyleSheet}),(function(t){return t.listStyleSheet})),T=function(t){var e=t.mode,i=S((0,p.sJ)(),2),n=i[0],o=i[1],s=S((0,p.H$)(),2),h=s[0],y=s[1],P=S((0,p.SZ)(),2),k=P[0],C=P[1];(0,r.useEffect)((function(){if("constructor"===e){var t=[];if(!n.global.length&&!n.project.length){var i,r,a=window.ServerData.textStyles,s=l.j;if(!a||!a.project||!a.project.length){var p,f,g=null===(p=window.ServerData)||void 0===p||null===(f=p.editParams)||void 0===f?void 0:f.paragraph_styles;g&&(s=(0,d.vY)(g),t.push((0,c.Wf)({styles:s,projectId:window.ServerData.projectId})))}o({global:null!=a&&null!==(i=a.global)&&void 0!==i&&i.length?a.global:[],project:null!=a&&null!==(r=a.project)&&void 0!==r&&r.length?a.project:s})}if(!h.global.length&&!h.project.length){var m,v,b=window.ServerData.linkStyles,w=[u.TF];if(!b||!b.project||!b.project.length){var S=window.ServerData.editParams&&window.ServerData.editParams.link_styles;S&&(w=(0,d.$w)(S),t.push((0,c.pV)({styles:w,projectId:window.ServerData.projectId})))}y({global:null!=b&&null!==(m=b.global)&&void 0!==m&&m.length?b.global:[],project:null!=b&&null!==(v=b.project)&&void 0!==v&&v.length?b.project:w})}if(!k.global.length&&!k.project.length){var P,x,O=window.ServerData.listStyles;C({global:null!=O&&null!==(P=O.global)&&void 0!==P&&P.length?O.global:[],project:null!=O&&null!==(x=O.project)&&void 0!==x&&x.length?O.project:l.O})}t.length&&Promise.all(t)}if("viewer"===e||"screenshoter"===e){var T,_,Z,M,I,$,E,D,L,j,A,R,F,B,z,W,N,V,U,H,G,K,q,Y,J,X,Q="viewer"===e,tt=Q?(null===(T=window.ServerData)||void 0===T||null===(_=T.mags)||void 0===_||null===(Z=_.mag)||void 0===Z?void 0:Z.textStyles)||(null===(M=window.RM)||void 0===M||null===(I=M.viewerRouter)||void 0===I||null===($=I.mag)||void 0===$?void 0:$.textStyles):null===(E=window.ServerData)||void 0===E||null===(D=E.mag)||void 0===D?void 0:D.textStyles;if(tt)o({global:null!=tt&&null!==(J=tt.global)&&void 0!==J&&J.length?tt.global:[],project:null!=tt&&null!==(X=tt.project)&&void 0!==X&&X.length?tt.project:l.j});var et,it,nt=Q?(null===(L=window.ServerData)||void 0===L||null===(j=L.mags)||void 0===j||null===(A=j.mag)||void 0===A?void 0:A.linkStyles)||(null===(R=window.RM)||void 0===R||null===(F=R.viewerRouter)||void 0===F||null===(B=F.mag)||void 0===B?void 0:B.linkStyles):null===(z=window.ServerData)||void 0===z||null===(W=z.mag)||void 0===W?void 0:W.linkStyles;if(nt)y({global:null!=nt&&null!==(et=nt.global)&&void 0!==et&&et.length?nt.global:[],project:null!=nt&&null!==(it=nt.project)&&void 0!==it&&it.length?nt.project:[u.TF]});var rt,at,ot=Q?(null===(N=window.ServerData)||void 0===N||null===(V=N.mags)||void 0===V||null===(U=V.mag)||void 0===U?void 0:U.listStyles)||(null===(H=window.RM)||void 0===H||null===(G=H.viewerRouter)||void 0===G||null===(K=G.mag)||void 0===K?void 0:K.listStyles):null===(q=window.ServerData)||void 0===q||null===(Y=q.mag)||void 0===Y?void 0:Y.listStyles;if(ot)C({global:null!=ot&&null!==(rt=ot.global)&&void 0!==rt&&rt.length?ot.global:[],project:null!=ot&&null!==(at=ot.project)&&void 0!==at&&at.length?ot.project:l.O})}}),[]);var x=(0,r.useMemo)((function(){return Object.keys(f.T).map((function(t){return f.T[t].style})).join(" ")}),[f.T]),T=(0,r.useMemo)((function(){var t=function(t){var e,i=(e=t.cssProperties,Object.keys(e).reduce((function(t,i){var n=e[i];return"string"==typeof n&&n.includes("(")&&!n.includes(")")&&(n="".concat(n,")")),n&&"opacity"===i&&parseInt(String(n))>1&&(n=parseInt(String(n))/100),b(b({},t),{},w({},i,n))}),{}));return"justify"===(i.textAlign&&String(i.textAlign))&&(i.whiteSpace="normal")," .".concat(t.name," { ").concat((0,g.aR)(i)," } ")},e=n.global.map(t),i=n.project.map(t);return[].concat(v(e),v(i)).join(" ")}),[n]),_=(0,r.useMemo)((function(){var t=function(t){var e=b({},t.cssProperties);return e.display="inline-block"," .".concat(t.name," {\n        &-preview {\n          ").concat((0,g.aR)(t.cssProperties),"\n        }\n\n        div[data-offset-key]:before, & > li:before, &:before {\n          ").concat((0,g.aR)(e),"\n        }\n      } ")},e=k.global.map(t),i=k.project.map(t);return[].concat(v(e),v(i)).join(" ")}),[k]),Z=(0,r.useMemo)((function(){var t=function(t){var e,i,n;return" .".concat(t.name," {\n      ").concat(null!==(e=t.style)&&void 0!==e&&e.link?"\n          // Стиль подчеркивания\n          ".concat((0,g.aR)((0,m.z)(t.style.link)),"\n          ").concat((0,g.aR)({color:t.style.link.textColor}),"\n          & * {\n            ").concat((0,g.aR)({color:t.style.link.textColor}),"\n          }"):"","\n\n      ").concat(null!==(i=t.style)&&void 0!==i&&i.hover?"\n          // Стиль подчеркивания при наведении\n          &.hover, &:hover {\n            ".concat((0,g.aR)((0,m.z)(t.style.hover)),"\n            ").concat((0,g.aR)({color:t.style.hover.textColor},!0),"\n            & * {\n              ").concat((0,g.aR)({color:t.style.hover.textColor},!0),"\n            }\n          }"):"","\n\n      ").concat(null!==(n=t.style)&&void 0!==n&&n.current?"\n          // Стиль подчеркивания для Current ссылки\n          &.current {\n            ".concat((0,g.aR)((0,m.z)(t.style.current)),"\n            ").concat((0,g.aR)({color:t.style.current.textColor}),"\n            & * {\n              ").concat((0,g.aR)({color:t.style.current.textColor}),"\n            }\n          }"):"","\n     } ")},e=h.global.map(t),i=h.project.map(t);return[].concat(v(e),v(i)).join(" ")}),[h]);return a().createElement(O,{blockStyles:x,textStyleSheet:T,linkStyleSheet:Z,listStyleSheet:_})},_=function(t){var e="text-global-styles",i=document.querySelector("#".concat(e));i||((i=document.createElement("div")).id=e,document.body.appendChild(i)),s().render(a().createElement(T,{mode:t}),i)}},655:function(t,e,i){"use strict";i.d(e,{MX:function(){return o},aR:function(){return l},x6:function(){return d},ne:function(){return u}});var n=i(656),r=i(624),a=i(351);i(653);var o="textStyle",s=["fontSize","lineHeight","letterSpacing","textIndent","paddingLeft","paddingTop","paddingRight","paddingBottom","width"],c=function(t,e){if(e){if(s.includes(t))return"".concat(e,"px");if("color"===t){var i=(0,r.gn)(String(e)),n=i.r,a=i.g,o=i.b,c=i.a;return"rgba(".concat(n,", ").concat(a,", ").concat(o,", ").concat(c,")")}return e}},l=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object.keys(t).reduce((function(i,r){return t[r]?"".concat(i).concat((0,n.o)(r),": ").concat(c(r,t[r])).concat(e?" !important":"","; "):i}),"")},d=function(t){var e=t.editorState,i=t.block,n=a.Z.getBlockData({editorState:e,block:i,key:o});return"string"==typeof n?n:""},u=function(t){var e=t.block,i=t.editorState,n=t.styleName;return a.Z.setBlockData({editorState:i,block:e,key:o,value:n})}},351:function(t,e,i){"use strict";var n=i(352),r=i.n(n),a=i(355),o=i.n(a),s=i(322),c=i(440),l=i.n(c),d=i(441),u=i(445),h=i(619),p=i(620),f=i(623),g=i(635),m=i(636),v=i(653),y=i(655),b=i(659),w=i(668),S=i(621),P=i(669),k=i(670),C=i(343),x=i(671),O=i(681),T=i(624),_=i(308),Z=i(707),M=i(674),I=i(722);function $(t,e){return D(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){r=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return i}(t,e)||j(t,e)||E()}function E(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function D(t){if(Array.isArray(t))return t}function L(t){return function(t){if(Array.isArray(t))return R(t)}(t)||A(t)||j(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(t,e){if(t){if("string"==typeof t)return R(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?R(t,e):void 0}}function A(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function F(t,e,i,n,r,a,o){try{var s=t[a](o),c=s.value}catch(t){return void i(t)}s.done?e(c):Promise.resolve(c).then(n,r)}function B(t){return function(){var e=this,i=arguments;return new Promise((function(n,r){var a=t.apply(e,i);function o(t){F(a,n,r,o,s,"next",t)}function s(t){F(a,n,r,o,s,"throw",t)}o(void 0)}))}}function z(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function W(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?z(Object(i),!0).forEach((function(e){N(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):z(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function N(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function V(t){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var U=(0,d.cn)({styleToHTML:function(){return r().createElement("span",null)},blockToHTML:function(){return r().createElement("p",null)},entityToHTML:function(t,e){return t.type===k.b3?r().createElement("br",null):e}}),H=function(t,e){return u.EditorState.forceSelection(t,e||t.getSelection())},G=function(t,e){return u.RichUtils.toggleInlineStyle(t,e)},K=function(t,e){return"function"==typeof t.get?t.get(e):t[e]},q=function(t,e){var i={blocks:(K(t,"blocks")||[]).map((function(i){var n,r,a=e&&(null===(n=t[e])||void 0===n?void 0:n.styles)||K(t,"styles"),o=e&&(null===(r=t[e])||void 0===r?void 0:r.blocksMeta)||K(t,"blocksMeta"),s=(a||[]).find((function(t){return t.key===i.key})),c=(o||[]).find((function(t){return t.key===i.key})),l=[];return s&&(l="object"===V(s.inlineStyles)&&s.inlineStyles.hasOwnProperty("keys")&&s.inlineStyles.hasOwnProperty("values")?vt(s.inlineStyles):(null==s?void 0:s.inlineStyles)||[]),W(W({},i),{},{data:(null==c?void 0:c.data)||i.data||{},type:s?s.type:p.dP.Unstyled,inlineStyleRanges:l})}))||[],entityMap:K(t,"entityMap")||{}};return(0,u.convertFromRaw)(i)},Y=function(t){var e=(0,u.convertToRaw)(t),i=e.blocks.map((function(t){return{key:t.key,text:t.text,entityRanges:t.entityRanges,depth:t.depth}})),n=e.blocks.map((function(t){return{key:t.key,type:t.type,inlineStyles:gt(t.inlineStyleRanges)}})),r=e.blocks.map((function(t){return{key:t.key,data:t.data||{}}}));return{blocks:i,styles:n,entityMap:e.entityMap,blocksMeta:r}},J=function(t){var e=et(t,!0),i=t.getSelection();if(2!==e.length)return i;if(0!==i.getAnchorOffset()||0!==i.getFocusOffset())return i;var n=t.getCurrentContent(),r=i.getStartKey(),a=n.getBlockForKey(r);return new u.SelectionState({anchorKey:r,anchorOffset:0,focusKey:r,focusOffset:a.getText().length,isBackward:!1,isCollapsed:i.isCollapsed()})},X=function(t){var e=t.content;return(t.selection||new u.SelectionState).merge({anchorKey:e.getFirstBlock().getKey(),anchorOffset:0,focusOffset:e.getLastBlock().getText().length,focusKey:e.getLastBlock().getKey()})},Q=function(t){var e=t.getCurrentInlineStyle();return(0,f.b)(e)};var tt=function(t){var e=t.editorState,i=t.blockKey,n=t.data,r=t.selection||e.getSelection(),a=e.getCurrentContent(),o=a.getBlockMap(),s=a.getBlockForKey(i),c=s.get("data"),d=s.set("data",l().Map(W(W({},c?c.toObject():{}),n)));return a.merge({blockMap:o.merge(N({},s.getKey(),d)),selectionBefore:r,selectionAfter:r})},et=function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.getSelection();if(r.isCollapsed())return[r.getStartKey()];var a=t.getCurrentContent(),o=r.getIsBackward(),s=o?r.getFocusKey():r.getAnchorKey(),c=o?r.getAnchorKey():r.getFocusKey(),l=0===r.getFocusOffset()&&0===r.getAnchorOffset()&&s!==c,d=0===r.getFocusOffset()&&s!==c&&r.getAnchorOffset()===(null===(e=a.getBlockForKey(r.getAnchorKey()))||void 0===e||null===(i=e.getCharacterList())||void 0===i?void 0:i.size),u=a.getBlockMap().toIndexedSeq(),h=u.map((function(t){return t&&t.getKey()})).toJS(),p=[],f=h.indexOf(s),g=h.indexOf(c);return f>-1&&g>-1&&(p=h.slice(f,g+1)),(!n&&l||d)&&p.pop(),p},it=function(t){var e=t.getSelection(),i=e.getIsBackward(),n=i?e.getFocusKey():e.getAnchorKey(),r=i?e.getAnchorKey():e.getFocusKey(),a=i?e.getEndOffset():e.getStartOffset(),o=i?e.getStartOffset():e.getEndOffset();if(0===a&&0===o){var s=i?r:n;return{startKey:s,endKey:s,startOffset:0,endOffset:t.getCurrentContent().getBlockForKey(s).getCharacterList().size}}return{startKey:n,endKey:r,startOffset:a,endOffset:o}},nt=function(t){return t.some((function(t){return t&&t.style.length}))},rt=function(t){return t.some((function(t){return function(t){return"text"===t.type}(t)&&3===t.version}))},at=/url\((?:"|'|)(.*?)(?:"|'|)\)/g;function ot(t){return st.apply(this,arguments)}function st(){return(st=B(regeneratorRuntime.mark((function t(e){var i,n,r,a,o,s,c,l,d,u,h,p;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i={},t.t0=regeneratorRuntime.keys(document.styleSheets);case 2:if((t.t1=t.t0()).done){t.next=24;break}n=t.t1.value,r=document.styleSheets[n],a=null,t.prev=6,a=r.rules||r.cssRules,t.next=16;break;case 10:if(t.prev=10,t.t2=t.catch(6),!r.href||r.href.includes("cloudfront.net")){t.next=16;break}return t.next=15,ct(r.href);case 15:a=t.sent;case 16:if(a){t.next=21;break}if(!r.href||r.href.includes("cloudfront.net")){t.next=21;break}return t.next=20,ct(r.href);case 20:a=t.sent;case 21:if(a)for(o in a)(s=a[o])&&s instanceof CSSFontFaceRule&&(l=null===(c=s.style)||void 0===c?void 0:c.getPropertyValue("src"),null!=(d=null==l?void 0:l.match(at))&&d.length&&(h=d[d.length-1].slice(4,-1).replace(/"/g,"").replace(/'/g,""),p=null===(u=s.style)||void 0===u?void 0:u.getPropertyValue("font-family").replace(/['"]+/g,""),i[p]=h));t.next=2;break;case 24:if(!e){t.next=26;break}return t.abrupt("return",i[e]||null);case 26:return t.abrupt("return",i);case 27:case"end":return t.stop()}}),t,null,[[6,10]])})))).apply(this,arguments)}var ct=function(){var t=B(regeneratorRuntime.mark((function t(e){var i,n,r,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e).then((function(t){return t.text()})).catch((function(t){console.error("Error while getting stylesheet from url ".concat(e,": "),t)}));case 2:if(!(i=t.sent)){t.next=12;break}return(n=document.createElement("style")).type="text/css",n.styleSheet?n.styleSheet.cssText=i:n.appendChild(document.createTextNode(i)),document.head.appendChild(n),r=n.sheet||n.styleSheet,a=r&&(r.rules||r.cssRules)?r.rules||r.cssRules:null,document.head.removeChild(n),t.abrupt("return",a);case 12:return t.abrupt("return",null);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),lt=function(t,e){var i=t;return"string"==typeof i&&/^\d+$/.test(i)&&(i=Number(i)),"string"==typeof i?"v":"".concat(e[0].toLowerCase()).concat(Math.floor(i/100))},dt=function(){var t=B(regeneratorRuntime.mark((function t(e){var i,n,r,a,o,s,c,l,d,u,h,p,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.fontFamily,n=e.fontWeight,r=e.fontStyle,a={features:[],variations:[],characters:[]},o=window.RM.constructorRouter.fonts.findFontByCSSName(i),s=lt(n,r),o&&o.variations&&o.variations.includes(s)){t.next=6;break}return t.abrupt("return",a);case 6:if(c={weight:s},!o||"custom"!==o.provider){t.next=11;break}c.id=o._id,t.next=15;break;case 11:return t.next=13,ot(i);case 13:(l=t.sent)&&(c.url=l);case 15:if(o&&"system"===o.provider&&(c.systemFontName=o.name),!(!c.url&&!c.id&&!c.systemFontName||c.id&&!c.weight)){t.next=19;break}return t.abrupt("return",void 0);case 19:return t.prev=19,t.next=22,(0,m.WN)(c);case 22:return d=t.sent,u=d.data,(h=u&&u.features)&&h.length&&(p=Object.values(g.e),f=p.filter((function(t){return h.some((function(e){return e.toLowerCase()===t.toLowerCase()}))})),a.features=f||[]),a.variations=u&&u.variations,a.characters=u&&u.characters,t.abrupt("return",a);case 31:throw t.prev=31,t.t0=t.catch(19),new Error(t.t0||"Can't detect font features");case 34:case"end":return t.stop()}}),t,null,[[19,31]])})));return function(e){return t.apply(this,arguments)}}(),ut=";",ht=function(t,e){return"".concat(t).concat(ut).concat(e)},pt=function(t,e){var i=Pt.getSelectionOffset(t),n=i.startOffset,r=i.endOffset,a=t.getSelection(),o=Pt.getSelectedBlocks(t),s=t.getCurrentContent().getBlockMap();return s.forEach((function(t){if(t){var i=t.getKey();if(o.includes(i)){var a=t.getCharacterList().map((function(t,a){if(!t||void 0===a)return t;var s=t.getStyle().filter((function(t){return!!t&&t.startsWith(e)})).toJS(),c=function(t,e){return u.CharacterMetadata.removeStyle(t,e)};if(1===o.length){if(a>=n&&a<r)return s.reduce(c,t)}else if(o[0]===i){if(a>=n)return s.reduce(c,t)}else{if(o[o.length-1]!==i)return s.reduce(c,t);if(a<r)return s.reduce(c,t)}return t})),c=t.set("characterList",a);s=s.set(i,c)}}})),Pt.forceSelection(u.EditorState.push(t,u.ContentState.createFromBlockArray(s.toArray()),"change-inline-style"),a)},ft=function(t,e){return t.replace("".concat(e).concat(ut),"").split(ut)},gt=function(t){var e=[],i=[],n=[];return t.forEach((function(t){var r,a=e.findIndex((function(e){return e.offset===t.offset&&e.length===t.length})),o=t.style.split(ut),s=D(r=o)||A(r)||j(r)||E(),c=s[0],l=s.slice(1).join(ut),d=i.indexOf(c);-1===d&&(i.push(c),d=i.length-1);var u=n.indexOf(l);-1===u&&(n.push(l),u=n.length-1);var h=t.style.replace(c,String(d)).replace(l,String(u));a>-1?e[a].styles.includes(t.style)||e[a].styles.push(h):e.push({offset:t.offset,length:t.length,styles:[h]})})),{styles:mt(e),keys:i,values:n}},mt=function(t){var e=null,i=[];return t.forEach((function(t,n){if(null===e)e=n,i.push(t);else if(i[i.length-1]){var r=i[i.length-1],a=r.offset,o=r.length,c=r.styles;a+o===t.offset&&(0,s.isEqual)(c,t.styles)?i[i.length-1]=W(W({},i[i.length-1]),{},{length:o+t.length}):(e=n,i.push(t))}})),i},vt=function(t){var e=t.keys,i=t.values,n=t.styles,r=[];return n.forEach((function(t){t.styles.forEach((function(n){var a=$(n.split(ut),2),o=a[0],s=a[1];r.push({offset:t.offset,length:t.length,style:"".concat(e[Number(o)]).concat(ut).concat(i[Number(s)])})}))})),r},yt={},bt=Math.pow(2,24),wt=function(t){return"text"===t.type},St=function(t,e){var i=document.createElement("canvas").getContext("2d");return i?(i.font=function(t){return[t.fontStyle,t.fontWeight,t.fontSize?"".concat(t.fontSize,"px"):null,t.fontFamily?'"'.concat(t.fontFamily,'"'):null].filter((function(t){return t})).join(" ")}(e),{width:i.measureText(t).width,height:parseInt(i.font)}):null},Pt={forceSelection:H,toggleInlineStyle:G,getCurrentBlock:function(t){return t.getCurrentContent().getBlockForKey(t.getSelection().getStartKey())},getCurrentBlockType:function(t){return t.getCurrentContent().getBlockForKey(t.getSelection().getStartKey()).getType()},toggleBlockType:function(t,e){return u.RichUtils.toggleBlockType(t,e)},importTextContent:q,exportTextContent:Y,creatNewWidgetContent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.text,i=t.html,n=i?(0,O.Ue)(i):u.ContentState.createFromText(e||(0,h.J)());return Y(n)},fixSelection:J,getAllTextSelection:X,clearSelection:function(t){var e=u.EditorState.moveSelectionToEnd(t).getSelection();return H(t,e)},hasSelectedText:function(t){var e=t.getSelection();return e.getAnchorKey()!==e.getFocusKey()||e.getAnchorOffset()!==e.getFocusOffset()},clearStylesFromBlock:function(t){var e,i=t.editorState,n=t.block,r=i.getCurrentContent().getBlockMap(),a=n,o="";a?o=a.getKey():(o=i.getSelection().getAnchorKey(),a=r.get(o));var s=a.getCharacterList().map((function(t){return t?t.set("style",t.get("style").clear()):t})),c=a.get("data"),d=l().Map(W(W({},c?c.toObject():{}),{},(N(e={},w.fB,void 0),N(e,S.Hb,void 0),N(e,P.gg,void 0),e))),h=a.set("characterList",s).set("data",d),p=r.set(o,h);return u.EditorState.push(i,u.ContentState.createFromBlockArray(p.toArray()),"change-inline-style")},getStyleFromSelection:Q,getBlockData:function(t){var e,i=t.editorState,n=t.block,r=t.key;if(n)e=n;else if(i){var a=i.getSelection().getAnchorKey();e=i.getCurrentContent().getBlockMap().get(a)}if(!e)return"";var o=e.getData().toObject();return r?o&&o[r]||void 0:o},setBlockData:function(t){var e=t.editorState,i=t.block,n=t.key,r=t.value,a=J(e);if(i){var o=tt({editorState:e,selection:a,blockKey:i.getKey(),data:N({},n,r)});return u.EditorState.push(e,o,"change-block-data")}return et(e).reduce((function(t,i){var o=tt({editorState:t,selection:a,blockKey:i,data:N({},n,r)});return u.EditorState.push(e,o,"change-block-data")}),e)},getSelectedBlocks:et,isBlockSelected:function(t,e){return et(t).includes(e)},insertText:function(t){var e=t.editorState,i=t.text,n=t.selection,r=e.getCurrentInlineStyle(),a=n||e.getSelection(),o=e.getCurrentContent(),s=a.isCollapsed()?u.Modifier.insertText(o,a,i,r):u.Modifier.replaceText(o,a,i,r);return u.EditorState.push(e,s,1===i.length?"insert-characters":"insert-fragment")},removeText:function(t){var e=t.editorState,i=t.selection,n=e.getCurrentContent(),r=u.Modifier.removeRange(n,i,"forward");return u.EditorState.push(e,r,"remove-range")},getTextFromTextWidget:function(t){if(3===t.get("version")){var e=q(t.attributes),i=U(e);if(i){var n=document.createElement("span");return n.innerHTML=i,n.textContent||n.innerText}}return""},findSubstringIndexes:function(t,e){var i=t.getText();return Array.from(o()(i,RegExp(e,"g")),(function(t){return t.index})).filter((function(t){return"number"==typeof t}))},reverseSelection:function(t){return t.getIsBackward()?t.merge({isBackward:!1,anchorKey:t.getFocusKey(),anchorOffset:t.getFocusOffset(),focusKey:t.getAnchorKey(),focusOffset:t.getAnchorOffset()}):t},getSelectionOffset:it,doesSelectionHaveStyle:function(t){if(t.getSelection().isCollapsed()){var e=Q(t);return Boolean(e&&Object.keys(e).length)}var i=t.getCurrentContent(),n=it(t),r=n.startKey,a=n.endKey,o=n.startOffset,s=n.endOffset;if(r===a){var c=i.getBlockForKey(r).getCharacterList().slice(o,s).toJS();return nt(c)}return et(t).some((function(t){var e=i.getBlockForKey(t).getCharacterList(),n=r===t?o:0,c=a===t?s:e.size,l=e.slice(n,c).toJS();return nt(l)}))},selectCurrentBlock:function(t){var e=t.getSelection(),i=e.getStartKey();if(i===e.getEndKey()){var n=t.getCurrentContent(),r=e.merge({anchorKey:i,anchorOffset:0,focusOffset:n.getBlockForKey(i).getText().length,focusKey:i});return H(t,r)}return t},getWordCaretSelection:function(t,e){var i=t.getSelection();if(i.isCollapsed()){var n=t.getCurrentContent(),r=it(t),a=r.startKey,o=r.endKey,s=r.startOffset;r.endOffset;if(a===o){var c=n.getBlockForKey(a).getText(),l=null;if("next"===e)for(var d=s+1;d<=c.length;d++)null!==l||" "!==c[d]&&d!==c.length||(l=d);else if("prev"===e)for(var u=s-1;u>=0;u--)null===l&&(" "===c[u]&&Math.abs(s-u)>1||0===u)&&(l=0===u?0:u+1);if(null!==l){var h=i.merge({anchorKey:a,anchorOffset:l,focusOffset:o,focusKey:l});return H(t,h)}}}},cloneStylesOnReturn:function(t){var e=t.getSelection();if(e.isCollapsed()){var i=t.getCurrentContent(),n=e.getStartKey(),r=i.getBlockForKey(n);if(r){var a=r.getData(),o=u.Modifier.splitBlock(t.getCurrentContent(),t.getSelection()),s=u.EditorState.push(t,o,"split-block"),c=s.getSelection(),l=u.Modifier.mergeBlockData(s.getCurrentContent(),c,a);return{status:"handled",editorState:s=u.EditorState.push(t,l,"split-block")}}}},hasNewTextWidgets:function(t){if(!t)return!1;var e=W({},t);return!(!e.pages||!e.pages.length)&&e.pages.some((function(t){return t.wids&&t.wids.length&&rt(t.wids)}))},someTextWidgets:rt,getAllEntities:function(t,e){var i,n=t.getCurrentContent().getEntityMap(),r=null==n||null===(i=n.__getAll())||void 0===i?void 0:i.toJS();return r?e?(0,s.pick)(r,(function(t){return t.type===e})):r:{}},generateRandomKey:function(){for(var t;void 0===t||yt.hasOwnProperty(t)||!isNaN(+t);)t=Math.floor(Math.random()*bt).toString(32);return yt[t]=!0,t},getLigaturesType:function(t){var e=[g.e.RequiredLigatures,g.e.StandardLigatures,g.e.HistoricalLigatures,g.e.DiscretionaryLigatures];return t.filter((function(t){return e.includes(t)}))},getStylisticSets:function(t){var e=/^ss[\d]{2}$/i,i=Object.values(g.e).filter((function(t){return e.test(t)}));return t.filter((function(t){return i.includes(t)}))},getNumericVariations:function(t){var e=[g.e.LiningFigures,g.e.OldstyleFigures,g.e.ProportionalFigures,g.e.TabularFigures];return t.filter((function(t){return e.includes(t)}))},getFontWeightString:lt,getFontWeightFromString:function(t){var e=t&&L(t),i="v"===e[0];return{style:e[0]&&"i"===e[0]?"italic":"normal",weight:i?"initial":e[1]?100*parseInt(e[1]):400}},getFontFeatures:dt,getTextWidgetFontsList:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i={},n=!1,r=function(t){var e=t.fontFamily,i=t.fontStyle,n=t.fontWeight,r=[];if(e){var a=ft(e,f.f.FontFamily);if(r.push(a),a){r.push(i?ft(i,f.f.FontStyle):p.BX.fontStyle);var o=n?ft(String(n),f.f.FontWeight):p.BX.fontWeight;"number"!=typeof o&&"normal"===o[0]&&(o=p.BX.fontWeight),r.push("initial"===String(o)?"variable":o)}}return r.length?r.join("|"):null},a=(0,v.XZ)(),o=a||{project:[],global:[]},s=function(t,e){return e.filter((function(e){return e.offset<=t&&e.offset+e.length>=t}))},c=function(e){e.model;var i,n,a=e.viewport,c={},l=K(t,"blocks"),d=a&&(null===(i=t[a])||void 0===i?void 0:i.styles)||K(t,"styles")||[],u=a&&(null===(n=t[a])||void 0===n?void 0:n.blocksMeta)||K(t,"blocksMeta"),h=new Set([]),p=(0,v.we)()||{project:[],global:[]};return l.forEach((function(t){var e,i=u?u.find((function(e){return e.key===t.key})):t,n=i&&i.data;if(n){var a=n.textStyle;if(a&&(e=[].concat(L(o.project),L(o.global)).find((function(t){return!!t.name&&t.name.toLowerCase()===a.toLowerCase()})))){var c=e.cssProperties||{},l=c.fontFamily,g=c.fontWeight,m=c.fontStyle,v=r({fontFamily:l,fontStyle:m,fontWeight:g});v&&h.add(v)}var y=n.listStyle;if(y){var b=[].concat(L(p.project),L(p.global)).find((function(t){return!!t.name&&t.name.toLowerCase()===y.toLowerCase()}));if(b){var w=b.cssProperties||{},S=w.fontFamily,P=w.fontWeight,k=w.fontStyle,C=r({fontFamily:S,fontStyle:k,fontWeight:P});C&&h.add(C)}}}var x=d.find((function(e){return e.key===t.key}));if(x){var O,T=null===(O=x.inlineStyles.styles)||void 0===O?void 0:O.reduce((function(t,e){return t.push(e.offset),t.push(e.offset+e.length),t}),[]);if(T)T.map((function(t){return s(t,x.inlineStyles.styles).reduce((function(t,e){return e.styles.forEach((function(e){var i=$(e.split(";"),2),n=i[0],r=i[1];t[x.inlineStyles.keys[n]]=x.inlineStyles.values[r]})),t}),{})})).forEach((function(t){var i=e&&e.cssProperties||{},n=t[f.f.FontFamily]||i.fontFamily,a=t[f.f.FontStyle]||i.fontStyle,o=t[f.f.FontWeight]||i.fontWeight,s=r({fontFamily:n,fontStyle:a,fontWeight:o});s&&h.add(s)}))}})),h.forEach((function(t){c[t]=1})),c};if(t&&K(t,"blocks")&&(e.length?e:C.ZP.viewport_listall).map((function(e){var n=c({viewport:e,model:t});i=W(W({},i),n)})),n){var l=[p.BX.fontFamily,p.BX.fontStyle,p.BX.fontWeight].join("|");i[l]=1}return i},INLINE_STYLE_DELIMITER:ut,getStyleValueString:ht,applyInlineStyle:function(t){var e=t.key,i=t.value,n=t.editorState;if(n.getSelection().isCollapsed())return n;var r=pt(n,e);if(void 0===V(i))return r;var a=Array.isArray(i)?i.filter((function(t){return t})).length?i.filter((function(t){return t})).join(ut):null:i;return"string"==typeof a||"number"==typeof a||Array.isArray(a)?Pt.toggleInlineStyle(r,ht(e,a)):r},removeInlineStyle:pt,getCurrentInlineStylesFromString:ft,getCurrentInlineStyles:function(t,e){var i=t.getCurrentInlineStyle().toJS();if(!e)return i;var n=i.find((function(t){return t.startsWith(e)}));return n?ft(n,e):[]},minifyStyles:gt,unminifyStyles:vt,getInlineStyleForSelection:function(t){var e=t.editorState,i=t.key,n=t.defaultValue,r=Pt.fixSelection(e),a=e.getCurrentContent(),o=Pt.getSelectedBlocks(e).map((function(t){return a.getBlockForKey(t)})),c=[];if(!r.isCollapsed()){var l=function(t){var e=(0,s.uniq)(null==t?void 0:t.getStyle().toJS()).filter((function(t){return!i||t.startsWith(i)}));e.length?c.push.apply(c,L(e)):n&&i&&c.push(Pt.getStyleValueString(i,n))};if(1===o.length)o[0].getCharacterList().slice(r.getStartOffset(),r.getEndOffset()).forEach(l);else o.length>1&&o.forEach((function(t,e){var i=t.getCharacterList();0===e?i.slice(r.getStartOffset()).forEach(l):e===o.length-1&&i.slice(0,r.getEndOffset()).forEach(l),i.forEach(l)}))}return(0,s.uniq)(c)},getUsedTextStyles:function(t){var e=t.filter((function(t){return wt(t)&&3===t.version})),i=(0,v.XZ)(),n=e.reduce((function(t,e){var i=(e.blocksMeta||[]).filter((function(t){return!!t.data})).map((function(t){return t.data[y.MX]}));return C.ZP.viewport_listall.map((function(t){var n=e[t];n&&i.push.apply(i,L((n.blocksMeta||[]).filter((function(t){return!!t.data})).map((function(t){return t.data[y.MX]}))))})),i.length?[].concat(L(t),L(i)):t}),[]).filter((function(t){return t})),r=(0,s.uniq)(n);return[].concat(L(i.global),L(i.project)).filter((function(t){return r.includes(t.name)}))},getUsedLinkStyles:function(t){var e=t.filter((function(t){return wt(t)&&3===t.version})),i=(0,v.kh)(),n=e.reduce((function(t,e){var i=Object.values(e.entityMap||{}).filter((function(t){return t.type===x.kM&&!!t.data})).map((function(t){return t.data.linkStyle}));return C.ZP.viewport_listall.map((function(t){var n=e[t];n&&i.push.apply(i,L(Object.values(n.entityMap||{}).filter((function(t){return t.type===x.kM&&!!t.data})).map((function(t){return t.data.linkStyle}))))})),i.length?[].concat(L(t),L(i)).filter((function(t){return t})):t}),[]),r=(0,s.uniq)(n);return[].concat(L(i.global),L(i.project)).filter((function(t){return r.includes(t.name)}))},getUsedListStyles:function(t){var e=t.filter((function(t){return wt(t)&&3===t.version})),i=(0,v.we)(),n=e.reduce((function(t,e){var i=(e.blocksMeta||[]).filter((function(t){return!!t.data})).map((function(t){return t.data[b.iC]}));return C.ZP.viewport_listall.map((function(t){var n=e[t];n&&i.push.apply(i,L((n.blocksMeta||[]).filter((function(t){return!!t.data})).map((function(t){return t.data[b.iC]}))))})),i.length?[].concat(L(t),L(i)):t}),[]).filter((function(t){return t})),r=(0,s.uniq)(n);return[].concat(L(i.global),L(i.project)).filter((function(t){return r.includes(t.name)}))},canUseCustomFonts:function(t){return window.RM.constructorRouter.isOwner?(window.RM.constructorRouter.me&&window.RM.constructorRouter.me.get("permissions")||{}).can_use_custom_fonts:t.get("permissions").can_use_custom_fonts},insertBreakLine:function(t){return u.RichUtils.insertSoftNewline(t)},moveText:function(t){var e=t.editorState,i=t.dropSelection,n=u.Modifier.moveText(e.getCurrentContent(),e.getSelection(),i);return u.EditorState.push(e,n,"insert-fragment")},isWholeBlockSelected:function(t){var e=t.getSelection(),i=t.getCurrentContent();if(!e.isCollapsed()){var n=et(t);if(!n.length)return!1;if(1===n.length&&e.getStartKey()===e.getEndKey()){var r=i.getBlockForKey(e.getStartKey()).getText().length;if(e.getEndOffset()-e.getStartOffset()===r)return!0}else{if(1===n.length&&0===e.getStartOffset()&&0===e.getEndOffset()&&e.getStartKey()!==e.getEndKey())return!0;var a=i.getBlockForKey(e.getEndKey()).getText().length,o=e.getStartOffset(),s=e.getEndOffset();if(0===o&&s===a)return!0}}return!1},getBaseLineHeightStyle:function(t){var e=t.block,i=t.width;if(!e)return{};var n,r=e.getType(),a=(0,y.x6)({block:e});if(r||a){var o=(0,v.XZ)()||{project:[],global:[]};n=[].concat(L(o.project),L(o.global)).find((function(t){return!!t.name&&(t.name.toLowerCase()===r.toLowerCase()||t.name.toLowerCase()===a.toLowerCase())}))}for(var s=n&&n.cssProperties||{},c=0,l=0,d=[],u=e.getCharacterList(),h=e.getText(),p=h.length;c<p;){var g=u.get(c);if(g){var m,b=(null===(m=g.getStyle())||void 0===m?void 0:m.toJS())||[],w=h[c],S=b.find((function(t){return t.startsWith(f.f.FontFamily)})),P=b.find((function(t){return t.startsWith(f.f.FontStyle)})),k=b.find((function(t){return t.startsWith(f.f.FontWeight)})),C=b.find((function(t){return t.startsWith(f.f.FontSize)})),x={fontFamily:S&&ft(S,f.f.FontFamily)[0]||s.fontFamily,fontStyle:P&&ft(P,f.f.FontStyle)[0]||s.fontStyle,fontSize:C&&ft(C,f.f.FontSize)[0]||String(s.fontSize),fontWeight:k?parseInt(ft(k,f.f.FontWeight)[0]):s.fontWeight},O=St(w,x);O&&(l+=O.width,d.push({fontFamily:x.fontFamily,fontSize:x.fontSize,fontWeight:x.fontWeight}))}if(c+=1,l>=i)break}var T={},_={},Z={};d.map((function(t){t.fontFamily&&(T[t.fontFamily]=(T[t.fontFamily]||0)+1),t.fontSize&&(Z[t.fontSize]=(Z[t.fontSize]||0)+1),t.fontWeight&&(_[t.fontWeight]=(_[t.fontWeight]||0)+1)}));var M=function(t){var e=Object.keys(t);if(e.length)return e.reduce((function(e,i){return t[e]>t[i]?e:i}))},I=M(T)||s.fontFamily,$=M(Z)||(s.fontSize?String(s.fontSize):void 0);return{fontFamily:I,fontWeight:M(_)||(s.fontWeight?parseInt(String(s.fontWeight)):void 0),fontSize:$?$.includes("px")?$:"".concat($,"px"):void 0}},getTextSize:St,setDefaultStyles:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=!!e[y.MX],n=i?{}:p.BX,r=i?null:(0,T.tZ)(_.ZP.textWidget.initialColor),a=[{key:f.f.FontSize,value:e[f.f.FontSize]||n.fontSize},{key:f.f.FontFamily,value:e[f.f.FontFamily]||n.fontFamily},{key:f.f.FontWeight,value:e[f.f.FontWeight]||n.fontWeight},{key:f.f.FontStyle,value:e[f.f.FontStyle]||n.fontStyle},{key:f.f.Color,value:e[f.f.Color]||r},{key:w.fB,value:e[w.fB]||n.lineHeight},{key:S.Hb,value:e[S.Hb]||n.textAlign},{key:I.Yv,value:e[I.Yv]||!0},{key:y.MX,value:e[y.MX]}];return e[f.f.LetterSpacing]&&(a[f.f.LetterSpacing]=e[f.f.LetterSpacing]),e[f.f.FontFeature]&&(a[f.f.FontFeature]=e[f.f.FontFeature]),a.reduce((function(t,e){return e.value?e.key===w.fB?(0,w.z3)({editorState:t,lineHeight:e.value}):e.key===S.Hb?(0,S.Oh)({editorState:t,align:e.value}):e.key===I.Yv?(0,I.w7)({editorState:t,linkedStatus:e.value}):e.key===y.MX?(0,y.ne)({editorState:t,styleName:e.value}):G(t,ht(e.key,e.value)):t}),H(t,X({content:t.getCurrentContent(),selection:t.getSelection()})))},preserveBlockInlineStyles:function(t,e){var i=e.getCurrentContent().getBlockMap(),n=t.getCurrentContent().getBlockMap(),r=String.fromCharCode(8205),a=n.filter((function(t){if(t){var e=i.get(t.getKey());if(!e||!e.getText().length)return;var n=t.getText().length;return!(0,y.x6)({block:t})&&!n}return!1})),o=n.filter((function(t){var e=null==t?void 0:t.getText();return e&&e.length>1&&e.includes(r)}));if(o.size){var s=o.reduce((function(t,e){if(e){var i=e.getKey(),n=e.getText(),a=n.indexOf(r),o=e.getCharacterList().delete(a),s=e.set("characterList",o).set("text",n.replace(r,""));return t.set(i,s)}return t}),n);return u.EditorState.set(t,{currentContent:u.ContentState.createFromBlockArray(s.toArray())})}if(a.size){var c=a.reduce((function(t,e){if(e){var n=e.getKey(),a=i.get(n),o=i.last(),s=a?a.getCharacterList().slice(0,1):o.getCharacterList().slice(-1),c=e.set("text",r).set("characterList",s);return t.set(n,c)}return t}),n);return u.EditorState.set(t,{currentContent:u.ContentState.createFromBlockArray(c.toArray())})}return t},silentEntityToggle:function(t,e,i){var n=t.getSelection(),r=u.Modifier.applyEntity(t.getCurrentContent(),e,i);return u.EditorState.set(t,{currentContent:r,selection:n})},mergeBlocksStyles:function(t){var e=t.originStyles,i=t.blockMap,n=t.forceOverride,r=void 0!==n&&n;return i.map((function(t){if(t){var i=t.getCharacterList().map((function(t){var i=t;if(i){var n=e;if(r)i=i.set("style",i.get("style").clear());else{var a=i.getStyle().toArray().map((function(t){return $(t.split(Pt.INLINE_STYLE_DELIMITER),1)[0]}));n=e.filter((function(t){if(t){var e=$(t.split(Pt.INLINE_STYLE_DELIMITER),1)[0];return!a.includes(e)}return!0}))}return n.toArray().reduce((function(t,e){return u.CharacterMetadata.applyStyle(t,e)}),i)}return i}));return t.set("characterList",i)}}))},getRealContentHeight:function(t){var e=t.editorState,i=t.width,n=t.model,a=document.createElement("div");a.style.position="absolute",a.style.left="-9999px",a.style.opacity="0",a.style.visibility="hidden",a.style.width="".concat(i,"px"),(0,M.renderReact)({component:function(){return r().createElement(Z.Z,{editorState:e})},model:n,domElement:a}),document.body.appendChild(a);var o=a.clientHeight;return document.body.removeChild(a),o},isUrl:function(t){return/^(.*):\/\/[^\s$.?#].[^\s]*$/i.test(t)||/^[\da-z.-]+\.[a-z-]{2,}.*/i.test(t)},getDefaultListTextColor:function(t){var e=t.getCharacterList();if(e){var i=e.first();if(i){var n=i.getStyle().find((function(t){return!!t&&t.startsWith(f.f.Color)}));if(n){var r=$(n.split(ut),2);r[0];return r[1]}}}return(0,T.tZ)(_.ZP.textWidget.initialColor)},calculateLetterSpacing:function(t){var e=t.letterSpacing,i=t.fontSize,n=e+e/i*(t.newFontSize-i);return parseFloat((Math.round(100*n)/100).toFixed(2))}};e.Z=Pt},709:function(t,e,i){"use strict";var n=i(660),r=i(352),a=i.n(r),o=i(711),s=i(620),c=i(680),l=i(704),d=i(624),u=i(710),h=i(343),p=(0,n.default)(o.Flex).withConfig({displayName:"TextBase___StyledFlex"})(["--editor-border-color:",";direction:",";overflow:",";",";"," & > div{","}*::selection{"," ","}.public-DraftEditor-content{white-space:normal !important;overflow-wrap:break-word;}.text-viewer{overflow-wrap:break-word;white-space:normal;}"," & div[data-contents='true'],.text-viewer{font-feature-settings:'liga' 0,'rlig' 0,'dlig' 0,'hlig' 0,'smcp' 0;font-family:",";font-weight:",";font-style:",";font-size:","px;line-height:","px;-webkit-nbsp-mode:normal;-webkit-line-break:after-white-space;white-space:pre-wrap;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;}"],(function(t){return t._css}),(function(t){return t._css2}),(function(t){return t._css3}),(function(t){return t._css4}),(function(t){return t._css5}),(function(t){return t._css6}),(function(t){return t._css7}),(function(t){return t._css8}),(function(t){return t._css9}),(function(t){return t._css10}),(function(t){return t._css11}),(function(t){return t._css12}),(function(t){return t._css13}),(function(t){return t._css14})),f=function(t,e){var i=t.textDirection,n=t.autosize,r=t.columns,o=t.verticalAlign,f=t.bgColor,g=t.shouldShowSelectionBorder,m=t.scale,v=t.viewport,y=t.viewerOptions,b=t.children,w=t.useBaseline,S=t.isEditMode,P=t.selectionColor,k=t.disableSelectionHighlight,C=f?(0,d.gn)(f):void 0,x=C?"rgba(".concat(C.r,", ").concat(C.g,", ").concat(C.b,", ").concat(C.a,")"):void 0,O=null!=P&&P.backgroundColor?(0,d.gn)(P.backgroundColor):void 0,T=k?"transparent":O?"rgba(".concat(O.r,", ").concat(O.g,", ").concat(O.b,", ").concat(O.a,")"):void 0,_=null!=P&&P.textColor?(0,d.gn)(P.textColor):void 0,Z=k?"inherit":_?"rgba(".concat(_.r,", ").concat(_.g,", ").concat(_.b,", ").concat(_.a,")"):void 0;return a().createElement(p,{ref:e,height:!n||r&&r.count>1?"100%":"auto",flexDirection:"column",justifyContent:o&&o!==c.Rr.top?"flex-end":"flex-start",bg:x,_css:g?(0,l.themeGet)("colors.blue"):"transparent",_css2:i,_css3:r&&r.count>1||!n?"hidden":"visible",_css4:S?"padding: 0 ".concat(4,"px;"):"",_css5:m&&u.Z.isOnForRatio(v||h.sJ.Default,m,y||{})&&u.Z.isCSSZoom()?"\n              width: ".concat("".concat(1/m*100,"%"),";\n              height: ","".concat(1/m*100,"%"),";\n              zoom: ",1/m,";\n              transform: ","scale(".concat(m,")"),";\n              transform-origin: left top;\n            "):"",_css6:r&&r.count>1&&"\n            min-height: 100%;\n            column-fill: auto;\n            column-count: ".concat(r.count,";\n            column-gap: ").concat(r.gap,"px;\n          "),_css7:Z?"color: ".concat(Z,";"):"",_css8:T?"background-color: ".concat(T,";"):"",_css9:w?"":"\n          .text-viewer span,\n          .text-viewer a,\n          & div[data-contents='true'] span,\n          & div[data-contents='true'] a {\n            line-height: inherit;\n            vertical-align: top;\n          }\n        ",_css10:s.BX.fontFamily,_css11:s.BX.fontWeight,_css12:s.BX.fontStyle,_css13:s.BX.fontSize,_css14:s.BX.lineHeight},b)};e.Z=a().forwardRef(f)},985:function(t,e,i){"use strict";var n=i(660),r=(i(352),i(322),i(674),i(445),i(986),i(351),i(680),i(655),i(621),i(984),i(673),i(684),i(976),i(340),i(659),i(653),i(623),i(620),i(707),i(711));i(709);(0,n.default)(r.Box).withConfig({displayName:"TextConstructor___StyledBox"})(["user-select:none;"]),(0,n.default)(r.Box).withConfig({displayName:"TextConstructor___StyledBox2"})(["user-select:none;"]),(0,n.default)(r.Box).withConfig({displayName:"TextConstructor___StyledBox3"})(["user-select:none;"]),(0,n.default)(r.Box).withConfig({displayName:"TextConstructor___StyledBox4"})(["user-select:none;"]),(0,n.default)(r.Box).withConfig({displayName:"TextConstructor___StyledBox5"})(["width:calc(var(--workspace-inverse-zoom) * 100%);height:calc(var(--workspace-inverse-zoom) * 100%);zoom:var(--workspace-inverse-zoom);transform:scale(var(--workspace-zoom));transform-origin:left top;"]),(0,n.default)(r.Box).withConfig({displayName:"TextConstructor___StyledBox6"})(["pointer-events:none;user-select:none;"])},983:function(t,e,i){"use strict";var n=i(660),r=(i(352),i(653),i(351),i(711));i(984),i(673),i(669),i(655),i(668),i(683),i(674),i(624),i(659);(0,n.default)(r.Box).withConfig({displayName:"TextConstructorWrapper___StyledBox"})(["padding:0 !important;&:after{content:'';pointer-events:none;box-shadow:1px 0 0 0 ",",0 1px 0 0 ",",1px 1px 0 0 ",",1px 0 0 0 "," inset,0 1px 0 0 "," inset;position:absolute;top:0;left:-1px;width:calc(100% + 1px);height:calc(100% - 1px);}div[data-offset-key]:before,& > li:before{","}"],(function(t){return t._css}),(function(t){return t._css2}),(function(t){return t._css3}),(function(t){return t._css4}),(function(t){return t._css5}),(function(t){return t._css6}))},986:function(t,e,i){"use strict";i(352),i(445),i(982),i(623),i(709),i(351),i(681),i(685),i(743)},984:function(t,e,i){"use strict";var n=i(660),r=(i(352),i(600),i(985),i(711)),a=i(769);(0,n.default)(r.Flex).withConfig({displayName:"TextPaddings___StyledFlex"})(["zoom:var(--workspace-inverse-zoom);transform:scale(var(--workspace-zoom));transform-origin:left top;"]),(0,n.default)(a.default).withConfig({displayName:"TextPaddings___StyledInlineInput"})(["user-select:none !important;appearance:textfield;padding:0 !important;border:none !important;&::-webkit-outer-spin-button,&::-webkit-inner-spin-button{appearance:none;}"]),(0,n.default)(r.Box).withConfig({displayName:"TextPaddings___StyledBox"})(["cursor:",";"],(function(t){return t._css})),(0,n.default)(r.Box).withConfig({displayName:"TextPaddings___StyledBox2"})(["opacity:",";visibility:",";user-select:none;"],(function(t){return t._css2}),(function(t){return t._css3})),(0,n.default)(r.Box).withConfig({displayName:"TextPaddings___StyledBox3"})(["",""],(function(t){return t._css4}))},707:function(t,e,i){"use strict";i.d(e,{Z:function(){return V}});var n=i(660),r=i(352),a=i.n(r),o=i(440),s=i.n(o),c=i(445),l=i(672),d=i.n(l),u=i(674),h=i(680),p=i(351),f=i(623),g=i(708),m=i(441),v=i(709),y=i(671),b=i(670),w=i(673),S=i(659);function P(t){return function(t){if(Array.isArray(t))return k(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return k(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return k(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var C=function t(e,i){if(i&&"function"==typeof i){for(var n=e.childNodes,r=0;r<n.length;r++)t(n[r],i);i(e)}},x=function(t){var e,i=function(t){var e=document.implementation.createHTMLDocument("");return e.documentElement.innerHTML=t,e};if("undefined"!=typeof DOMParser){var n=new DOMParser;try{null!==(e=n.parseFromString(t,"text/html"))&&null!==e.body||(e=i(t))}catch(n){e=i(t)}}else e=i(t);return e},O=function(t,e){var i=Array.from(t.childNodes).reduce((function(t,i){return i.nodeName.toLowerCase()===e&&t[t.length-1]&&t[t.length-1].some((function(t){return t.nodeName.toLowerCase()===e}))?(t[t.length-1].push(i),t):[].concat(P(t),[[i]])}),[]).reduce((function(t,i){if(i.some((function(t){return t.nodeName.toLowerCase()===e}))){var n=document.createElement(e),r="ul"===e?S.dY.Unordered:S.dY.Ordered;return n.setAttribute("class",r),"ol"===e&&(n.style.counterReset=S.Hf),i.forEach((function(t){if(t.firstChild){var e,i=t.firstChild.cloneNode(!0),a=null===(e=t.getAttribute("class"))||void 0===e?void 0:e.replace(r,""),o=t.getAttribute("style");a&&i.setAttribute("class",a),o&&i.setAttribute("style",o),n.appendChild(i)}})),[].concat(P(t),[n])}return[].concat(P(t),P(i))}),[]).reduce((function(t,e){return"".concat(t).concat(e.outerHTML)}),"");t.innerHTML=i},T=function(t){C(t,(function(t){if("span"===t.nodeName.toLowerCase()&&1===t.childNodes.length&&t.firstChild&&"span"===t.firstChild.nodeName.toLowerCase()){var e=t,i=e.firstChild,n=[e.getAttribute("style"),i.getAttribute("style")];e.setAttribute("style",n.join(";")),e.innerHTML=t.firstChild.innerHTML}}))},_=function(t){C(t,(function(t){if("a"===t.nodeName.toLowerCase()&&t.childNodes.length>1){var e=Array.from(t.childNodes).reduce((function(t,e){if("span"===e.nodeName.toLowerCase()&&e.style.fontSize){var i=parseInt(e.style.fontSize);return i>t?i:t}return t}),0);e>0&&(t.style.fontSize="".concat(e,"px"))}}))},Z=function(t){t.querySelectorAll("li").forEach((function(t){if(t.childNodes.length){var e=document.createElement("span");e.innerHTML=t.innerHTML,t.innerHTML=e.outerHTML,e.remove()}}))},M=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{mergeSpans:!0},i=x(t);return e.mergeSpans&&T(i.body),O(i.body,"ol"),O(i.body,"ul"),Z(i.body),_(i.body),i.body.innerHTML},I=i(653),$=i(308),E=i(343),D=i(624);function L(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function j(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function A(t){return function(t){if(Array.isArray(t))return B(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||F(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){r=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return i}(t,e)||F(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(t,e){if(t){if("string"==typeof t)return B(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?B(t,e):void 0}}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var z=(0,n.default)(S.iZ).withConfig({displayName:"TextViewer___StyledListViewerWrapper"})(["&:before{","}"],(function(t){return t._css})),W=function(t){var e,i,n=t.model,o=t.scale,c=t.currentPage,l=t.viewport,u=t.viewerOptions,g=t.editorState,P=(0,r.useMemo)((function(){return g.getCurrentContent()}),[g]),k=null===(e=n.flags)||void 0===e?void 0:e.calculatedLineHeight,C=R((0,I.sJ)(),1)[0],x=(0,r.useContext)(w.T).model,O=(0,r.useMemo)((function(){return(0,m.cn)({styleToHTML:function(t){var e=s().OrderedSet([t]),i=(0,f.b)(e);if(Object.keys(i).length)return a().createElement("span",{style:i})},blockToHTML:function(t){var e=P.getBlockForKey(t.key),i=t.data,r=i.textStyle,o=i.align,s=i.lineHeight,c=i.textIndent,l=i.paddings,d=void 0===l?{}:l,u=i.listStyle,h=(0,S.nq)(t.type)?u:void 0,f=[t.type,r,o,h].filter((function(t){return t})).join(" "),g=k?p.Z.getBaseLineHeightStyle({block:e,width:n.w}):{},m=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?L(Object(i),!0).forEach((function(e){j(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):L(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({textIndent:c,lineHeight:s?"".concat(s,"px"):void 0,paddingLeft:d.left,paddingRight:d.right,paddingTop:d.top,paddingBottom:d.bottom},g);if((0,S.nq)(t.type)){var v="";if(!(0,S.XZ)({block:e})){var y=(0,D.gn)(p.Z.getDefaultListTextColor(e)),b=y.r,w=y.g,x=y.b,O=y.a;v="rgba(".concat(b,", ").concat(w,", ").concat(x,", ").concat(O,")")}return a().createElement(z,{type:t.type,className:f,style:m,_css:v?"color: ".concat(v,";"):""})}var T=function(t){var e=[].concat(A(C.global),A(C.project)).find((function(e){return e.name===t}));return e?e.tag:$.ZP.AVAILABLE_TEXT_TAGS[0]}(r),_={className:f,style:m};return t.text||t.entityRanges&&t.entityRanges.length?a().createElement(T,_):a().createElement(T,_,a().createElement("br",null))},entityToHTML:function(t,e){var i=e;return t.type===y.kM?a().createElement(y.rU,{is_global:n.is_global,is_above:n.is_above,page:null==x?void 0:x.page,currentPageNum:null==c?void 0:c.num,data:t.data},i):t.type===b.b3?a().createElement("br",null):i}})(P)}),[P,C,c]);return a().createElement(v.Z,{bgColor:n.bgColor,textDirection:n.textDirection||h.m5.LTR,autosize:n.autosize,columns:n.columns,verticalAlign:n.verticalAlign,scale:o,viewport:l||E.sJ.Default,viewerOptions:u,useBaseline:null===(i=n.flags)||void 0===i?void 0:i.baseline,selectionColor:n.selectionColor},a().createElement("div",{className:"text-viewer",dangerouslySetInnerHTML:{__html:d().sanitize(M(O,{mergeSpans:!0}),{ALLOW_UNKNOWN_PROTOCOLS:!0,ADD_ATTR:["target"]})}}))},N=a().memo(W,(function(t,e){var i,n,r,a,o,s;return e.scale===t.scale&&(!e.isConstructorPreview&&(null===(i=e.model)||void 0===i||!i.is_above||!(null===(n=t.currentPage)||void 0===n||!n.num||null!==(r=e.pagesLinks)&&void 0!==r&&r.length&&null!==(a=e.currentPage)&&void 0!==a&&a.num&&null!==(o=t.currentPage)&&void 0!==o&&o.num&&(e.pagesLinks.includes(e.currentPage.num)||e.pagesLinks.includes(null===(s=t.currentPage)||void 0===s?void 0:s.num)))))})),V=function(t){var e=t.editorState,i=t.isConstructorPreview,n=(0,r.useContext)(w.T).model,o=(0,r.useContext)(u.BackboneContext).model,s=e||(0,r.useMemo)((function(){return c.EditorState.createWithContent(p.Z.importTextContent(o),g.t)}),[]),l=window.RM.constructorRouter&&!window.RM.constructorRouter.preview,d=(0,r.useMemo)((function(){if(l)return[];var t=p.Z.getAllEntities(s,y.kM);return Object.keys(t).length?Object.keys(t).filter((function(e){var i;return(null===(i=t[e].data)||void 0===i?void 0:i.type)===y.dr.Page})).map((function(e){var i;return null===(i=t[e].data)||void 0===i?void 0:i.pageNum})):[]}),[s]);return a().createElement(N,{model:o,editorState:s,scale:null==n?void 0:n.scale,currentPage:null==n?void 0:n.currentPage,viewport:null==n?void 0:n.viewport,viewerOptions:null==n?void 0:n.viewerOptions,isConstructorPreview:i,pagesLinks:d})}},673:function(t,e,i){"use strict";i.d(e,{x:function(){return a},T:function(){return o}});var n=i(352),r=i.n(n),a=r().createContext({}),o=r().createContext({})},638:function(t,e){"use strict";function i(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function n(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function a(t,e,i,n,r,a,o){try{var s=t[a](o),c=s.value}catch(t){return void i(t)}s.done?e(c):Promise.resolve(c).then(n,r)}var o=function(){var t,e=(t=regeneratorRuntime.mark((function t(e,i){var r,a,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e,n({headers:{"Content-Type":"application/json"}},i));case 2:if(a=t.sent,null===(r=a.headers.get("content-type"))||void 0===r||!r.includes("application/json")){t.next=9;break}return t.next=6,a.json();case 6:t.t0=t.sent,t.next=12;break;case 9:return t.next=11,a.text();case 11:t.t0=t.sent;case 12:if(o=t.t0,!a.ok){t.next=17;break}return t.abrupt("return",o);case 17:throw{message:o&&"string"!=typeof o?o.message:o,statusCode:a.status};case 18:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(n,r){var o=t.apply(e,i);function s(t){a(o,n,r,s,c,"next",t)}function c(t){a(o,n,r,s,c,"throw",t)}s(void 0)}))});return function(t,i){return e.apply(this,arguments)}}();e.Z={get:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Object.keys(e).map((function(t){var i=e[t];return Array.isArray(i)?i.map((function(e){return"".concat(encodeURIComponent("".concat(t,"[]")),"=").concat(encodeURIComponent(e))})).join("&"):"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(i))})).join("&");return o("".concat(t).concat(n?"?".concat(n):""),i)},post:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o(t,n({method:"POST",body:JSON.stringify(e)},i))},patch:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o(t,n({method:"PATCH",body:JSON.stringify(e)},i))},put:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o(t,n({method:"PUT",body:JSON.stringify(e)},i))},delete:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o(t,n({method:"DELETE",body:e?JSON.stringify(e):void 0},i))},sendBeacon:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return navigator.sendBeacon?navigator.sendBeacon(t,new Blob([JSON.stringify(e)],{type:"application/json; charset=UTF-8"})):o(t,{method:"POST",body:JSON.stringify(e)})}}},651:function(t,e,i){"use strict";i(638)},650:function(t,e,i){"use strict";i(638)},640:function(t,e,i){"use strict";i.d(e,{WN:function(){return r}});var n=i(638),r=function(t){return n.Z.post("/api/font-features",t)}},652:function(t,e,i){"use strict";i.d(e,{b:function(){return u}});var n=i(638);function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function a(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){o(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return l(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var d=function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n={};return Object.keys(e).forEach((function(r){var o=[].concat(c(i),[r]).join("."),l=e[r];["string","number","boolean"].includes(s(l))?n[o]=e[r]:"object"===s(l)&&null!==l&&(n=a(a({},n),t(l,[].concat(c(i),[r]))))})),n},u=function(t,e){if(!(window.RM.common.isDownloadedSource&&!window.RM.common.homepageRewrite)){var i=a(a({},d(e)),{},{user_agent:window.navigator.userAgent,event_timing_ms:Date.now()-window.performance.timing.navigationStart,event_timestamp:Date.now()});n.Z.post("/api/proxy/honeycomb",{event:i,dataset:t})}}},636:function(t,e,i){"use strict";i.d(e,{WN:function(){return n.WN},Wf:function(){return r.Wf},pV:function(){return a.pV},e5:function(){return o.e5},HC:function(){return s.H},EV:function(){return s.E},bF:function(){return c.b}});i(637),i(639);var n=i(640),r=(i(642),i(643)),a=i(644),o=(i(645),i(646),i(647)),s=i(648),c=(i(649),i(650),i(651),i(652))},644:function(t,e,i){"use strict";i.d(e,{pV:function(){return r}});var n=i(638),r=function(t){var e=t.projectId,i=t.styles;return n.Z.put("/api/link-styles/project/".concat(e),{styles:i})}},645:function(t,e,i){"use strict";i(638)},639:function(t,e,i){"use strict";i(638)},642:function(t,e,i){"use strict";i(638)},647:function(t,e,i){"use strict";i.d(e,{e5:function(){return r}});var n=i(638),r=function(t){return n.Z.get("/api/projects/".concat(t))}},648:function(t,e,i){"use strict";i.d(e,{H:function(){return o},E:function(){return s}});var n=i(308),r=i(638);function a(t,e,i,n,r,a,o){try{var s=t[a](o),c=s.value}catch(t){return void i(t)}s.done?e(c):Promise.resolve(c).then(n,r)}var o=function(){var t,e=(t=regeneratorRuntime.mark((function t(e,i){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=new FormData).append("widgetId",i),r.append("upload",e.slice(0,Math.min(e.size,n.ZP.SHOTS_UPLOAD_SIZE_LIMT))),t.next=5,fetch("/api/shots/upload/video",{method:"post",body:r}).then((function(t){return t.json()}));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(n,r){var o=t.apply(e,i);function s(t){a(o,n,r,s,c,"next",t)}function c(t){a(o,n,r,s,c,"throw",t)}s(void 0)}))});return function(t,i){return e.apply(this,arguments)}}(),s=function(t,e){return r.Z.post("/api/shots/convert/fromurl",{videoUrl:t,widgetId:e})}},637:function(t,e,i){"use strict";i(638)},646:function(t,e,i){"use strict";i(638)},643:function(t,e,i){"use strict";i.d(e,{Wf:function(){return r}});var n=i(638),r=function(t){var e=t.projectId,i=t.styles;return n.Z.put("/api/text-styles/project/".concat(e),{styles:i})}},649:function(t,e,i){"use strict";i(638)},624:function(t,e,i){"use strict";i.d(e,{vx:function(){return s},gn:function(){return c},tZ:function(){return l},vK:function(){return d}});var n=i(625),r=i.n(n);i(634);function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){r=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var s=function(t){var e=Number(t).toString(16);return e.length<2?"0".concat(e):e},c=function(t){var e=t;if(!e)return{r:0,g:0,b:0,a:1};"#"===e[0]&&(e=e.slice(1));var i=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4,6),16),a=parseInt(e.substring(6,8),16)/100;return{r:i,g:n,b:r,a:void 0===a||a>1?1:a<0?0:a}},l=function(t){var e=s(parseInt((100*t.a).toFixed(0))),i=r()({h:t.h,s:t.s,v:t.v}).hex().replace("#","");return"".concat(i).concat(e)},d=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=t.replace("#",""),n=r()("#".concat(i)).hsv().array(),o=a(n,3),s=o[0],c=o[1],l=o[2];return{h:s,s:c,v:l,a:e}}},743:function(t,e,i){"use strict";var n;!function(t){t.UpgradeAccountToUse="upgradeAccountToUse",t.EcommHasInvalidAddToCartWidget="ecommHasInvalidAddToCartWidget",t.WorkspaceAnimationTriggerRemoved="workspaceAnimationTriggerRemoved",t.WorkspaceAnimationTriggerUnlinked="workspaceAnimationTriggerUnlinked",t.BottomBlocksToMove="bottomBlocksToMove",t.EduTipUseViewportsIcon="eduTipUseViewportsIcon",t.EduTipOnDeleteMobileWidget="eduTipOnDeleteMobileWidget",t.EduTipUseBundleDragTriangle="eduTipUseBundleDragTriangle",t.EduTipUseShortcutToChangeSizes="eduTipUseShortcutToChangeSizes",t.EduTipUseShortcutToMoveText="eduTipUseShortcutToMoveText",t.EduTipUseShortcutToCopyAnimation="eduTipUseShortcutToCopyAnimation",t.EduTipUseShortcutToEnableGuides="eduTipUseShortcutToEnableGuides",t.EduTipUseShortcutToEnableSizes="eduTipUseShortcutToEnableSizes",t.EduTipUseFix="eduTipUseFix",t.EduTipUseAbovePages="eduTipUseAbovePages",t.EduTipUseStylesForText="eduTipUseStylesForText",t.EduTipUseShortcutForGroup="eduTipUseShortcutForGroup",t.EduTipSetNamesForWidgets="eduTipSetNamesForWidgets",t.EduTipUseResrtorePanel="eduTipUseResrtorePanel",t.TextWidgetPasteWithoutFormatting="textWidgetPasteWithoutFormatting"}(n||(n={}))},674:function(t,e,i){"use strict";i.r(e),i.d(e,{BackboneContext:function(){return p},BackboneContextProvider:function(){return f},BackboneCollectionContextProvider:function(){return g},CreateContextProvider:function(){return m},renderReact:function(){return v}});var n=i(675),r=i(352),a=i.n(r),o=i(600),s=i.n(o);function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){d(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){r=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return h(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var p=a().createContext({}),f=function(t){var e=t.domElement,i=t.model,n=t.children,o=t.context,c={modelSet:function(t,e){return i.set(t,e)},modelUnset:function(t,e){return i.unset(t,e)},modelSave:function(t,e){return i.save(t,e)},destroy:function(){e&&(s().unmountComponentAtNode(e),e&&e.parentNode&&e.parentNode.removeChild(e))}},d=u((0,r.useState)({model:i.attributes}),2),h=d[0],p=d[1],f=function(t){p(l(l({},h),{},{model:t.attributes}))};return(0,r.useEffect)((function(){return i.on("change",f),function(){i.off("change",f)}}),[i]),a().createElement(o.Provider,{value:l(l({},h),c)},n)},g=function(t){var e=t.domElement,i=t.collection,n=t.children,o=t.context,c={elementSet:function(t,e,n){var r=i.get(t);if(!r)throw new Error("Element not found");return r.set(e,n)},elementUnset:function(t,e,n){var r=i.get(t);if(!r)throw new Error("Element not found");return r.unset(e,n)},elementSave:function(t,e,n){var r=i.get(t);if(!r)throw new Error("Element not found");return r.save(e,n)},destroy:function(){e&&(s().unmountComponentAtNode(e),e&&e.parentNode&&e.parentNode.removeChild(e))}},d=u((0,r.useState)({collection:i.map((function(t){return t.attributes}))}),2),h=d[0],p=d[1],f=function(t){var e=t.get("_id");p((function(i){var n=i.collection.findIndex((function(t){return t._id===e}));if(-1===n)return{collection:i.collection};var r=i.collection.splice(0);return r[n]=t.attributes,{collection:r}}))},g=function(t){p((function(e){var i=e.collection.splice(0);return i.push(t.attributes),{collection:i}}))},m=function(t){var e=t.get("_id");p((function(t){var i=t.collection.findIndex((function(t){return t._id===e}));if(-1===i)return{collection:t.collection};var n=t.collection.splice(0);return n.splice(i,1),{collection:n}}))};return(0,r.useEffect)((function(){return i.on("change",f),i.on("add",g),i.on("remove",m),function(){i.off("change",f),i.off("add",g),i.on("off",m)}}),[i]),a().createElement(o.Provider,{value:l(l({},h),c)},n)},m=function(t){var e=t.model,i=t.collection,n=t.domElement,r=t.context,o=t.children;return e?a().createElement(f,{model:e,domElement:n,context:r},o):i?a().createElement(g,{collection:i,domElement:n,context:r},o):a().createElement(a().Fragment,null,o)},v=function(t){var e=t.component,i=t.domElement,r=t.model;r?s().render(a().createElement(n.Z,null,a().createElement(m,{model:r,domElement:i,context:p},a().createElement(e,null))),i):s().render(a().createElement(e,null),i)}},350:function(t,e,i){"use strict";function n(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,{_:function(){return o}});var a=window.ServerData.featureFlags?function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach((function(e){r(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},window.ServerData.featureFlags):{},o=function(t){return a[t]||!1}},654:function(t,e,i){"use strict";i.d(e,{M:function(){return o}});var n=i(352);function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){r=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return a(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function o(t){var e=t,i=[];function a(t){var n=e;e=t,i.forEach((function(e){var i=e.update,r=e.options;(!r||!r.shouldUpdate||!r.shouldUpdate(n,t))&&i()}))}return[function(t){var o,s=(o=r((0,n.useState)({}),2)[1],(0,n.useCallback)((function(){o({})}),[]));return(0,n.useEffect)((function(){var e={options:t,update:s};return i.push(e),function(){!function(t,e){var i=t.indexOf(e);if(-1===i)return;t.splice(i,1)}(i,e)}})),[e,a]},a,function(){return e}]}},710:function(t,e,i){"use strict";var n=i(323),r=i(343),a={getNormalizedBox:function(t,e,i,n){return a.isOn(e,i,n)&&a.isCSSZoom()?a.getBox(t,a.getRatio(i)):t&&t.getBoundingClientRect()},getBox:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=t?t.getBoundingClientRect():{};return{top:i.top*e,left:i.left*e,width:i.width*e,height:i.height*e,bottom:i.bottom*e,right:i.right*e}},getRatio:function(t){return window.innerWidth/t},getLimitedRatio:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=window.innerWidth/t,a=e/t,o=n?i/t:1;return Math.max(Math.min(r,a),o)},isScaleLayout:function(t){return t&&t.scalableviewer},isOn:function(t,e,i){return a.isDesktopDefault(t)&&a.isScaleLayout(i)},isOnForRatio:function(t,e,i){return a.isDesktopDefault(t)&&a.isScaleLayout(i)},isCSSZoom:function(){return!Modernizr.firefox},isCSSTransform:function(){return Modernizr.firefox},isDesktopDefault:function(t){return n.Z.isDesktop&&t===r.sJ.Default},getMinDesktopRatio:function(t){var e=r.ZP.dictionary[r.sJ.Default].min_scale_width;return t&&e?e/t:1},equals1:function(t){return Math.abs(t-1)<1e-6},normalize:function(t,e,i,n,o){if(a.equals1(t))return 1;if(a.isDesktopDefault(i)){var s=!e||"zoom"===e&&a.isCSSZoom()||"transform"===e&&a.isCSSTransform();if(a.isScaleLayout(o)&&s){var c=r.ZP.dictionary[r.sJ.Default].min_scale_width,l=c&&n?c/n:1;return Math.max(n?l:1,t)}return 1}return t}};e.Z=a},1068:function(t,e,i){"use strict";i.r(e),i.d(e,{Widgets:function(){return d},preloadWidgets:function(){return p}});var n=i(322),r=i(1018),a=i(1023),o=i(1031),s=i(1043),c=i(1046);function l(t,e,i,n,r,a,o){try{var s=t[a](o),c=s.value}catch(t){return void i(t)}s.done?e(c):Promise.resolve(c).then(n,r)}var d={background:r.default,button:a.default,picture:o.default,shape:s.default,text:c.default},u={addtocart:"add-to-cart",ecommercecart:"e-commerce-cart",rmheader:"rm-header",rmfooter:"rm-footer"},h=["addtocart","audio","background","button","ecommercecart","facebook","form","picture","gmaps","hotspot","iframe","shape","slideshow","text","twitter","video","rmheader","rmfooter","shots"],p=function(){var t,e=(t=regeneratorRuntime.mark((function t(e){var r,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.default.intersection(h,n.default.difference(n.default.uniq(e),Object.keys(d))),t.next=3,Promise.all(r.map((function(t){return i(1069)("./"+(u[t]?u[t]:t))})));case 3:a=t.sent,n.default.each(r,(function(t,e){d[t]=a[e].default}));case 5:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(n,r){var a=t.apply(e,i);function o(t){l(a,n,r,o,s,"next",t)}function s(t){l(a,n,r,o,s,"throw",t)}o(void 0)}))});return function(t){return e.apply(this,arguments)}}()},1038:function(t,e,i){"use strict";i.r(e);var n=i(352),r=i.n(n),a=i(336),o=i.n(a),s=i(1012),c=i(674),l=i(673),d=i(710),u=i(351),h=i(708),p=i(445),f=i(707),g=s.Z.extend({antialiasRotation:!0,initialize:function(t){this.model=new(o().Model)(t),s.Z.prototype.initialize.apply(this,arguments)},render:function(){var t=this;this.makeBox("widget-text-v3"),this.propsModel=new(o().Model)({page:this.page,currentPage:this.mag.currentPage||this.page,scale:this.page.scale,viewport:this.page.pageViewport,viewerOptions:this.mag.opts});var e=p.EditorState.createWithContent(u.Z.importTextContent(this.model),h.t);this.model["editorState"+this.page.pageViewport]=e;return(0,c.renderReact)({component:function(){return r().createElement(c.CreateContextProvider,{context:l.T,model:t.propsModel},r().createElement(f.Z,{editorState:e}))},domElement:this.$el[0],model:this.model}),this.rendered=!0,window.RM.screenshot&&!this.insideHotspot?this.waitForUsedFontsLoad():this.widgetIsLoaded(),this.seamlessFontsShow((function(){t.$el.removeClass("fonts-pending")}),(function(){t.$el.addClass("fonts-pending")})),d.Z.isDesktopDefault(this.mag.viewport)&&d.Z.isScaleLayout(this.mag.viewOpts)&&d.Z.isCSSZoom()&&this.page.on("resize",this.onScaleChange),this},hasFontsToLoad:function(){return!0},updatePage:function(t){var e=this.page;(!e||t&&e.num!==t.num)&&(this.page=t,this.propsModel.set({currentPage:t}))},onScaleChange:function(){this.propsModel.set({scale:this.page.scale})},waitForUsedFontsLoad:function(){this.hasFontsToLoad()?this.page.addFontsToLoad(this,this.widgetIsLoaded):this.widgetIsLoaded()},destroy:function(){this.mag.off("pageChanged",this.onPageChanged),this.page.off("resize",this.onScaleChange);for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return s.Z.prototype.destroy.apply(this,e)}});e.default=g},1046:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return a}});var n=i(1038),r=i(1037);function a(t,e,i){switch(t.version){case 3:return new n.default(t,e,i);default:return new r.default(t,e,i)}}},349:function(t,e,i){"use strict";i.d(e,{f:function(){return r}});var n=i(322),r=function(t){return n.default.template(t.raw.join(""))}},1085:function(t,e,i){"use strict";var n,r,a,o,s,c,l=i(349);e.Z=(r={},a="template-viewer-branding",o=(0,l.f)(n||(s=['\n\t<div class="rm-branding offscreen-initially">\n\t<a class="rm-branding-button" href="<%="https://readymag.com" + \'?\' + utm_params%>" target="_blank"></a>\n\t</div>\n'],c||(c=s.slice(0)),n=Object.freeze(Object.defineProperties(s,{raw:{value:Object.freeze(c)}})))),a in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r)},1072:function(t,e,i){"use strict";var n,r,a,o,s,c,l=i(349);e.Z=(r={},a="template-viewer-cart-sidebar",o=(0,l.f)(n||(s=['\n  <div id="cart-sidebar" class="cart-sidebar<% if (isViewer) { %> cart-in-viewer<% } %><% if (isMobile) { %> cart-is-mobile<% } %>">\n    <div class="close-button" data-alt="Close cart" data-alt-pos="bottom" data-alt-offset="9">\n      <div class="line-1"></div>\n      <div class="line-3"></div>\n    </div>\n\n    <div class="text-size-calc-container"></div>\n\n    <div class="cart-sidebar-wrapper">\n      <div class="cart-sidebar-tabs">\n\n        <div class="cart-sidebar-tab tab-items active">\n          <div class="sidebar-header">\n            <div class="sidebar-title">\n              <input\n                  type="text"\n                  class="cart-text-input cart-title-input"\n                  name="title"\n                  placeholder="Cart"\n                  maxlength="32"\n                  translate="no"\n                  autocomplete="off"\n                  autocorrect="off"\n                  spellcheck="false"\n                  <% if (isViewer) { %>readonly<% } %>\n                />\n            </div>\n            <div class="sidebar-settings-container"></div>\n          </div>\n\n          <div class="sidebar-body">\n            <div class="cart-items-list"></div>\n            <div class="sidebar-btn сheck-out-btn" data-tab="tab-inputs" aria-labelledby="cart-sidebar-checkout-button">\n              <input\n                type="text"\n                class="cart-text-input cart-checkout-input"\n                name="checkout"\n                placeholder="Check out"\n                maxlength="32"\n                translate="no"\n                autoComplete="off"\n                autocorrect="off"\n                spellcheck="false"\n                <% if (isViewer) { %>readonly<% } %>\n              />\n              <img class="btn-icon-right svg" src="<%= imgPublicPath %>img/viewer/cart-sidebar/sidebar-right-arrow.svg" />\n            </div>\n            <div class="empty-cart">\n              <div class="empty-cart-title">\n                <input\n                  type="text"\n                  class="cart-text-input empty-cart-title-input"\n                  name="emptyСartTitle"\n                  placeholder="Cart is empty"\n                  maxlength="32"\n                  translate="no"\n                  autoComplete="off"\n                  autocorrect="off"\n                  spellcheck="false"\n                  <% if (isViewer) { %>readonly<% } %>\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class="cart-sidebar-tab tab-inputs">\n          <div class="sidebar-header">\n            <div class="sidebar-btn go-back" data-tab="tab-items">\n                <img class="btn-icon-center svg" src="<%= imgPublicPath %>img/viewer/cart-sidebar/sidebar-left-arrow.svg" />\n            </div>\n            <div class="sidebar-btn go-forward" data-tab="tab-order">\n              Summary\n              <img class="btn-icon-right svg" src="<%= imgPublicPath %>img/viewer/cart-sidebar/sidebar-right-arrow.svg" />\n            </div>\n          </div>\n          <div class="sidebar-body">\n            <div class="order-details-form shipping-form">\n              <div class="form-title">Shipping address</div>\n              <div class="form-row">\n                <div class="form-error country-error hidden"></div>\n                <div class="countries-select"></div>\n              </div>\n              <div class="form-row">\n                <div class="form-error name-error hidden"></div>\n                <input type="text" class="form-input name-input" name="name" placeholder="Customer name" />\n              </div>\n              <div class="form-row">\n                <div class="form-error line1-error hidden"></div>\n                <input type="text" class="form-input line1-input" name="line1" placeholder="Address" />\n              </div>\n              <div class="form-row">\n                <input type="text" class="form-input line2-input" name="line2" placeholder="Apt, unit, building, floor…" />\n              </div>\n              <div class="form-row">\n                <div class="form-error city-error hidden"></div>\n                <input type="text" class="form-input city-input" name="city" placeholder="City" />\n              </div>\n              <div class="form-row">\n                <input type="text" class="form-input state-input" name="state" placeholder="State/Region" />\n              </div>\n              <div class="form-row">\n                <input type="text" class="form-input postal_code-input" name="postal_code" placeholder="Zip/Postal code" />\n              </div>\n              <div class="form-row">\n                <div class="form-error phone-error hidden"></div>\n                <input type="text" class="form-input phone-input" name="phone" placeholder="Phone" />\n              </div>\n            </div>\n            <div class="order-details-form">\n              <div class="form-title">Email</div>\n              <div class="form-row">\n                <div class="form-error email-error hidden"></div>\n                <input type="text" class="form-input email-input" name="email" placeholder="address@sample.com" />\n              </div>\n            </div>\n            <div class="order-details-form">\n              <div class="form-title">Note</div>\n              <div class="form-row">\n                <textarea class="form-input note-input" rows="4" name="note" placeholder="Add shipping details"></textarea>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class="cart-sidebar-tab tab-order">\n          <div class="sidebar-header">\n            <div class="sidebar-btn go-back" data-tab="tab-inputs">\n                <img class="btn-icon-center svg" src="<%= imgPublicPath %>img/viewer/cart-sidebar/sidebar-left-arrow.svg" />\n            </div>\n            <div class="sidebar-btn go-forward cart-pay-btn hidden" data-tab="tab-checkout">\n              Pay\n              <img class="btn-icon-right svg" src="<%= imgPublicPath %>img/viewer/cart-sidebar/sidebar-right-arrow.svg" />\n            </div>\n            <div class="preloader">\n              <div class="svg-wrap">\n              <svg width="14px" height="26px" viewBox="0 0 14 26" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                  <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n                      <g transform="translate(-1094.000000, -34.000000)" fill-rule="nonzero" stroke="#FFFFFF" stroke-width="2">\n                          <g transform="translate(1070.000000, 22.000000)">\n                              <path d="M25,37 C31.627417,37 37,31.627417 37,25 C37,18.372583 31.627417,13 25,13" id="Path"></path>\n                          </g>\n                      </g>\n                  </g>\n              </svg>\n              </div>\n            </div>\n          </div>\n\n          <div class="sidebar-body">\n            <div class="order-details">\n              <div class="order-items-block order-row">\n                <div class="order-title-row summary-title">Order summary</div>\n                <div class="order-items-list order-info-block"></div>\n              </div>\n              <div class="order-id-container order-row">\n                  <div class="order-title-row">Order ID</div>\n                  <div class="order-id order-info-block"></div>\n              </div>\n              <div class="shipping-details">\n                <div class="shipping-address order-row">\n                  <div class="order-title-row">Shipping address</div>\n                  <div class="order-shipping-address order-info-block"></div>\n                </div>\n                <div class="shipping-method order-row">\n                    <div class="order-title-row">Shipping method</div>\n                    <div class="order-shipping-method order-info-block"></div>\n                </div>\n              </div>\n              <div class="shipping-tax-size order-row">\n                <div class="order-title-row">Order tax</div>\n                <div class="order-tax order-info-block"></div>\n              </div>\n              <div class="shipping-email order-row hidden">\n                    <div class="order-title-row">Email</div>\n                    <div class="order-shipping-email order-info-block"></div>\n              </div>\n              <div class="shipping-phone order-row hidden">\n                    <div class="order-title-row">Phone</div>\n                    <div class="order-shipping-phone order-info-block"></div>\n              </div>\n              <div class="shipping-total-price order-row">\n                <div class="order-title-row">Grand total</div>\n                <div class="order-total-price order-info-block"></div>\n              </div>\n            </div>\n          </div>\n          <div class="order-error hidden">\n            <div class="order-error-container">\n              <div class="order-error-title">\n                Error\n              </div>\n              <div class="order-error-message">\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class="cart-sidebar-tab tab-checkout">\n          <div class="sidebar-header">\n            <div class="sidebar-btn go-back" data-tab="tab-order">\n                <img class="btn-icon-center svg" src="<%= imgPublicPath %>img/viewer/cart-sidebar/sidebar-left-arrow.svg" />\n            </div>\n            <div class="preloader">\n              <div class="svg-wrap">\n              <svg width="14px" height="26px" viewBox="0 0 14 26" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                  <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n                      <g transform="translate(-1094.000000, -34.000000)" fill-rule="nonzero" stroke="#FFFFFF" stroke-width="2">\n                          <g transform="translate(1070.000000, 22.000000)">\n                              <path d="M25,37 C31.627417,37 37,31.627417 37,25 C37,18.372583 31.627417,13 25,13" id="Path"></path>\n                          </g>\n                      </g>\n                  </g>\n              </svg>\n              </div>\n            </div>\n          </div>\n\n          <div class="sidebar-body">\n            <div class="payment-title">Pay with card</div>\n            <form action="/charge" method="post" id="payment-form">\n              <div class="form-row">\n                <div class="form-error card-number-error hidden"></div>\n                <div id="card-number-element" class="payment-input">\n                </div>\n              </div>\n              <div class="form-row">\n                <div class="form-error card-expiry-error hidden"></div>\n                <div id="card-expiry-element" class="payment-input">\n                </div>\n              </div>\n              <div class="form-row">\n                <div class="form-error card-name-error hidden"></div>\n                <input type="text" class="payment-input card-name-input hidden" name="name" placeholder="Name on card" />\n              </div>\n              <div class="form-row">\n                <div class="form-error card-cvc-error hidden"></div>\n                <div id="card-cvc-element" class="payment-input">\n                </div>\n              </div>\n\n              \x3c!-- Used to display Element errors. --\x3e\n              <div id="card-number-errors" role="alert"></div>\n              <div id="card-expiry-errors" role="alert"></div>\n              <div id="card-name-errors" role="alert"></div>\n              <div id="card-cvc-errors" role="alert"></div>\n\n              <div id="payment-failed-msg">\n                <div class="failed-msg-content">\n                  <div class="error-icon">\n                    <svg width="4px" height="27px" viewBox="0 0 4 27" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                          <g transform="translate(-1010.000000, -261.000000)" fill="#FFFFFF" fill-rule="nonzero">\n                              <g transform="translate(1010.000000, 261.000000)">\n                                  <g>\n                                      <path d="M2,0 C3.05322259,-1.93473851e-16 3.90702819,0.853805605 3.90702819,1.90702819 C3.90702819,1.93727706 3.90630849,1.96752165 3.9048697,1.99773628 L3.04535404,20.0475651 C3.01996411,20.5807536 2.58027854,21 2.0464859,21 L1.9535141,21 C1.41972146,21 0.980035886,20.5807536 0.954645959,20.0475651 L0.0951302988,1.99773628 C0.045033609,0.945705789 0.857261433,0.0522551831 1.90929192,0.00215849327 C1.93950655,0.000719701408 1.96975113,5.55662667e-18 2,0 Z"></path>\n                                      <circle cx="2" cy="25" r="2"></circle>\n                                  </g>\n                              </g>\n                          </g>\n                      </g>\n                    </svg>\n                  </div>\n                  <div class="error-message"></div>\n                </div>\n              </div>\n\n              <button class="sidebar-btn cart-payment-btn">Pay</button>\n            </form>\n            <div id="payment-request-button"></div>\n            <div class="cart-cancel-btn">Cancel order</div>\n          </div>\n          <div id="payment-success-msg">\n            <div class="success-msg-content">\n              <div class="title">Payment completed</div>\n              <div class="description">Check your email for details</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n'],c||(c=s.slice(0)),n=Object.freeze(Object.defineProperties(s,{raw:{value:Object.freeze(c)}})))),a in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r)},1083:function(t,e,i){"use strict";var n,r,a,o,s,c,l=i(349);e.Z=(r={},a="template-viewer-mag-menu",o=(0,l.f)(n||(s=['\n\t<noindex>\n\t\t<div class="mag-menu <%=(!hasProjectInfo ? \'no-project-info\' : \'\')%>" data-nosnippet>\n\t\t\t<div class="menu-wrapper">\n\n\t\t\t\t<% if (hasProjectInfo) { %>\n\t\t\t\t\t<div class="menu-info">\n\n\t\t\t\t\t\t<a class="link <%= !common.isDownloadedSource? \'\': \'inactive-link\'%>" href="<%-mag.model.user.getLink()%>">\n\t\t\t\t\t\t\t<div class="userpic" style="background-image:url(\'<%=mag.model.user.getUserpic(64)%>\')"></div>\n\t\t\t\t\t\t\t<div class="username"><%-mag.user.name%></div>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<div class="published-by" data_caption="published by" data_date="<%=publishDate%>"></div>\n\t\t\t\t\t\t<div class="mag-title"><%-mag.title%></div>\n\t\t\t\t\t</div>\n\t\t\t\t<% } %>\n\n\t\t\t\t<div class="scroll-wrapper">\n\n\t\t\t\t\t<div class="pages-wrapper has-<%=viewerType%>-scroll">\n\t\t\t\t\t\t<div class="pages">\n\n\t\t\t\t\t\t\t<%_.each(pages, function(page, ind) {\n\t\t\t\t\t\t\t\tvar attr = viewerType == \'horizontal\' ? \'left\' : \'top\',\n\t\t\t\t\t\t\t\t\t\tval = ind * (viewerType == \'horizontal\' ? width : height);\n\t\t\t\t\t\t\t%>\n\t\t\t\t\t\t\t\t<div class="page" data-id="<%=page._id%>" data-num="<%=page.num%>" data-src="<%=mag.model.getPageScreenshot(width, {_id: page._id})%>" style="width:<%=width%>px;height:<%=height%>px;<%=attr%>:<%=val%>px">\n\t\t\t\t\t\t\t\t\t<img class="screenshot" src="<%=stub%>" />\n\t\t\t\t\t\t\t\t\t<% if (page.unauthorized) { %>\n\t\t\t\t\t\t\t\t\t<div class="private-page"></div>\n\t\t\t\t\t\t\t\t\t<% } %>\n\t\t\t\t\t\t\t\t\t<div class="num <%=(page.pageNestedNum && page.pageNestedNum.length > 3 ? page.pageNestedNum.length > 4 ? \'nested-over-4\' : \'nested-over-3\' : page.num > 99 ? \'over99\' : \'\')%>"><%=page.pageNestedNum ? page.pageNestedNum : page.num%></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<%});%>\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="scroll"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</noindex>\n'],c||(c=s.slice(0)),n=Object.freeze(Object.defineProperties(s,{raw:{value:Object.freeze(c)}})))),a in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r)},1064:function(t,e,i){"use strict";var n,r,a,o,s,c,l=i(349);e.Z=(r={},a="template-viewer-mag",o=(0,l.f)(n||(s=['\n\n\t<div class="mag">\n\t\t<div class="mag-pages-container">\n\t\t\t<div class="container disable-transitions">\n\n\t\t\t\t<div class="blackout"></div>\n\t\t\t</div>\n\t\t\t<div class="above-pages-container"></div>\n\t\t</div>\n\n\t\t<% if (hasStandaloneBottomArrow) {%>\n\t\t\t<div class="navigation-arrow bottom offscreen"><div class="icon sprite" style="background-image: url(\'<%=icons.sprite%>\')"></div></div>\n\t\t<%}%>\n\n\n\t\t<% if (isPreview) {%>\n\t\t\t<div class="mag-pages-viewport-device"></div>\n\t\t<%}%>\n\t</div>\n\n'],c||(c=s.slice(0)),n=Object.freeze(Object.defineProperties(s,{raw:{value:Object.freeze(c)}})))),a in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r)},1077:function(t,e,i){"use strict";var n,r,a,o,s,c,l=i(349);e.Z=(r={},a="template-viewer-navigation",o=(0,l.f)(n||(s=['\n\n\t<div class="navigation">\n\t\t<div class="navigation-arrow left offscreen"><div class="icon sprite" style="background-image: url(\'<%=icons.sprite%>\')"></div></div>\n\t\t<div class="navigation-arrow right offscreen"><div class="icon sprite" style="background-image: url(\'<%=icons.sprite%>\')"></div></div>\n\t\t<div class="navigation-arrow bottom offscreen"><div class="icon sprite" style="background-image: url(\'<%=icons.sprite%>\')"></div></div>\n\t</div>\n\n'],c||(c=s.slice(0)),n=Object.freeze(Object.defineProperties(s,{raw:{value:Object.freeze(c)}})))),a in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r)},1066:function(t,e,i){"use strict";var n,r,a,o,s,c,l=i(349);e.Z=(r={},a="template-viewer-page",o=(0,l.f)(n||(s=['\n\t<div class="page hidden">\n\t\t<div id="page-<%=pageNum%>-password-container" class="polyfill-sticky"></div>\n\t\t<div class="page-fixed-bg-container polyfill-sticky"></div>\n\t\t<div class="fixed-position-container-top polyfill-sticky"></div>\n\t\t<div class="fixed-position-container polyfill-sticky"></div>\n\t\t<div class="content-scroll-wrapper <%=isStickyVerticalViewer ? \'\' : \'has-vertical-scroll\'%>">\n\t\t\t<div class="content-bounds">\n\t\t\t\t<div class="page-content-container" tabindex="-1"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n'],c||(c=s.slice(0)),n=Object.freeze(Object.defineProperties(s,{raw:{value:Object.freeze(c)}})))),a in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r)},1081:function(t,e,i){"use strict";var n,r,a,o,s,c,l=i(349);e.Z=(r={},a="template-viewer-share",o=(0,l.f)(n||(s=['\n\t<% if (hasOverlay) {%>\n\t\t<div class="share-popup-overlay hidden" data-nosnippet></div>\n\t<%}%>\n\n\t<div class="share-popup hidden" data-nosnippet>\n\t\t<noindex>\n\t\t\t<div class="content-wrapper">\n\n\t\t\t\t<div class="share-wrapper">\n\t\t\t\t\t<div class="caption">Share</div>\n\n\t\t\t\t\t<div class="type-selector">\n\t\t\t\t\t\t\x3c!--__magterm--\x3e\n\t\t\t\t\t\t<div class="type-full">Project</div>\n\t\t\t\t\t\t<div class="type-page">Current Page</div>\n\t\t\t\t\t\t<div class="arrow sprite" style="background-image: url(\'<%=icons.sprite%>\')"></div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="buttons-wrapper">\n\t\t\t\t\t\t<div class="share-facebook button" data-tp="facebook"><div class="icon sprite" style="background-image: url(\'<%=icons.sprite%>\')"></div>Share</div>\n\t\t\t\t\t\t<div class="share-twitter button" data-tp="twitter"><div class="icon sprite" style="background-image: url(\'<%=icons.sprite%>\')"></div>Tweet</div>\n\t\t\t\t\t\t<div class="share-pinterest button" data-tp="pinterest"><div class="icon sprite" style="background-image: url(\'<%=icons.sprite%>\')"></div>Pin</div>\n\t\t\t\t\t\t<div class="share-linkedin button" data-tp="linkedin"><div class="icon sprite" style="background-image: url(\'<%=icons.sprite%>\')"></div>Linkedin</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<% if (!common.isDownloadedSource) { %>\n\t\t\t\t\t\t<div class="open-embed"><div class="icon sprite" style="background-image: url(\'<%=icons.sprite%>\')"></div>Embed</div>\n\t\t\t\t\t\t<div class="close">Close</div>\n\t\t\t\t\t\t<div class="send-report" data-tp="report"><div class="icon sprite" style="background-image: url(\'<%=icons.sprite%>\')"></div>Report</div>\n\t\t\t\t\t<% } %>\n\t\t\t\t</div>\n\n\t\t\t\t<% if (!common.isDownloadedSource) { %>\n\t\t\t\t\t<div class="embed-wrapper">\n\t\t\t\t\t\t<div class="caption">Embed</div>\n\n\t\t\t\t\t\t<div class="size-selector" data-selected="responsive">\n\t\t\t\t\t\t\t<div class="size responsive" data-size="responsive">Responsive</div>\n\t\t\t\t\t\t\t<div class="size big" data-size="big">512×383</div>\n\t\t\t\t\t\t\t<div class="size small" data-size="small">288×236</div>\n\t\t\t\t\t\t\t<div class="arrow sprite" style="background-image: url(\'<%=icons.sprite%>\')"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="code-block">\n\t\t\t\t\t\t\t<div class="thumb">\n\t\t\t\t\t\t\t\t<img class="thumb-pic" src="" alt=""/>\n\t\t\t\t\t\t\t\t<div class="thumb-toolbar">\n\t\t\t\t\t\t\t\t\t<div class="icon arrows" style="background-image: url(\'<%=icons.thumbArrows%>\')"></div>\n\t\t\t\t\t\t\t\t\t<div class="icon open" style="background-image: url(\'<%=icons.thumbOpen%>\')"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<textarea class="embed-code"></textarea>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="back">Back</div>\n\t\t\t\t\t</div>\n\t\t\t\t<% } %>\n\t\t\t</div>\n\n\t\t\t<div class="corner-wrapper">\n\t\t\t\t<div class="corner"></div>\n\t\t\t</div>\n\t\t</noindex>\n\t</div>\n'],c||(c=s.slice(0)),n=Object.freeze(Object.defineProperties(s,{raw:{value:Object.freeze(c)}})))),a in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r)},1079:function(t,e,i){"use strict";var n,r,a,o,s,c,l=i(349);e.Z=(r={},a="template-viewer-toolbar",o=(0,l.f)(n||(s=['\n\n\t<div class="toolbar for-viewer">\n\n\t\t<%\tvar offscreenClass = (isPreview || common.embedMode) ? \'\' : \'offscreen-initially\'; %>\n\n\t\t<% if (hasPageCounter && !pageCounterInsideMenu) { %>\n\t\t\t<div class="page-counter-wrapper <%=offscreenClass%>">\n\t\t\t\t<div class="page-counter"><span class="cur"></span> of <span class="total"><%=totalPages%></span></div>\n\t\t\t</div>\n\t\t<% } %>\n\n\t\t<% if (brandingInToolbar) { %>\n\t\t\t<div class="toolbar-branding"></div>\n\t\t<% } %>\n\n\t\t<% if (hasShare) { %>\n\t\t\t<div class="share-button sprite <%=offscreenClass%>" data-alt="Share" data-alt-pos="<%= !controlsOnTop ? \'top\' : \'bottom\' %>" data-alt-offset="9"  data-alt-style="toolbar-share-tooltip" style="background-image: url(\'<%=icons.sprite%>\')"></div>\n\t\t<% } %>\n\n\t\t<% if (hasMenu) { %>\n\t\t\t<div class="menu-button <%=offscreenClass%>" data-alt="Menu (M)" data-alt-pos="<%= !controlsOnTop ? \'top\' : \'bottom\' %>" data-alt-offset="9" data-alt-style="toolbar-menu-tooltip">\n\t\t\t\t<% if (hasPageCounter && pageCounterInsideMenu) { %>\n\t\t\t\t\t<div class="page-counter"><span class="cur"></span> of <span class="total"><%=totalPages%></span></div>\n\t\t\t\t<% } %>\n\n\t\t\t\t<svg class="menu-icon" width="32" height="14" viewBox="0 0 32 14">\n\t\t\t\t\t<g fill="currentColor" fill-rule="evenodd"><path d="M1 0h30a1 1 0 010 2H1a1 1 0 110-2zM1 12h30a1 1 0 010 2H1a1 1 0 010-2z"/></g>\n\t\t\t\t</svg>\n\t\t\t\t<svg class="cross-icon" width="18" height="18" viewBox="0 0 18 18">\n\t\t\t\t\t<path d="M17.485.515a1 1 0 010 1.414L10.415 9l7.07 7.071a1 1 0 01-1.414 1.414L9 10.415l-7.071 7.07a1 1 0 01-1.414-1.414L7.585 9 .516 1.929A1 1 0 011.929.515L9 7.585l7.071-7.07a1 1 0 011.414 0z" fill="currentColor" fill-rule="evenodd"></path>\n\t\t\t\t</svg>\n\t\t\t\t<div class="page-preloader sprite" style="background-image: url(\'<%=icons.sprite%>\')"></div>\n\t\t\t</div>\n\t\t<% } %>\n\n\t\t<% if (common.embedMode) { %>\n\t\t\t<div class="embed-close-button <%=offscreenClass%>">Close</div>\n\t\t<% } %>\n\n\t</div>\n\n'],c||(c=s.slice(0)),n=Object.freeze(Object.defineProperties(s,{raw:{value:Object.freeze(c)}})))),a in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r)},1019:function(t,e,i){"use strict";var n,r,a,o,s,c,l=i(349);e.Z=(r={},a="template-viewer-widget-background",o=(0,l.f)(n||(s=['\n\t<div class="rmwidget widget-background" style="background-color: #<%=data.color%>">\n\n        <% if (data.selectedType == \'picture\') { %>\n            <div class="picture-background" style="opacity: <%=data.opacity || 1%>;"></div>\n        <% } %>\n\n        <% if (data.selectedType == \'video\') { %>\n            <div class="video-background" style="opacity: <%=data.videoopacity || 1%>;">\n                <div class="video-container"></div>\n                <div class="overlay"></div>\n            </div>\n\t\t<% } %>\n\n\t\t<% if (data.selectedType == \'slideshow\') { %>\n\t\t\t<div class="slideshow-background">\n\t\t\t\t<div class="slideshow-container"></div>\n\t\t\t\t<div class="slideshow-preload"></div>\n\t\t\t</div>\n\t\t<% } %>\n\t</div>\n'],c||(c=s.slice(0)),n=Object.freeze(Object.defineProperties(s,{raw:{value:Object.freeze(c)}})))),a in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r)},736:function(t,e,i){"use strict";var n=i(312),r=i(336),a=i.n(r),o=i(321),s=i(710),c=i(340),l=i(323);function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function h(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return p(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var f={LOOP_TYPES:{swing:"swing",repeat:"repeat"},EVENT_TYPES:["load","scroll","hover","click"],POINTER_EVENTS:["click","hover"],EXTERNAL_TRIGGER_BLOCK_EXCLUDE:["facebook","twitter","form","gmaps","slideshow","audio","video"],ANIMATION_BLOCK_EXCLUDE:["facebook","twitter"],POINTER_EVENTS_BLOCK_EXCLUDE:["form","gmaps","slideshow","audio","video"],DEFAULT_LOOP_TYPE:"swing",ACTIVE_TRIGGER_CLASS:"active-trigger",ACTIVE_TRIGGER_REMOVE_CLASS:"active-trigger-remove",ACTIVE_TRIGGER_HIGHLIGHT_CLASS:"active-trigger-highlight",ANIMATIONS_PLAYED_STORAGE_KEY:"animationsPlayed",DEG_TO_RAD:Math.PI/180,ANIMATION_PROPERTIES:function(){var t=!1,e="animation",i="AnimationIteration",n="AnimationEnd",r="animation-timing-function",a="@keyframes",o="transform",s="transform",c="Webkit Moz O ms Khtml".split(" "),l="webkit moz o MS кhtml".split(" "),d=document.createElement("div");if(null!=d.style.animationName)t=!0,i=i.toLowerCase(),n=n.toLowerCase();else for(var u=0;u<c.length;u++)if(null!=d.style[c[u]+"AnimationName"]){e=c[u]+"Animation",i=l[u]+i,n=l[u]+n,r="-"+c[u].toLowerCase()+"-"+r,a="@-"+c[u].toLowerCase()+"-keyframes",t=!0;break}if(null==d.style.transform)for(u=0;u<c.length;u++)if(null!=d.style[c[u]+"Transform"]){o=c[u]+"Transform",s="-"+c[u].toLowerCase()+"-transform";break}return d=null,{animationSupported:t,animationJS:e,animationIterationJS:i,animationEndJS:n,animationTimingFunctionCSS:r,keyframeCSS:a,transformJS:o,transformCSS:s}}(),createAnimationTimeline:function(t){return new y(t)},getNormalizedAnimation:function(t,e,i,n,r,a,c,l){var d={dx:0,dy:0,from_opacity:100,opacity:100,from_rotate:0,rotate:0,from_scale:100,scale:100},u={use_move:["dx","dy"],use_opacity:["from_opacity","opacity"],use_rotate:["from_rotate","rotate"],use_scale:["from_scale","scale"]},h=o.Z.extend({},t),p=h.loop;h.loop=!1,h.steps=[];for(var f={dx:0,dy:0},g=0;g<t.steps.length;g++){var m=o.Z.extend({},t.steps[g]);o.Z.each(u,o.Z.bind((function(t,e){m[e]?(d[t[0]]=m[t[0]],d[t[1]]=m[t[1]]):(m[t[0]]=d[t[0]],m[t[1]]=d[t[1]])}),this)),i&&(m.dx=0,m.rotate=0,m.from_rotate=0),n&&(m.dy=0,m.rotate=0,m.from_rotate=0),"scroll"!=h.type||e||0!=g||(m.delay_px=0),1!=r&&e&&(m.dx*=r,m.dy*=r),"scroll"==h.type?(m.calcedDuration=v(m,f),m.calcedDelay=m.delay_px?m.delay_px*s.Z.normalize(r,void 0,a,c,l):0):(m.calcedDuration=m.duration||.001,m.calcedDelay=m.delay||0),m.acceleration=m.acceleration||"none","scroll"===h.type?m.loop=!1:p&&0===g&&(m.loop=p),h.steps.push(m),f=m}return h.trigger=t.trigger&&!o.Z.isArray(t.trigger)?[t.trigger]:o.Z.clone(t.trigger)||[],h;function v(t,e){var i,n=t.dx-e.dx,r=t.dy-e.dy;return i=0!=n||0!=r?Math.pow(n*n+r*r,.5)/t.speed:300/t.speed,Math.ceil(i)}},normalizeLoopValue:function(t){return!!t&&(this.LOOP_TYPES[t]||this.DEFAULT_LOOP_TYPE)},isExternalTriggerAllowed:function(t){return this.isPointerEvent(t)},normalizeAnimationTriggers:function(t){return t&&!o.Z.isArray(t)?[t]:o.Z.clone(t)||[]},normalizeAnimations:function(t){return t&&!o.Z.isArray(t)?[t]:t||[]},isEmpty:function(t){return!(t&&t.type&&"none"!==t.type&&t.steps&&t.steps.length)},isMoveOnly:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.steps&&t.steps.length&&t.steps.every((function(t){return t.use_move&&!t.use_scale&&!t.use_rotate}))},isNonMove:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.steps&&t.steps.length&&t.steps.every((function(t){return!t.use_move}))},getUuidHash:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(t){return t.UUID})).filter((function(t){return t})).sort().join(",")},isPointerEvent:function(t){return-1!==this.POINTER_EVENTS.indexOf(t)},canHaveAnimation:function(t){var e=t.attributes||t.model&&t.model.attributes||{};return e.type&&-1===this.ANIMATION_BLOCK_EXCLUDE.indexOf(e.type)},arePointerEventsAllowed:function(t){var e=t.attributes||t.model&&t.model.attributes||{};return e.type&&-1===this.POINTER_EVENTS_BLOCK_EXCLUDE.indexOf(e.type)},getBlocksContainingTriggers:function(t){var e=o.Z.map(t,(function(t){return t.id||t._id}));return o.Z.reduce(t,function(t,i){var n=this.normalizeAnimations(i.model?i.model.get("animation"):i.animation),r=[].concat(h(n.reduce((function(t,e){return e.trigger?[].concat(h(t),h(f.normalizeAnimationTriggers(e&&e.trigger))):t}),[])),h(i.triggers||i.model&&i.model.get("triggers")||[]));return r.length&&o.Z.intersection(e,r).length&&t.push(i.id?i.id:i._id),t}.bind(this),[])},restoreTriggers:function(t,e,i){var n=[];return o.Z.each(t,function(t){var r=this,a=e[t],s=o.Z.find(i,{id:a});if(s&&s.getAllTriggers().length){n.push(s),s.model.getAnimations().forEach((function(t){var i=r.normalizeAnimationTriggers(t&&t.trigger);t.trigger=i.reduce((function(t,i){return e[i]?[].concat(h(t),[e[i]]):t}),[])}));var c=s.model.get("triggers");c&&s.model.set("triggers",c.reduce((function(t,i){return e[i]?[].concat(h(t),[e[i]]):t}),[]))}}.bind(this)),n},isScaleUp:function(t){return Boolean(o.Z.find(t&&t.steps,(function(t,e){return t.use_scale&&(0===e&&t.from_scale>100||t.scale>100)})))},maxScaleAnimation:function(t){return t&&t.steps&&t.steps.length?t.steps.reduce((function(t,e){return Math.max(t,e.from_scale||0,e.scale||0)}),0):0},canBeAccelerated:function(t){return!l.Z.isDesktop||!this.isScaleUp(t)},getPermanentAnimationId:function(t,e){return t.fixed_position||t.is_full_width||t.is_full_height||t.sticked?t._id:e},getAnimationsPlayed:function(){if(o.Z.isUndefined(this._animationsPlayed))try{var t=Modernizr.localstorage?window.localStorage.getItem(this.ANIMATIONS_PLAYED_STORAGE_KEY):c.default.getCookie(this.ANIMATIONS_PLAYED_STORAGE_KEY),e=t&&JSON.parse(t);this._animationsPlayed=o.Z.isArray(e)?e:[]}catch(t){this._animationsPlayed=[]}return this._animationsPlayed},persistHasPlayed:function(t){if(!this.hasPlayed(t))try{var e=JSON.stringify([].concat(this.getAnimationsPlayed(),t));Modernizr.localstorage?window.localStorage.setItem(this.ANIMATIONS_PLAYED_STORAGE_KEY,e):c.default.createCookie(this.ANIMATIONS_PLAYED_STORAGE_KEY,e),delete this._animationsPlayed}catch(t){}},hasPlayed:function(t){return t&&-1!==this.getAnimationsPlayed().indexOf(t)},hasExpired:function(t){var e=this,i=this.normalizeAnimations(t.animation);return Boolean(i.length)&&i.every((function(i){var n=e.getPermanentAnimationId(t,i.UUID);return i.playOnce&&e.hasPlayed(n)}))}},g=0,m=f.ANIMATION_PROPERTIES,v=function(){function t(e){var i=e.id,n=e.steps,r=e.initialStep;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,"name",void 0),u(this,"duration",void 0),u(this,"iterationCount",void 0),u(this,"fillMode","none"),u(this,"css",void 0),u(this,"hasRotation",!1),u(this,"force3d",void 0),u(this,"loop",void 0),this.name="animation_".concat(i);var a=n.find((function(t){return t.loop}));this.loop=!!a&&f.normalizeLoopValue(a.loop),this.iterationCount=this.loop?"infinite":1,this.hasRotation=n.find((function(t,e){return Boolean(t.use_rotate&&(0===e&&0!==t.from_rotate||0!==t.rotate))})),this.duration=n.reduce((function(t,e){return t+e.calcedDelay+e.calcedDuration}),0),this.css=t.getKeyframes(i,n,this.duration,this.hasRotation,this.force3d,r)}var e,i,n;return e=t,n=[{key:"getKeyframes",value:function(t,e,i,n,r,a){for(var o=0,s=[[0]],c=e.length,l=0;l<c;l++){var d=e[l].calcedDelay/i,u=e[l].calcedDuration/i;d>=1e-4?s[s.length-1].push(o+d):d=0,o+=d+u,l==c-1&&(o=1),s.push([o])}var h="".concat(m.keyframeCSS," animation_").concat(t," {\n"),p={none:"linear","ease-in":"ease-in","ease-out":"ease-out","ease-both":"ease-in-out"};for(h+=this.getKeyframe(s[0],{dx:a?a.dx:0,dy:a?a.dy:0,opacity:a?a.opacity:e[0].from_opacity,rotate:a?a.rotate:e[0].from_rotate,scale:a?a.scale:e[0].from_scale},p[e[0].acceleration],n,r),l=0;l<c;l++)h+=this.getKeyframe(s[l+1],e[l],e[l+1]?p[e[l+1].acceleration]:void 0,n,r);return h+="}\n"}},{key:"getKeyframe",value:function(t,e,i,n,r){var a="\t";return a+=o.Z.map(t,(function(t){return 100*t+"%"})).join(", ")+" {",a+=m.transformCSS+": "+this.getTransformString({x:e.dx,y:e.dy,angle:e.rotate,scale:e.scale/100,hasRotation:n,isKeyframe:!0,force3d:r})+"; ",a+="opacity: "+(0===e.opacity?0:e.opacity/100)+"; ",i&&(a+=m.animationTimingFunctionCSS+": "+i),a+="}\n"}},{key:"getTransformString",value:function(t){var e,i=t.x,n=t.y,r=t.angle,a=t.scale,o=t.hasRotation,c=t.isKeyframe,l=t.force3d;if(a<.001&&(a=.001),o&&c)e=l?"translate3d(".concat(i,"px, ").concat(n,"px, 0) rotate(").concat(r,"deg) scale(").concat(a,")"):"translate(".concat(i,"px, ").concat(n,"px) rotate(").concat(r,"deg) scale(").concat(a,")");else{var d=a,u=0,h=",";if(r&&(r*=f.DEG_TO_RAD,d=Math.cos(r)*a,u=Math.sin(r)*a),d=Math.abs(d)<1e-6?0:d,u=Math.abs(u)<1e-6?0:u,Modernizr.edge){var p,g=null===(p=window.RM.viewerRouter)||void 0===p?void 0:p.mag;g&&(n*=s.Z.getRatio(g.getViewportWidth(g.viewport)))}var m=d+h+u,v=-u+h+d,y=i+h+n;e=l?"matrix3d(".concat(m,",0,0,").concat(v,",0,0,0,0,1,0,").concat(y,",0,1)"):"matrix(".concat(m).concat(h).concat(v).concat(h).concat(y,")")}return e}}],(i=[{key:"getDirection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t?this.loop===f.LOOP_TYPES.repeat?"reverse":"alternate-reverse":this.loop===f.LOOP_TYPES.repeat?"normal":"alternate"}}])&&d(e.prototype,i),n&&d(e,n),t}(),y=a().View.extend({initialize:function(t){o.Z.bindAll(this),o.Z.extend(this,t),m.animationSupported&&(this.active=!1,this.reversed=!1,this.$el.toggleClass("force3d",!!this.force3d),"scroll"!==this.type?(this.generateKeyframeAnimation(),this.duration=this.sequences.reduce((function(t,e){return t+e.duration}),0)):(this.duration=this.steps.reduce((function(t,e){return t+e.calcedDelay+e.calcedDuration}),0),this.generateFrameByFrameAnimation()))},generateKeyframeAnimation:function(){var t=this;g+=1,this.id=g,this.sequences=this.steps.reduce((function(e,i,n){var r=t.steps.slice(n+1),a=r.findIndex((function(t){return t.loop}));return 0===n||i.loop?[].concat(h(e),[new v({id:"".concat(t.id,"_").concat(e.length+1),steps:[i].concat(h(r.slice(0,-1!==a?a:r.length))),force3d:t.force3d,initialStep:e.length?t.steps[n-1]:void 0})]):e}),[]),this.loop=this.sequences.map((function(t){return t.loop})).find((function(t){return t})),this.isFullLoop=1===this.sequences.length&&Boolean(this.sequences[0].loop),this.keyframesStyle=document.createElement("style"),this.keyframesStyle.innerHTML=this.sequences.reduce((function(t,e){return t+e.css}),""),this.$el.append(this.keyframesStyle),this.$el.on(m.animationIterationJS,(function(e){e.stopPropagation();var i=t.sequences.find((function(t){return t.name===e.originalEvent.animationName}));i&&t.onAnimationIteration(e,i)})),this.$el.on(m.animationEndJS,(function(e){e.stopPropagation();var i=t.sequences.find((function(t){return t.name===e.originalEvent.animationName})),n=t.reversed?h(t.sequences).reverse():t.sequences;i&&i.name===n[n.length-1].name&&t.onAnimationEnd(e,i)})),this.applyStepState(this.screenshotMode&&"load"===this.type?this.steps.length-1:"initial",!0)},generateFrameByFrameAnimation:function(){var t=0,e={dx:0,dy:0,opacity:this.steps[0].from_opacity,rotate:this.steps[0].from_rotate,scale:this.steps[0].from_scale};this.frames=[],this.frames.push({ind:0,isDelay:!1,params:e});for(var i=0;i<this.steps.length;i++){var n=this.steps[i];n.calcedDelay&&(this.frames.push({ind:t+1,isDelay:!0,params:e}),t+=n.calcedDelay),e={dx:n.dx,dy:n.dy,opacity:n.opacity,rotate:n.rotate,scale:n.scale,acceleration:n.acceleration},this.frames.push({ind:t+1,isDelay:!1,params:e}),t+=n.calcedDuration}this.seek(0)},applyStepState:function(t,e){var i;if(this.$el.removeClass("invisible"),"initial"===t)this.$el[0].style[m.transformJS]=v.getTransformString({x:0,y:0,angle:this.steps[0].from_rotate,scale:this.steps[0].from_scale/100,hasRotation:this.hasRotation,isKeyframe:e,force3d:this.force3d}),i=this.steps[0].from_opacity,this.$el[0].style.opacity=0===i?0:i/100;else{var n=this.steps[t];this.$el[0].style[m.transformJS]=v.getTransformString({x:n.dx,y:n.dy,angle:n.rotate,scale:n.scale/100,hasRotation:this.hasRotation,isKeyframe:e,force3d:this.force3d}),i=n.opacity,this.$el[0].style.opacity=0===i?0:i/100}var r="hover"===this.type&&this.animationTrigger.length>0&&!this.selfTriggered,a="hover"!==this.type&&("initial"!==t||this.animationTrigger.length>0);0===i&&(r||a)&&this.$el.addClass("invisible")},play:function(){if(!this.screenshotMode&&m.animationSupported){var t=m.animationJS;this.stop(),this.$el.removeClass("invisible"),this.$el.outerHeight(),window.requestAnimationFrame(function(){var e=this;this.$el[0].style[t+"Name"]=this.sequences.map((function(t){return t.name})).join(", "),this.$el[0].style[t+"Duration"]=this.sequences.map((function(t){return t.duration+"s"})).join(", "),this.$el[0].style[t+"Delay"]=this.sequences.reduce((function(t,i,n){var r=e.sequences[n-1];return[].concat(h(t),[r?"".concat(r.duration,"s"):"0s"])}),[]).join(", "),this.$el[0].style[t+"IterationCount"]=this.sequences.map((function(t){return t.iterationCount})).join(", "),this.$el[0].style[t+"Direction"]=this.sequences.map((function(t){return t.getDirection()})).join(", "),this.$el[0].style[t+"FillMode"]=this.sequences.map((function(t){return t.fillMode})).join(", "),this.$el[0].style[t+"PlayState"]=""}.bind(this)),this.active=!0,this.reversed=!1}},reverse:function(){if(!this.screenshotMode&&m.animationSupported){var t=m.animationJS;this.stop(),this.$el.removeClass("invisible"),this.$el.outerHeight();var e=h(this.sequences).reverse().filter((function(t){return t.loop!==f.LOOP_TYPES.swing}));this.$el[0].style[t+"Name"]=e.map((function(t){return t.name})).join(", "),this.$el[0].style[t+"Duration"]=e.map((function(t){return t.duration+"s"})).join(", "),this.$el[0].style[t+"Delay"]=e.reduce((function(t,i,n){var r=e[n-1];return[].concat(h(t),[r?"".concat(r.duration,"s"):"0s"])}),[]).join(", "),this.$el[0].style[t+"IterationCount"]=e.map((function(){return 1})).join(", "),this.$el[0].style[t+"Direction"]=e.map((function(t){return t.getDirection(!0)})).join(", "),this.$el[0].style[t+"FillMode"]=e.map((function(t){return t.fillMode})).join(", "),this.$el[0].style[t+"PlayState"]="",this.active=!0,this.reversed=!0}},stop:function(){this.$el.removeClass("invisible"),this.$el[0].style[m.animationJS]="",this.active=!1,this.reversed=!1},onAnimationEnd:function(){this.reversed=!this.reversed,this.active=!1,this.$el[0].style[m.animationJS]="",this.applyStepState(this.reversed?this.steps.length-1:"initial",!0),this.trigger("full-cycle-end")},onAnimationIteration:function(t,e){this.loop===f.LOOP_TYPES.swing?Math.round(t.originalEvent.elapsedTime/e.duration)%2?this.reversed=!0:(this.reversed=!1,this.trigger("full-cycle-end")):this.trigger("full-cycle-end")},resume:function(){this.screenshotMode||m.animationSupported&&(l.Z.isDesktop?this.$el[0].style[m.animationJS+"PlayState"]="running":this.play(),this.active=!0)},pause:function(){m.animationSupported&&(l.Z.isDesktop?this.$el[0].style[m.animationJS+"PlayState"]="paused":this.stop(),this.active=!1)},seek:function(t){if(m.animationSupported){t=Math.max(Math.min(t,this.duration),0);var e,i,n,r,a=this.frames.length;for(e=0;e<a&&!(this.frames[e].ind>t);e++);e--,this.frames[e].isDelay?i=o(this.frames[e].params,this.frames[e].params,0,1):(n=e?this.frames[e].ind-1:0,r=e==a-1?this.duration:this.frames[e+1].ind-1,i=o(this.frames[e?e-1:0].params,this.frames[e].params,t-n,r-n+1)),this.$el[0].style[m.transformJS]=v.getTransformString({x:i.dx,y:i.dy,angle:i.rotate,scale:i.scale/100,hasRotation:this.hasRotation,isKeyframe:!1,force3d:this.force3d}),this.$el[0].style.opacity=0==i.opacity?0:i.opacity/100,this.$el.toggleClass("invisible",0==i.opacity)}function o(t,e,i,n){if(0==i)return t;if(i==n-1)return e;var r=i/(n-1);return{dx:t.dx==e.dx?t.dx:s(t.dx,e.dx,r,e.acceleration),dy:t.dy==e.dy?t.dy:s(t.dy,e.dy,r,e.acceleration),opacity:t.opacity==e.opacity?t.opacity:s(t.opacity,e.opacity,r,e.acceleration),rotate:t.rotate==e.rotate?t.rotate:s(t.rotate,e.rotate,r,e.acceleration),scale:t.scale==e.scale?t.scale:s(t.scale,e.scale,r,e.acceleration)}}function s(t,e,i,n){return t+(e-t)*(n&&"none"!=n?"ease-in"==n?i*i:"ease-out"==n?i*(2-i):i<.5?i*i*2:2*i*(2-i)-1:i)}},destroy:function(){this.$el.off(m.animationIterationJS,this.onAnimationIteration),this.$el.off(m.animationEndJS,this.onAnimationEnd),this.$el[0].style[m.animationJS]="",this.$el[0].style[m.transformJS]="",this.$el[0].style.opacity="",this.$el.removeClass("force3d"),this.keyframesStyle&&(0,n.Z)(this.keyframesStyle).remove(),this.reversed=!1,this.active=!1}});e.Z=f},1020:function(t,e,i){"use strict";var n=i(312),r=i(336),a=i.n(r),o=i(321),s=i(935),c=a().View.extend({pictures:[],domPictures:[],preloadPictures:[],currentSlide:null,nextSlide:null,selectedSlide:null,defaultDelay:4,defaultCrossfade:.5,isAnimationRunning:!1,cursor:0,rendered:!1,lastSlideshowAnimationStart:null,initialize:function(t){this.initSlideshowData(t.data),this.$container=t.container,this.$preloadContainer=t.preloadContainer},initSlideshowData:function(t){this.pictures=t&&t.pictures?o.Z.sortBy(t.pictures,"num"):[],this.delay=t&&"number"==typeof t.delay?t.delay:this.defaultDelay,this.crossfade=t&&"number"==typeof t.crossfade?t.crossfade:this.defaultCrossfade,this.name=t&&t.name?t.name:"slideshow"+(new Date).getTime(),this.domPictures=[],this.preloadPictures=[],this.currentSlide=null,this.nextSlide=null,this.selectedSlide=null,this.isAnimationRunning=!1,this.cursor=0},render:function(t){RM.screenshot?this.pictures.length?this.addPicture(this.pictures[0]):this.trigger("loaded"):this.loadPictures(),this.isAnimationRunning||t||this.startAnimationLoop(),this.rendered=!0},rerender:function(t){this.stopAnimationLoop(),this.initSlideshowData(t),this.removePictures(),this.render(!0)},runAnimation:function(){this.isAnimationRunning||(this.rendered?this.startAnimationLoop():this.render())},setDelay:function(t){t<this.crossfade?console.error("delay mast be longer than crossfade"):this.delay=t},setCrossfade:function(t){t>this.delay?console.error("delay mast be longer than crossfade"):(this.crossfade=t,this.updateCrossfade())},updateCrossfade:function(){this.domPictures.forEach(function(t){t.css({"transition-duration":this.crossfade+"s"})}.bind(this))},updatePicture:function(t){var e=o.Z.findIndex(this.pictures,(function(e){return e.uuid===t.uuid}));this.pictures[e]=t,this.domPictures[e].css({"background-image":'url("'.concat(this.getPoorUrl(t),'")')}),s.Z.useLqipUrl(t)&&this.domPictures[e].addClass("lqip"),this.loadFullSizePicture(t)},updatePicturePosition:function(t){this.destroy(),this.initSlideshowData({pictures:t,delay:this.delay,crossfade:this.crossfade}),this.render()},addPicture:function(t){var e=this.domPictures.length===this.cursor+1,i=0===this.domPictures.length?2:e?1:0,r=0===this.domPictures.length||e?"block":"none";this.pictures.push(t),this.domPictures.push((0,n.Z)("<div>").addClass("slideshow-image fade-in".concat(s.Z.useLqipUrl(t)?" lqip":"")).css({"z-index":i,display:r,"background-image":'url("'.concat(this.getPoorUrl(t),'")'),"transition-property":"opacity","transition-duration":this.crossfade+"s","transition-timing-function":"linear"}).appendTo(this.$container)),this.loadFullSizePicture(t)},selectSlide:function(t){if(t){var e=this.pictures.findIndex((function(e){return e.uuid===t}));if(-1!==e){if(this.currentSlide&&this.selectedSlide!==this.domPictures[e]&&(this.isAnimationRunning&&this.stopAnimationLoop(),this.currentSlide!==this.domPictures[e])){var i=this.cursor;this.nextSlide&&this.nextSlide.css({"z-index":0,display:"none"}),this.domPictures[e].css({"z-index":1,display:"block"}),this.currentSlide=this.domPictures[e],this.cursor=e,this.selectedSlide=this.domPictures[e],this.domPictures.length>1?this.domPictures[e+1]?this.nextSlide=this.domPictures[e+1]:this.nextSlide=this.domPictures[0]:this.nextSlide=null,this.domPictures[i].css({"transition-duration":"0.3s"}),this.domPictures[i].removeClass("fade-in").addClass("fade-out"),setTimeout(function(){this.domPictures[i].css({"z-index":0,"transition-duration":"0s",display:"none"}).removeClass("fade-out").addClass("fade-in").css({"transition-duration":this.crossfade+"s"}),this.currentSlide.css({"z-index":2}),this.nextSlide&&this.nextSlide.css({"z-index":1,display:"block"})}.bind(this),310)}}else console.warn("Did't find slide for uuid:",t)}},removePictures:function(){this.domPictures=[],this.preloadPictures=[],this.$container.empty(),this.$preloadContainer.empty()},removePicture:function(t){if(t){var e=this.pictures.findIndex((function(e){return e.uuid===t}));if(this.domPictures[e]===this.currentSlide&&1!==this.domPictures.length&&this.selectedSlide!==this.domPictures[e]){var i=1e3*this.crossfade+1e3*this.delay+50;i=this.lastSlideshowAnimationStart?Math.abs(i-((new Date).getTime()-this.lastSlideshowAnimationStart.getTime())):i,setTimeout(function(){this.cursor&&(this.cursor-=1);var e=this.pictures.findIndex((function(e){return e.uuid===t}));this.domPictures[e].remove(),this.domPictures.splice(e,1),this.pictures.splice(e,1)}.bind(this),i)}else{if(this.domPictures[e]===this.nextSlide&&1!==this.domPictures.length&&(this.domPictures[e+1]?(this.domPictures[e+1].css({"z-index":1,display:"block"}),this.nextSlide=this.domPictures[e+1]):(this.domPictures[0].css({"z-index":1,display:"block"}),this.nextSlide=this.domPictures[0])),this.selectedSlide===this.domPictures[e]&&this.nextSlide){var n=this.domPictures.findIndex(function(t){return t===this.nextSlide}.bind(this));this.currentSlide=this.domPictures[n],this.cursor=n,this.selectedSlide=null,this.currentSlide.css({"z-index":2}),this.domPictures.length>2?this.domPictures[this.cursor+1]?this.nextSlide=this.domPictures[this.cursor+1]:this.nextSlide=this.domPictures[0]:this.nextSlide=null,this.nextSlide&&this.nextSlide.css({"z-index":1,display:"block"}),setTimeout(function(){this.startAnimationLoop()}.bind(this),0)}this.domPictures[e].remove(),this.domPictures.splice(e,1),this.pictures.splice(e,1)}}},getThumbnailUrl:function(t){return t?s.Z.useLambdaUrl(t)?s.Z.getThumbnailUrl(t):t.thumbUrl:""},getPictureUrl:function(t){return s.Z.useLambdaUrl(t)||s.Z.useLambdaUrlOldProjects(t,"background")?s.Z.getLambdaUrl(t):t.url},getPoorUrl:function(t){return s.Z.useLqipUrl(t)?s.Z.getLqipUrl(t):t.poorUrl},loadPictures:function(){this.pictures.forEach(function(t,e){this.domPictures[e]=(0,n.Z)("<div>").addClass("slideshow-image fade-in".concat(s.Z.useLqipUrl(t)?" lqip":"")).css({"z-index":0===e?2:1===e?1:0,display:0===e||1===e?"block":"none","background-image":'url("'.concat(this.getPoorUrl(t),'")'),"transition-property":"opacity","transition-duration":this.crossfade+"s","transition-timing-function":"linear"}).appendTo(this.$container)}.bind(this)),this.loadFullSizePictures()},loadFullSizePictures:function(){function t(t,e,i){this.domPictures[e].css({"background-image":'url("'.concat(t,'")')}),this.domPictures[e].removeClass("lqip"),this.preloadPictures[e].remove(),0===e&&this.trigger("loaded")}function e(t,e){this.domPictures[t].removeClass("lqip"),0===t&&this.trigger("loaded"),RM.screenshot||this.preloadPictures[t].remove()}this.preloadPictures=[],this.pictures.forEach(function(i,r){var a=this.getPictureUrl(i);this.preloadPictures[r]=(0,n.Z)("<img>").addClass("preload-slideshow-image").appendTo(this.$preloadContainer).attr("src",a).on("load",t.bind(this,a,r)).on("error",e.bind(this,r))}.bind(this))},loadFullSizePicture:function(t){var e=(0,n.Z)("<img>").addClass("preload-slideshow-image").appendTo(this.$preloadContainer).attr("src",this.getPictureUrl(t)).on("load",function(i){var n=o.Z.findIndex(this.pictures,(function(e){return t.uuid===e.uuid}));this.domPictures[n].css({"background-image":'url("'.concat(this.getPictureUrl(t),'")')}),this.domPictures[n].removeClass("lqip"),e.remove(),this.trigger("loaded")}.bind(this)).on("error",function(i){var n=o.Z.findIndex(this.pictures,(function(e){return t.uuid===e.uuid}));this.domPictures[n].removeClass("lqip"),e.remove(),this.trigger("loaded"),RM.screenshot||e.remove()}.bind(this))},initCursor:function(){this.cursor=0,this.currentSlide=this.domPictures[this.cursor],this.domPictures[this.cursor+1]&&(this.nextSlide=this.domPictures[this.cursor+1])},startAnimationLoop:function(){this.isAnimationRunning=!0,this.selectedSlide=null,this.currentSlide||this.initCursor(),this.slideshowLouncher=setTimeout(function t(){this.fadeAnimation(),this.slideshowLouncher=setTimeout(t.bind(this),1e3*this.delay)}.bind(this),1e3*this.delay)},fadeAnimation:function(){var t;this.lastSlideshowAnimationStart=new Date,this.domPictures.length<2||(this.currentSlide&&this.nextSlide||this.initCursor(),this.cursor+1<this.domPictures.length?(this.currentSlide.removeClass("fade-in").addClass("fade-out"),t=this.cursor,setTimeout(function(){this.domPictures[t]&&this.domPictures[t].css({"z-index":0,"transition-duration":"0s",display:"none"}).removeClass("fade-out").addClass("fade-in").css({"transition-duration":this.crossfade+"s"}),this.domPictures[t+1].css({"z-index":2}),this.domPictures[t+2]?this.domPictures[t+2].css({"z-index":1,display:"block"}):this.domPictures[0].css({"z-index":1,display:"block"})}.bind(this),1e3*this.crossfade),this.cursor+=1,this.currentSlide=this.domPictures[this.cursor],this.domPictures[this.cursor+1]?this.nextSlide=this.domPictures[this.cursor+1]:this.nextSlide=this.domPictures[0]):(this.currentSlide.removeClass("fade-in").addClass("fade-out"),t=this.cursor,setTimeout(function(){this.domPictures[t]&&this.domPictures[t].css({"z-index":0,"transition-duration":"0s",display:"none"}).removeClass("fade-out").addClass("fade-in").css({"transition-duration":this.crossfade+"s"}),this.domPictures[0].css({"z-index":2}),this.domPictures[1].css({"z-index":1,display:"block"})}.bind(this),1e3*this.crossfade),this.cursor=0,this.currentSlide=this.domPictures[this.cursor],this.nextSlide=this.domPictures[this.cursor+1]))},stopAnimationLoop:function(t){this.isAnimationRunning=!1,clearTimeout(this.slideshowLouncher),t&&"function"==typeof t&&t()},destroy:function(){this.rendered=!1,this.stopAnimationLoop(this.removePictures.bind(this))}});e.Z=c},1024:function(t,e,i){"use strict";i.d(e,{Z:function(){return x}});var n,r=i(312),a=i(336),o=i.n(a),s=i(321),c=i(349);var l,d,u,h,p,f,g=(l={},d="template-common-button-widget",u=(0,c.f)(n||(h=['\n\n    <div class="common-button" data-id="<%-data._id%>">\n\n        <div class="icon"></div>\n\n    </div>\n\n'],p||(p=h.slice(0)),n=Object.freeze(Object.defineProperties(h,{raw:{value:Object.freeze(p)}})))),d in l?Object.defineProperty(l,d,{value:u,enumerable:!0,configurable:!0,writable:!0}):l[d]=u,l);var m,v=function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}({},"template-constructor-block-button",(0,c.f)(f||(f=function(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(['\n\n    <input class="text"\n           value="<%-data.text%>"\n           type="text"\n           autocapitalize="off"\n           autocorrect="off"\n           autocomplete="off"\n           spellcheck="false"/>\n\n']))));var y=function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}({},"template-viewer-widget-button",(0,c.f)(m||(m=function(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(['\n    <div class="text"><%-data.text%></div>\n'])))),b=i(340),w={STYLE_PREFIXES:{viewer:[".rmwidget.widget-button .common-button"],viewerCurrentLink:[".maglink.current .widget-button .common-button"],constructor:[".block.button .common-button"]},generateIndividualStyleCSS:function(t){var e=this.STYLE_PREFIXES[t.env],i=t.model,n=i.tp,a=this,o=function(r){r=r||"default";var o={default:"",hover:"hovered",current:"current"},c={default:"",hover:"hover-",current:"current-"},l=s.Z.isUndefined(o[r])?o.default:o[r],d=s.Z.isUndefined(c[r])?c.default:c[r],u=s.Z.map(e,(function(t){return t+'[data-id="'+i._id+'"]'+(l?"."+l:"")})).join(",\n")+" {\n";return u+=a.generateStylesStr({model:i,attrPrefix:d,indentation:!0,lineBreaks:!0,env:t.env,state:r}),u+="}\n\n","viewer"===t.env&&("current"===r&&a.isNeedCurrentStyle(i)&&(u+=a.STYLE_PREFIXES.viewerCurrentLink+'[data-id="'+i._id+'"] {\n',u+=a.generateStylesStr({model:i,attrPrefix:d,indentation:!0,lineBreaks:!0}),u+="}\n\n"),"icon"!==n&&"text_and_icon"!==n||(u+=s.Z.map(e,(function(t){return t+'[data-id="'+i._id+'"]'+(l?"."+l:"")+" .icon"})).join(",\n")+" {\n",u+='\t background-image: url("'+(Modernizr.retina?i[d+"icon_raster2xUrl"]:i[d+"icon_rasterUrl"])+'");\n',u+="}\n\n","current"===r&&(u+=a.STYLE_PREFIXES.viewerCurrentLink+'[data-id="'+i._id+'"] .icon {\n',u+='\t background-image: url("'+(Modernizr.retina?i[d+"icon_raster2xUrl"]:i[d+"icon_rasterUrl"])+'");\n',u+="}\n\n"))),u},c=o("default");s.Z.find(s.Z.keys(i),(function(t){return/^current/.test(t)}))&&(c+=o("current")),c+=o("hover");var l="individual_button_style_"+i._id+"_"+t.env;(0,r.Z)("#"+l).remove();var d=document.createElement("style");d.type="text/css",d.id=l,d.className="button_styles",d.appendChild(document.createTextNode(c)),document.getElementsByTagName("head")[0].appendChild(d)},generateStylesStr:function(t){var e="",i=t.model,n=t.indentation?"\t":"",r=";"+(t.lineBreaks?"\n":""),a=t.attrPrefix||"";return e+=n+"background-color: "+b.default.getRGBA(o("background-color"),o("background-color-opacity")/100)+r,e+=n+"border-radius: "+s(o("border-radius"))+r,e+=n+"border-width: "+s(o("border-width"))+r,e+=n+"border-color: "+b.default.getRGBA(o("border-color"),o("border-color-opacity")/100)+r,e+=n+"font-family: "+o("font-family")+r,e+=n+"font-weight: "+o("font-weight")+r,e+=n+"font-style: "+o("font-style")+r,e+=n+"color: "+b.default.getRGBA(o("color"),o("color-opacity")/100)+r,e+=n+"font-size: "+s(o("font-size"))+r,e+=n+"letter-spacing: "+s(o("letter-spacing"))+r,i["hover-tansition-duration"]&&(e+=n+"transition: ".concat(i["hover-tansition-duration"],"s")+r),t.env&&t.state&&"viewer"===t.env&&"hover"===t.state&&i["hover-cursor"]&&(e+=n+"cursor: ".concat(i["hover-cursor"])+r),e;function o(t){var e=i[a+t];return("inherit"===e&&a||void 0===e)&&(e=i[t]),"border-color"===t&&"hover-"===a?0==i["hover-border-width"]&&(e=i["border-color"]):"border-color"===t&&"current-"!==a&&0==i["border-width"]&&(e=i["hover-border-color"]),"border-color-opacity"===t&&"hover-"===a?0==i["hover-border-width"]&&(e=i["border-color-opacity"]):"border-color-opacity"===t&&0==i["border-width"]&&(e=i["hover-border-color-opacity"]),e}function s(t){return t+(/px/i.test(t)?"":"px")}},destroyIndividualStyleCSS:function(t){var e="individual_button_style_"+t.model._id+"_"+t.env;(0,r.Z)("#"+e).remove()},isNeedCurrentStyle:function(t){var e=t.clickLink;return!(!e||!t.is_global)&&(!(/^http(s?)\:\/\//i.test(e)||/^mailto\:/i.test(e)||/^tel\:/i.test(e))&&!!t.mag.getPageUri(e))}};function S(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function P(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?S(Object(i),!0).forEach((function(e){k(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):S(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function k(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var C=P(P(P({},g),v),y),x=o().View.extend({MIN_ICON_MARGIN:8,initialize:function(t){t&&(s.Z.bindAll(this),this.block=t.block,this.model=t.block&&t.block.model,this.model=t.model,this.$container=t.$container,this.environment=t.environment,this.mag=t.mag,s.Z.extend(this.model,{env:this.environment}),this.generateIndividualStyleCSS({env:this.environment,model:this.model}),this.template=C["template-common-button-widget"],"constructor"===this.environment?this.text_template=C["template-constructor-block-button"]:this.text_template=C["template-viewer-widget-button"],this.render())},render:function(){this.model.tp;var t=w.generateStylesStr({model:this.model});this.setElement((0,r.Z)(this.template({data:this.model}))),(0,r.Z)(this.text_template({data:this.model})).appendTo(this.$el),this.$text=this.$(".text"),this.$icon=this.$(".icon"),this.$button=this.$text.closest(".common-button"),this.$button.attr("style",t),this.applyButtonType(this.model.tp),"circle"===this.model.form&&this.applyCircleRadius(this.model.w),this.applyTextContainerSize(this.model),this.applyIconContainerSize(this.model),this.applyIconPosition(this.model),"viewer"===this.environment&&this.$container.css("border-radius",this.$button.css("border-radius")),this.$el.appendTo(this.$container),this.renderFinishTimeout=setTimeout(function(){var t=["background-color","background-color-opacity","border-width","border-color","border-color-opacity","font-family","font-style","font-weight","color","color-opacity","font-size","letter-spacing"];"circle"!==this.model.form&&t.push("border-radius"),t.forEach(function(t){this.$button.css(t,"")}.bind(this)),this.applyTransition()}.bind(this),500)},renderButtonText:function(t){this.$el.find(".text").text(t)},renderButtonTextWithSizes:function(t,e){e&&this.applyTextContainerSize(e),this.$el.find(".text").text(t).css({display:t?"block":"none"})},applyTransition:function(){"viewer"!==this.environment||Modernizr.touch||this.model.transition&&this.$button.addClass("transition")},applyButtonType:function(t){var e="inline-block";"text"===t?(this.$text.css("display",e),this.$icon.css("display","none")):"icon"===t?(this.$icon.css("display",e),this.$text.css("display","none")):"text_and_icon"===t&&this.$icon.add(this.$text).css("display",e)},applyCircleRadius:function(t){this.$button.css("border-radius","100%")},applyTextContainerSize:function(t){var e=t["letter-spacing"],i=0,n=0;e>0?i=e:e<0&&(n=e),this.$text.css({width:t.text_w+"px","padding-left":i+"px","text-indent":n+"px",height:"viewer"===this.environment?"".concat(t.h,"px"):"".concat(t.text_h,"px"),"line-height":"viewer"===this.environment?"".concat(t.h,"px"):"".concat(t.text_h,"px")})},applyIconContainerSize:function(t){t.tp;var e=t.icon_w,i=t.icon_h;t.icon_pos;this.$icon.css({width:e+"px",height:i+"px","margin-right":"0px","margin-left":"0px"})},calcIconMarginFromText:function(t){return Math.ceil(t/4)},calcIconTopBottomMargin:function(t){return Math.ceil(t/3)},calcTextTopBottomMargin:function(t){return Math.ceil(t/6)},applyIconPosition:function(t){var e=t.icon_pos;"left"===e?this.$button.css({"flex-direction":"row","-webkit-flex-direction":"row"}):"right"===e&&this.$button.css({"flex-direction":"row-reverse","-webkit-flex-direction":"row-reverse"})},generateIndividualStyleCSS:function(t){w.generateIndividualStyleCSS({env:t.env,model:t.model})},destroy:function(){clearTimeout(this.renderFinishTimeout),w.destroyIndividualStyleCSS({env:this.environment,model:this.model}),this.$el&&this.$el.remove()}})},1073:function(t,e,i){"use strict";i.d(e,{h:function(){return n}});var n=[{value:"AF",caption:"Afghanistan"},{value:"AX",caption:"Aland Islands"},{value:"AL",caption:"Albania"},{value:"DZ",caption:"Algeria"},{value:"AS",caption:"American Samoa"},{value:"AD",caption:"Andorra"},{value:"AO",caption:"Angola"},{value:"AI",caption:"Anguilla"},{value:"AQ",caption:"Antarctica"},{value:"AG",caption:"Antigua and Barbuda"},{value:"AR",caption:"Argentina"},{value:"AM",caption:"Armenia"},{value:"AW",caption:"Aruba"},{value:"AU",caption:"Australia"},{value:"AT",caption:"Austria"},{value:"AZ",caption:"Azerbaijan"},{value:"BS",caption:"Bahamas"},{value:"BH",caption:"Bahrain"},{value:"BD",caption:"Bangladesh"},{value:"BB",caption:"Barbados"},{value:"BY",caption:"Belarus"},{value:"BE",caption:"Belgium"},{value:"BZ",caption:"Belize"},{value:"BJ",caption:"Benin"},{value:"BM",caption:"Bermuda"},{value:"BT",caption:"Bhutan"},{value:"BO",caption:"Bolivia, Plurinational State of"},{value:"BQ",caption:"Bonaire, Sint Eustatius and Saba"},{value:"BA",caption:"Bosnia and Herzegovina"},{value:"BW",caption:"Botswana"},{value:"BV",caption:"Bouvet Island"},{value:"BR",caption:"Brazil"},{value:"IO",caption:"British Indian Ocean Territory"},{value:"BN",caption:"Brunei Darussalam"},{value:"BG",caption:"Bulgaria"},{value:"BF",caption:"Burkina Faso"},{value:"BI",caption:"Burundi"},{value:"KH",caption:"Cambodia"},{value:"CM",caption:"Cameroon"},{value:"CA",caption:"Canada"},{value:"CV",caption:"Cape Verde"},{value:"KY",caption:"Cayman Islands"},{value:"CF",caption:"Central African Republic"},{value:"TD",caption:"Chad"},{value:"CL",caption:"Chile"},{value:"CN",caption:"China"},{value:"CX",caption:"Christmas Island"},{value:"CC",caption:"Cocos (Keeling) Islands"},{value:"CO",caption:"Colombia"},{value:"KM",caption:"Comoros"},{value:"CG",caption:"Congo"},{value:"CD",caption:"Congo, the Democratic Republic of the"},{value:"CK",caption:"Cook Islands"},{value:"CR",caption:"Costa Rica"},{value:"CI",caption:"Côte d'Ivoire"},{value:"HR",caption:"Croatia"},{value:"CU",caption:"Cuba"},{value:"CW",caption:"Curaçao"},{value:"CY",caption:"Cyprus"},{value:"CZ",caption:"Czech Republic"},{value:"DK",caption:"Denmark"},{value:"DJ",caption:"Djibouti"},{value:"DM",caption:"Dominica"},{value:"DO",caption:"Dominican Republic"},{value:"EC",caption:"Ecuador"},{value:"EG",caption:"Egypt"},{value:"SV",caption:"El Salvador"},{value:"GQ",caption:"Equatorial Guinea"},{value:"ER",caption:"Eritrea"},{value:"EE",caption:"Estonia"},{value:"ET",caption:"Ethiopia"},{value:"FK",caption:"Falkland Islands (Malvinas)"},{value:"FO",caption:"Faroe Islands"},{value:"FJ",caption:"Fiji"},{value:"FI",caption:"Finland"},{value:"FR",caption:"France"},{value:"GF",caption:"French Guiana"},{value:"PF",caption:"French Polynesia"},{value:"TF",caption:"French Southern Territories"},{value:"GA",caption:"Gabon"},{value:"GM",caption:"Gambia"},{value:"GE",caption:"Georgia"},{value:"DE",caption:"Germany"},{value:"GH",caption:"Ghana"},{value:"GI",caption:"Gibraltar"},{value:"GR",caption:"Greece"},{value:"GL",caption:"Greenland"},{value:"GD",caption:"Grenada"},{value:"GP",caption:"Guadeloupe"},{value:"GU",caption:"Guam"},{value:"GT",caption:"Guatemala"},{value:"GG",caption:"Guernsey"},{value:"GN",caption:"Guinea"},{value:"GW",caption:"Guinea-Bissau"},{value:"GY",caption:"Guyana"},{value:"HT",caption:"Haiti"},{value:"HM",caption:"Heard Island and McDonald Islands"},{value:"VA",caption:"Holy See (Vatican City State)"},{value:"HN",caption:"Honduras"},{value:"HK",caption:"Hong Kong"},{value:"HU",caption:"Hungary"},{value:"IS",caption:"Iceland"},{value:"IN",caption:"India"},{value:"ID",caption:"Indonesia"},{value:"IR",caption:"Iran, Islamic Republic of"},{value:"IQ",caption:"Iraq"},{value:"IE",caption:"Ireland"},{value:"IM",caption:"Isle of Man"},{value:"IL",caption:"Israel"},{value:"IT",caption:"Italy"},{value:"JM",caption:"Jamaica"},{value:"JP",caption:"Japan"},{value:"JE",caption:"Jersey"},{value:"JO",caption:"Jordan"},{value:"KZ",caption:"Kazakhstan"},{value:"KE",caption:"Kenya"},{value:"KI",caption:"Kiribati"},{value:"KP",caption:"Korea, Democratic People's Republic of"},{value:"KR",caption:"Korea, Republic of"},{value:"KW",caption:"Kuwait"},{value:"KG",caption:"Kyrgyzstan"},{value:"LA",caption:"Lao People's Democratic Republic"},{value:"LV",caption:"Latvia"},{value:"LB",caption:"Lebanon"},{value:"LS",caption:"Lesotho"},{value:"LR",caption:"Liberia"},{value:"LY",caption:"Libya"},{value:"LI",caption:"Liechtenstein"},{value:"LT",caption:"Lithuania"},{value:"LU",caption:"Luxembourg"},{value:"MO",caption:"Macao"},{value:"MK",caption:"Macedonia, the Former Yugoslav Republic of"},{value:"MG",caption:"Madagascar"},{value:"MW",caption:"Malawi"},{value:"MY",caption:"Malaysia"},{value:"MV",caption:"Maldives"},{value:"ML",caption:"Mali"},{value:"MT",caption:"Malta"},{value:"MH",caption:"Marshall Islands"},{value:"MQ",caption:"Martinique"},{value:"MR",caption:"Mauritania"},{value:"MU",caption:"Mauritius"},{value:"YT",caption:"Mayotte"},{value:"MX",caption:"Mexico"},{value:"FM",caption:"Micronesia, Federated States of"},{value:"MD",caption:"Moldova, Republic of"},{value:"MC",caption:"Monaco"},{value:"MN",caption:"Mongolia"},{value:"ME",caption:"Montenegro"},{value:"MS",caption:"Montserrat"},{value:"MA",caption:"Morocco"},{value:"MZ",caption:"Mozambique"},{value:"MM",caption:"Myanmar"},{value:"NA",caption:"Namibia"},{value:"NR",caption:"Nauru"},{value:"NP",caption:"Nepal"},{value:"NL",caption:"Netherlands"},{value:"NC",caption:"New Caledonia"},{value:"NZ",caption:"New Zealand"},{value:"NI",caption:"Nicaragua"},{value:"NE",caption:"Niger"},{value:"NG",caption:"Nigeria"},{value:"NU",caption:"Niue"},{value:"NF",caption:"Norfolk Island"},{value:"MP",caption:"Northern Mariana Islands"},{value:"NO",caption:"Norway"},{value:"OM",caption:"Oman"},{value:"PK",caption:"Pakistan"},{value:"PW",caption:"Palau"},{value:"PS",caption:"Palestine, State of"},{value:"PA",caption:"Panama"},{value:"PG",caption:"Papua New Guinea"},{value:"PY",caption:"Paraguay"},{value:"PE",caption:"Peru"},{value:"PH",caption:"Philippines"},{value:"PN",caption:"Pitcairn"},{value:"PL",caption:"Poland"},{value:"PT",caption:"Portugal"},{value:"PR",caption:"Puerto Rico"},{value:"QA",caption:"Qatar"},{value:"RE",caption:"Réunion"},{value:"RO",caption:"Romania"},{value:"RU",caption:"Russian Federation"},{value:"RW",caption:"Rwanda"},{value:"BL",caption:"Saint Barthélemy"},{value:"SH",caption:"Saint Helena, Ascension and Tristan da Cunha"},{value:"KN",caption:"Saint Kitts and Nevis"},{value:"LC",caption:"Saint Lucia"},{value:"MF",caption:"Saint Martin (French part)"},{value:"PM",caption:"Saint Pierre and Miquelon"},{value:"VC",caption:"Saint Vincent and the Grenadines"},{value:"WS",caption:"Samoa"},{value:"SM",caption:"San Marino"},{value:"ST",caption:"Sao Tome and Principe"},{value:"SA",caption:"Saudi Arabia"},{value:"SN",caption:"Senegal"},{value:"RS",caption:"Serbia"},{value:"SC",caption:"Seychelles"},{value:"SL",caption:"Sierra Leone"},{value:"SG",caption:"Singapore"},{value:"SX",caption:"Sint Maarten (Dutch part)"},{value:"SK",caption:"Slovakia"},{value:"SI",caption:"Slovenia"},{value:"SB",caption:"Solomon Islands"},{value:"SO",caption:"Somalia"},{value:"ZA",caption:"South Africa"},{value:"GS",caption:"South Georgia and the South Sandwich Islands"},{value:"SS",caption:"South Sudan"},{value:"ES",caption:"Spain"},{value:"LK",caption:"Sri Lanka"},{value:"SD",caption:"Sudan"},{value:"SR",caption:"Suriname"},{value:"SJ",caption:"Svalbard and Jan Mayen"},{value:"SZ",caption:"Swaziland"},{value:"SE",caption:"Sweden"},{value:"CH",caption:"Switzerland"},{value:"SY",caption:"Syrian Arab Republic"},{value:"TW",caption:"Taiwan, Province of China"},{value:"TJ",caption:"Tajikistan"},{value:"TZ",caption:"Tanzania, United Republic of"},{value:"TH",caption:"Thailand"},{value:"TL",caption:"Timor-Leste"},{value:"TG",caption:"Togo"},{value:"TK",caption:"Tokelau"},{value:"TO",caption:"Tonga"},{value:"TT",caption:"Trinidad and Tobago"},{value:"TN",caption:"Tunisia"},{value:"TR",caption:"Turkey"},{value:"TM",caption:"Turkmenistan"},{value:"TC",caption:"Turks and Caicos Islands"},{value:"TV",caption:"Tuvalu"},{value:"UG",caption:"Uganda"},{value:"UA",caption:"Ukraine"},{value:"AE",caption:"United Arab Emirates"},{value:"GB",caption:"United Kingdom"},{value:"US",caption:"United States"},{value:"UM",caption:"United States Minor Outlying Islands"},{value:"UY",caption:"Uruguay"},{value:"UZ",caption:"Uzbekistan"},{value:"VU",caption:"Vanuatu"},{value:"VE",caption:"Venezuela, Bolivarian Republic of"},{value:"VN",caption:"Viet Nam"},{value:"VG",caption:"Virgin Islands, British"},{value:"VI",caption:"Virgin Islands, U.S."},{value:"WF",caption:"Wallis and Futuna"},{value:"EH",caption:"Western Sahara"},{value:"YE",caption:"Yemen"},{value:"ZM",caption:"Zambia"},{value:"ZW",caption:"Zimbabwe"}]},886:function(t,e,i){"use strict";i.d(e,{ib:function(){return W},ZP:function(){return V},Kq:function(){return z}});var n=i(336),r=i.n(n),a=i(321),o=i(312),s=i(887),c=i.n(s),l=i(891),d=i.n(l),u=i(342),h=i(308);function p(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function f(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?p(Object(i),!0).forEach((function(e){g(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function g(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function m(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var v=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,n;return e=t,(i=[{key:"checkProductActive",value:function(t){return t.active&&(this.productHasActiveSku(t)||this.productHasActivePrice(t))}},{key:"productHasActiveSku",value:function(t){return Array.isArray(null==t?void 0:t.articles)&&t.articles.some((function(t){return t.active}))}},{key:"productHasActivePrice",value:function(t){return t&&t.prices&&t.prices.length&&t.prices.some((function(t){return t.active}))}},{key:"mapProductsSelectList",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,i=t.filter((function(t){return t.active&&(t.articles&&t.articles.length||t.prices&&t.prices.length)||e&&e===t.id})).map((function(t){return{value:t.id,caption:t.name}}));return i.unshift({value:"default",caption:"None"}),i}},{key:"getProductForAddToCart",value:function(t,e){if(!t)return null;var i=this.getActivePrice(t);if(i)return i.productObject=f(f({},t),{},{articles:null,prices:null}),i;var n=this.getSkuBySelectsValues(t,e);return n?(n.productObject=f(f({},t),{},{articles:null,prices:null}),n):null}},{key:"getActivePrice",value:function(t){return Array.isArray(t.prices)?t.prices.find((function(t){return t.active&&"per_unit"===t.billing_scheme})):null}},{key:"getSkuBySelectsValues",value:function(t,e){return t&&Array.isArray(t.articles)&&0!==t.articles.length?1===t.articles.length?t.articles[0]:t.articles.find((function(t){return JSON.stringify(t.attributes)===JSON.stringify(e)})):null}}])&&m(e.prototype,i),n&&m(e,n),t}();function y(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function b(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?y(Object(i),!0).forEach((function(e){w(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):y(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function w(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function S(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var P=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,n;return e=t,(i=[{key:"checkProductActive",value:function(t){return Boolean(null==t?void 0:t.active)}},{key:"productHasActiveSku",value:function(t){var e=this;return(null==t?void 0:t.options)&&t.options.some((function(t){return e.isOptionValid(t)}))}},{key:"isOptionValid",value:function(t){return["SELECT","SIZE","RADIO"].includes(null==t?void 0:t.type)}},{key:"mapProductsSelectList",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,i=t.map((function(t){return{value:t.id,caption:t.name}}));return i.unshift({value:"default",caption:"None"}),e&&!i.find((function(t){return t.value===e}))&&i.push({value:e,caption:"inactive product"}),i}},{key:"getProductForAddToCart",value:function(t,e){var i=b({},t);if(i&&e&&(i.selectedOptions=b({},e),Array.isArray(i.combinations))){var n=i.combinations.find((function(t){return t.options.every((function(t){return e[t.name]===t.value}))}));n&&(i.selectedCombination=b({},n))}return i}},{key:"getProductQuantity",value:function(t){var e=(null==t?void 0:t.selectedCombination)||t;return null==e?void 0:e.quantity}},{key:"isProductAvailable",value:function(t){if(null!=t&&t.inStock){var e=this.getProductQuantity(t);if(void 0===e||e)return!0}return!1}},{key:"countCartItemsById",value:function(t,e){var i=0;return Object.keys(e.prices).forEach((function(n){var r,a=e.prices[n];!a||a.id!==t&&(null===(r=a.selectedCombination)||void 0===r?void 0:r.id)!==t||(i+=a.cart_count||0)})),i}},{key:"isOutOfStock",value:function(t,e){if(!t)return!0;var i=this.getProductQuantity(t);if(void 0===i)return!1;var n=this.countCartItemsById(t.selectedCombination?t.selectedCombination.id:t.id,e);return!!(i&&n+1>i)}},{key:"updateCartProductItems",value:function(t,e){var i=b({},e);return i.prices={},Object.keys(e.prices).forEach((function(n){var r=e.prices[n],a=t.find((function(t){return t.id===r.id}));if(a){if(i.prices[n]=b(b({},r),a),r.selectedCombination&&a.combinations){var o=a.combinations.find((function(t){var e;return t.id===(null===(e=r.selectedCombination)||void 0===e?void 0:e.id)}));o&&(i.prices[n].selectedCombination=o)}}else r&&(i.prices[n]=b({},r))})),i}}])&&S(e.prototype,i),n&&S(e,n),t}(),k=i(636);function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function x(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function O(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function T(t,e,i,n,r,a,o){try{var s=t[a](o),c=s.value}catch(t){return void i(t)}s.done?e(c):Promise.resolve(c).then(n,r)}function _(t){return function(){var e=this,i=arguments;return new Promise((function(n,r){var a=t.apply(e,i);function o(t){T(a,n,r,o,s,"next",t)}function s(t){T(a,n,r,o,s,"throw",t)}o(void 0)}))}}function Z(t){return function(t){if(Array.isArray(t))return M(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return M(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return M(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function I(t,e){return!e||"object"!==C(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $(t){var e="function"==typeof Map?new Map:void 0;return($=function(t){if(null===t||(i=t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return E(t,arguments,j(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),L(n,t)})(t)}function E(t,e,i){return(E=D()?Reflect.construct:function(t,e,i){var n=[null];n.push.apply(n,e);var r=new(Function.bind.apply(t,n));return i&&L(r,i.prototype),r}).apply(null,arguments)}function D(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function L(t,e){return(L=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var A,R,F=function(){return{skus:{},prices:{},uniqSkusCount:0,uniqPricesCount:0,shippableProducts:0,changed:(new Date).toISOString(),order:null,provider:null}},B={out_of_stock:"Out of stock"},z={outOfStock:"outOfStock",nothingToInvoice:"nothingToInvoice"},W=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(r,t);var e,i,n=(e=r,i=D(),function(){var t,n=j(e);if(i){var r=j(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return I(this,t)});function r(t,e){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(i=n.call(this,t)).type=e,i}return r}($(Error)),N=function(t,e,i,n){RM.screenshot&&(this.page=n),this.isMagLoaded=!1,this.haveEcommerceCartWidget=!1,this.isCartSidebarHidden=!0,this.productsLoading=!1,this.productsLoaded=!1,this.productsLoadingError=!1,this.cancelingOrder=!1,this.products=null,this.storageKey="_rmcartdata",this.connectedProvider,this.environment=i,this.mag=e,this.router=t,this.events=a.Z.extend({},r().Events),this.cartData=F(),this.cartItemsLimit=25;var o=window.navigator.language;return this.userLocale=o?o.substring(0,2):"en",this.isConstructor()?this.mag.has("_id")?this.onMagFullLoaded():u.Z.once("mag:loadfull:complete",this.onMagFullLoaded,this):(this.mag.model.has("_id")&&this.onMagFullLoaded(),this.restoreBackupCartData()),this};a.Z.extend(N.prototype,{ecommerceProviders:["stripe","ecwid"],CONNECTION_TIMEOUT:5e3,stripeJsSrc:"https://js.stripe.com/v3/",isConstructor:function(){return this.environment===h.ZP.environment.constructor},isViewer:function(){return this.environment===h.ZP.environment.viewer},isPreview:function(){return this.environment===h.ZP.environment.preview},getStorageKey:function(){return"".concat(this.storageKey,"_").concat(this.mag.num_id)},onMagFullLoaded:function(){this.isMagLoaded||(this.isMagLoaded=!0,this.haveEcommerceCartWidget=this.hasEcommerceWidget(),this.connectedProvider=this.getConnectedProvider(),this.cartData.provider=this.connectedProvider,this.connectEcommerceAdapter(),this.events.trigger("ecommerce:update:provider",this.connectedProvider),this.connectedProvider&&!this.productsLoading&&("stripe"===this.connectedProvider&&this.addStripeLibrary(),this.getProducts(this.connectedProvider)))},hasEcommerceWidget:function(){var t=this.isConstructor()?this.mag.globalWidgets:RM.screenshot?this.page.widgetsData:[].concat(Z(this.mag.staticGlobalWidgetsData),Z(this.mag.aboveGlobalWidgetsData));return N.hasEcommerceWidget(this.environment,t)},getEcommerceData:function(){var t=null;return this.isConstructor()?this.mag.has("ecommerce_data")&&(t=this.mag.get("ecommerce_data")):this.mag.model.has("ecommerce_data")&&(t=this.mag.model.get("ecommerce_data")),t},connectEcommerceAdapter:function(){if(this.connectedProvider)switch(this.connectedProvider){case"stripe":this.adapter=new v;break;case"ecwid":this.adapter=new P}else this.adapter=null},updateEcommerceDataFromServer:function(){var t=this;(0,k.e5)(this.mag.get("num_id")).then((function(e){null!=e&&e.ecommerce_data&&(t.mag.set({ecommerce_data:e.ecommerce_data},{silent:!0}),t.connectedProvider=t.getConnectedProvider(),t.cartData.provider=t.connectedProvider,t.connectEcommerceAdapter(),t.events.trigger("ecommerce:update:provider",t.connectedProvider))}))},getStripeConnectedUserId:function(){if(!this.isMagLoaded)return null;var t=this.getEcommerceData();return t&&t.stripe&&t.stripe.stripe_data&&t.stripe.stripe_data.stripe_user_id?t.stripe.stripe_data.stripe_user_id:null},getProducts:(R=_(regeneratorRuntime.mark((function t(e){var i,n,r,a,s=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.productsLoading=!0,i=this.isConstructor()?this.mag.get("num_id"):this.mag.model.get("num_id"),n=this.isViewer()?"published_projects":"projects",r=RM.screenshot&&"preview"===RM.screenshotMode?"?type=preview":this.isViewer()?"?type=published":"",a="stripe"===e?"/api/".concat(n,"/").concat(i,"/ecommerce/stripe/products/"):"/api/ecommerce/".concat(i,"/").concat(e,"/products").concat(r),t.abrupt("return",o.Z.ajax({type:"GET",url:a,context:this}).done((function(t){return t&&t.data&&(s.products=t.data),s.productsLoaded=!0,s.events.trigger("ecommerce:loadproducts:complete"),s.products})).fail((function(t){throw t.status,s.productsLoadingError=!0,s.events.trigger("ecommerce:loadproducts:complete"),new W("Loading products error")})).always((function(){s.productsLoading=!1})));case 6:case"end":return t.stop()}}),t,this)}))),function(t){return R.apply(this,arguments)}),updateCartProductItems:(A=_(regeneratorRuntime.mark((function t(){var e,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=null===(e=this.adapter)||void 0===e?void 0:e.updateCartProductItems(this.products,this.cartData))){t.next=9;break}return this.cartData=i,this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData),t.abrupt("return",this.cartData);case 9:throw new W("Update cart data error");case 10:case"end":return t.stop()}}),t,this)}))),function(){return A.apply(this,arguments)}),addStripeLibrary:function(){if(!(this.isConstructor()||window.Stripe&&window.Stripe.version)){var t=document.createElement("script"),e=document.getElementsByTagName("body")[0];t.setAttribute("async","async"),t.setAttribute("src",this.stripeJsSrc),e.appendChild(t)}},getConnectedProvider:function(){var t,e=this;return this.ecommerceProviders.forEach((function(i){e.isMagConnectedTo(i)&&(t=i)})),t},isMagConnectedTo:function(t){if(!this.isMagLoaded)return!1;if(!this.ecommerceProviders.includes(t))return!1;var e=this.getEcommerceData();return!!e&&Boolean(e[t]&&e[t].status&&"connected"===e[t].status)},canBeConnectedTo:function(t){if(!this.isConstructor())return!1;var e=this.getConnectedProvider();return!e||t===e},connectToStripe:function(){return new Promise(function(t,e){window.open("/api/connect/ecommerce/stripe/connect?num_id="+this.mag.get("num_id"),"_blank"),this.initSocket().then(function(e){this.mag.set({ecommerce_data:e},{silent:!0}),t()}.bind(this)).catch((function(t){e(t)}))}.bind(this))},disconnectFrom:function(t){return new Promise(function(e,i){o.Z.ajax({type:"GET",url:"/api/connect/ecommerce/".concat(t,"/disconnect?num_id=").concat(this.mag.get("num_id")),success:function(i){if(i&&i.status){this.products=null;var n=this.getEcommerceData();n[t]||(n[t]={}),n[t]=i,this.mag.set({ecommerce_data:n},{silent:!0})}e(i)},error:function(t){i(t)},context:this})}.bind(this))},getTextValue:function(t){var e,i=this.getEcommerceData(),n=null==i||null===(e=i.texts)||void 0===e?void 0:e[t];return n?d()(n):B[t]},saveTextValue:function(t,e){var i=this.getEcommerceData();i.texts||(i.texts={});var n=e||B[t];i.texts[t]=n,this.mag.save({ecommerce_data:i},{patch:!0})},initSocket:function(){return new Promise(function(t,e){var i=window.location.origin===h.ZP.readymag_auth_host&&h.ZP.stripe_live?"sockets.readymag.com/stripe-auth":"/stripe-auth",n=io(i,{timeout:this.CONNECTION_TIMEOUT});n.on("connect",function(){n.emit("wainting for mag stripe auth update",{num_id:this.mag.get("num_id"),user:this.router.me.pick("name","email","_id"),hash:this.mag.get("socket_hash")}),n.on("state-update",(function(i){n.disconnect(),i.error?e(i.error):t(i.ecommerce_data)}))}.bind(this))}.bind(this))},checkCartDisabledControls:function(){if(this.haveEcommerceCartWidget){var t=this.getEcommerceCartBlock(),e=this.getEcommerceData();t&&t.checkDisabledControls(e.stripe&&e.stripe.status&&"connected"===e.stripe.status)}},getEcommerceCartBlock:function(){return this.haveEcommerceCartWidget&&this.isConstructor()?this.router.workspace.findBlockByFunction((function(t){return t.attributes.type===h.ZP.ecommerceCartBlockName})):null},getCartWidgetData:function(){if(!this.isConstructor()){var t=this.mag.staticGlobalWidgetsData.find((function(t){return t.type===h.ZP.ecommerceCartBlockName}));return t||this.mag.aboveGlobalWidgetsData.find((function(t){return t.type===h.ZP.ecommerceCartBlockName}))}return null},getProductsLikeOptionsList:function(t){return this.products&&this.adapter?this.adapter.mapProductsSelectList(this.products,t):[]},checkProductActive:function(t){if(t){var e=this.getProductById(t);if(e)return!!this.adapter&&this.adapter.checkProductActive(e)}},productHasActiveSku:function(t){return!(!t||!this.adapter)&&this.adapter.productHasActiveSku(t)},isOptionValid:function(t){return this.adapter&&this.adapter.isOptionValid(t)},isSkuAvailable:function(t){return!!t.active&&("infinite"===t.inventory.type||("finite"===t.inventory.type&&t.inventory.quantity>0||"bucket"===t.inventory.type&&("in_stock"===t.inventory.value||"limited"===t.inventory.value)))},getProductById:function(t){return this.products&&Array.isArray(this.products)?this.products.find((function(e){return e.id===t})):null},getProductsStatus:function(){return this.productsLoading?"loading":this.productsLoaded?"loaded":"failed"},getSkusByProductId:function(t){var e=this.getProductById(t);return e?e.articles:null},getFirstAvailableSku:function(t){return t?t.find(function(t){return this.isSkuAvailable(t)}.bind(this)):null},getFirstAvailableSkuForProductId:function(t){return this.getFirstAvailableSku(this.getSkusByProductId(t))},changeCartSidebarVisibility:function(){return this.isCartSidebarHidden=!this.isCartSidebarHidden,u.Z.trigger("ecommerce:cartsidebar:visibility:changed",this.isCartSidebarHidden),this.isCartSidebarHidden},checkItemQuantity:function(t){if("string"!=typeof t){var e=t;return!!("infinite"===e.inventory.type||"finite"===e.inventory.type&&e.inventory.quantity||"bucket"===e.inventory.type&&"out_of_stock"!==e.inventory.value)}if(this.cartData.skus[t]){var i=this.cartData.skus[t];return"infinite"===i.inventory.type||"finite"===i.inventory.type&&i.cart_count<i.inventory.quantity||"bucket"===i.inventory.type&&"out_of_stock"!==i.inventory.value}return!1},checkItemQuantityOnUpdate:function(t){if(this.cartData.skus[t]){var e=this.cartData.skus[t];return"infinite"===e.inventory.type||"finite"===e.inventory.type&&e.cart_count<=e.inventory.quantity||"bucket"===e.inventory.type&&"out_of_stock"!==e.inventory.value}return!1},getCartData:function(){return this.cartData},markCartChange:function(){this.cartData.changed=(new Date).toISOString()},isProductAvailable:function(t){var e;return null===(e=this.adapter)||void 0===e?void 0:e.isProductAvailable(t)},isOutOfStock:function(t){var e;return null===(e=this.adapter)||void 0===e?void 0:e.isOutOfStock(t,this.cartData)},getProductForAddToCart:function(t,e){var i;return null===(i=this.adapter)||void 0===i?void 0:i.getProductForAddToCart(t,e)},addProductToCart:function(t){switch(t.object){case"price":return this.addPriceToCart(t);case"product":return this.addEcwidToCart(t);case"sku":return this.addSkuToCart(t);default:return new W("provider not found")}},addSkuToCart:function(t){if(!t||!t.id)return new W("Sku data isn't valid or doesn’t have an id");if(this.cartData.skus[t.id]){if(!this.checkItemQuantity(t.id))return new W("You can’t add this product with attribute "+t.id+". It's out of stock",z.outOfStock);this.cartData.skus[t.id]=Object.assign({},t,{cart_count:this.cartData.skus[t.id].cart_count+1})}else{if(this.cartData.uniqSkusCount+1>this.cartItemsLimit)return new W("You can’t add more than "+this.cartItemsLimit+" items to the cart");if(!this.checkItemQuantity(t))return new W("You can’t add this product with attribute "+t.id+". It's out of stock",z.outOfStock);this.cartData.skus[t.id]=Object.assign({},t,{cart_count:1}),this.cartData.uniqSkusCount+=1,t.productObject.shippable&&(this.cartData.shippableProducts+=1)}return this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData),this.cartData},addPriceToCart:function(t){if(!t||!t.id||!t.active)return new W("Price data isn't valid or doesn’t have an id");if(this.cartData.prices[t.id])this.cartData.prices[t.id]=Object.assign({},t,{cart_count:this.cartData.prices[t.id].cart_count+1});else{if(this.cartData.uniqPricesCount+1>this.cartItemsLimit)return new W("You can’t add more than "+this.cartItemsLimit+" items to the cart");this.cartData.prices[t.id]=Object.assign({},t,{cart_count:1}),this.cartData.uniqPricesCount+=1}return this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData),this.cartData},addEcwidToCart:function(t){if(!t||!t.id)return new W("Product data isn't valid or doesn’t have an id");var e=this.getCartItenKey(t);return this.isProductAvailable(t)?this.isOutOfStock(t)?new W("You can’t add more product ".concat(t.id," items to the cart"),z.outOfStock):(this.cartData.prices[e]?this.cartData.prices[e].cart_count+=1:(this.cartData.prices[e]=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?x(Object(i),!0).forEach((function(e){O(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({cart_count:1},t),this.cartData.uniqPricesCount+=1),this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData),this.cartData):new W("You can’t add this product ".concat(t.id,". It's out of stock"),z.outOfStock)},getCartItenKey:function(t){return"product"===t.object&&t.selectedOptions&&Object.keys(t.selectedOptions).length>0?c()("".concat(t.id,"-").concat(JSON.stringify(t.selectedOptions))):t.id},increaseCartItem:function(t){this.cartData.prices[t]&&(this.cartData.prices[t].cart_count+=1,this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData))},increaseSkuCartItem:function(t){if(this.cartData.skus[t]){if(!this.checkItemQuantity(t))return new W("You can’t add more this product with attribute "+t+". It's out of stock",z.outOfStock);this.cartData.skus[t].cart_count+=1,this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData)}},decreaseCartItem:function(t){this.cartData.prices[t]&&this.cartData.prices[t].cart_count>1&&(this.cartData.prices[t].cart_count-=1,this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData))},decreaseSkuCartItem:function(t){this.cartData.skus[t]&&this.cartData.skus[t].cart_count>1&&(this.cartData.skus[t].cart_count-=1,this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData))},removeFromCart:function(t){this.cartData.prices[t]&&(delete this.cartData.prices[t],this.cartData.uniqPricesCount-=1,this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData))},removeSkuFromCart:function(t){this.cartData.skus[t]&&(this.cartData.skus[t].productObject.shippable&&(this.cartData.shippableProducts-=1),delete this.cartData.skus[t],this.cartData.uniqSkusCount-=1,this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData))},clearCart:function(){this.cartData=F(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData)},updateCartSkus:function(t){var e=this,i=[];if(t.forEach((function(t){e.cartData.skus[t.id]&&(e.cartData.skus[t.id]=Object.assign({},e.cartData.skus[t.id],t),e.checkItemQuantityOnUpdate(t.id)||i.push(e.cartData.skus[t.id].productObject.name))})),this.backupCartData(),i.length)return i},updateCartData:function(){return new Promise(function(t,e){this.cartData&&this.cartData.skus||e(new W("Empty cart"));var i=[];for(var n in this.cartData.skus)this.cartData.skus.hasOwnProperty(n)&&i.push(n);var r=i.length?a.Z.uniq(i).join(","):null;o.Z.ajax({type:"GET",url:"/api/projects/"+this.mag.num_id+"/ecommerce/stripe/skus/"+(r?"?skus_ids="+r:""),contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){if(i&&i.data){var n=this.updateCartSkus(i.data);if(n){var r=n.length>1;e(new W("This item".concat(r?"s":""," cannot be used to create an order: ").concat(n.join(", ")," ").concat(r?"are":"is"," out of stock"),z.outOfStock))}t(this.cartData)}}.bind(this),error:function(){e(new W("Error occurred while updating the skus:",i))}})}.bind(this))},hasShippableProducts:function(){return!!this.cartData.shippableProducts||!!this.cartData.uniqPricesCount},setShippingForm:function(t){this.cartData.shippingForm=a.Z.cloneWithObjects(t),this.markCartChange(),this.backupCartData()},getShippingForm:function(){return a.Z.cloneWithObjects(this.cartData.shippingForm)},getShippingOptions:function(){return this.cartData.order&&this.cartData.order.shipping_methods?this.cartData.order.shipping_methods.map((function(t){return{id:t.id,label:t.description,amount:t.amount}})):null},setOrder:function(t){this.cartData.order=t,this.backupCartData()},getOrder:function(){return this.cartData.order},deleteOrder:function(){this.cartData.order=null,this.backupCartData()},cancelOrder:function(){return this.changeOrder({status:"canceled"})},changeShippingMethod:function(t){return this.changeOrder({selected_shipping_method:t})},changeOrder:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(e,i){this.cartData.order||i(new W("No order")),this.cancelingOrder&&i(),this.cancelingOrder=!0,o.Z.ajax({type:"PATCH",url:"/api/projects/"+this.mag.num_id+"/ecommerce/stripe/orders/"+this.cartData.order.id+"/",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){this.cancelingOrder=!1,e(t)}.bind(this),error:function(t){this.cancelingOrder=!1,i(new W(t.responseText))}})}.bind(this))},setCustomer:function(t){this.cartData.customer=t,this.backupCartData()},createOrUpdateCustomer:function(t,e){return new Promise((function(i,n){o.Z.ajax({type:"POST",url:"/api/projects/".concat(t,"/ecommerce/stripe/customers/"),data:JSON.stringify({customer_data:e}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){i(t)},error:function(t){n(new W(t.responseText))}})}))},getCustomer:function(){return this.cartData.customer},setInvoiceItems:function(t){this.cartData.invoiceItems=t,this.backupCartData()},unsetInvoiceItems:function(){delete this.cartData.invoiceItems,this.backupCartData()},createInvoiceItems:function(t,e,i){return new Promise((function(n,r){o.Z.ajax({type:"POST",url:"/api/projects/".concat(t,"/ecommerce/stripe/invoice_items/"),data:JSON.stringify({customer_id:e,prices:i}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){n(t)},error:function(t){r(new W(t.responseText))}})}))},setInvoice:function(t){this.cartData.invoice=t,this.backupCartData()},unsetInvoice:function(){delete this.cartData.invoice,this.backupCartData()},createInvoice:function(t,e){return new Promise((function(i,n){o.Z.ajax({type:"POST",url:"/api/projects/".concat(t,"/ecommerce/stripe/invoices/"),data:JSON.stringify({invoiceData:e}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){i(t)},error:function(t){t.responseJSON&&"invoice_no_customer_line_items"===t.responseJSON.code?n(new W(t.responseJSON.message,z.nothingToInvoice)):n(new W(t.responseText))}})}))},getInvoice:function(t,e){return new Promise((function(i,n){o.Z.ajax({type:"GET",url:"/api/projects/".concat(t,"/ecommerce/stripe/invoices/").concat(e,"/"),contentType:"application/json; charset=utf-8",success:function(t){t&&t.data?i(t.data):n(new W("Not valid response, getInvoice"))},error:function(t){n(new W(t.responseText))}})}))},deleteDraftInvoice:function(t,e){return new Promise((function(i,n){o.Z.ajax({type:"DELETE",url:"/api/projects/".concat(t,"/ecommerce/stripe/invoices/").concat(e,"/"),contentType:"application/json; charset=utf-8",success:function(t){t&&t.data?i(t.data):n(new W("Not valid response"))},error:function(t){n(new W(t.responseText))}})}))},voidDraftInvoice:function(t,e){return new Promise((function(i,n){o.Z.ajax({type:"POST",url:"/api/projects/".concat(t,"/ecommerce/stripe/invoices/").concat(e,"/void/"),contentType:"application/json; charset=utf-8",success:function(t){t&&t.data?i(t.data):n(new W("Not valid response"))},error:function(t){n(new W(t.responseText))}})}))},finalizeInvoice:function(t,e){return new Promise((function(i,n){o.Z.ajax({type:"POST",url:"/api/projects/".concat(t,"/ecommerce/stripe/invoices/").concat(e,"/finalize/"),contentType:"application/json; charset=utf-8",success:function(t){t&&t.data?i(t.data):n(new W("Not valid response"))},error:function(t){n(new W(t.responseText))}})}))},getPaymentIntent:function(t,e){return new Promise((function(i,n){o.Z.ajax({type:"GET",url:"/api/projects/".concat(t,"/ecommerce/stripe/payment_intents/").concat(e,"/"),contentType:"application/json; charset=utf-8",success:function(t){t&&t.data?i(t.data):n(new W("Not valid response"))},error:function(t){n(new W(t.responseText))}})}))},updatePaymentIntent:function(t,e,i){return new Promise((function(n,r){o.Z.ajax({type:"PATCH",url:"/api/projects/".concat(t,"/ecommerce/stripe/payment_intents/").concat(e,"/"),contentType:"application/json; charset=utf-8",data:JSON.stringify({paymentIntentData:i}),dataType:"json",success:function(t){t&&t.data?n(t.data):r(new W("Not valid response"))},error:function(t){r(new W(t.responseText))}})}))},validateCartData:function(t){return!(!t||"object"!==C(t)||isNaN(Date.parse(t.changed))||isNaN(Date.parse(t.backuped))||"number"!=typeof t.uniqSkusCount||"number"!=typeof t.uniqPricesCount||"object"!==C(t.skus)||"object"!==C(t.prices)||"object"!==C(t.order)&&null!==t.order)},getInvalidAddToCartWidgets:function(){var t=this.mag.getAllWidgets().filter((function(t){return"addtocart"===t.type&&!t.hidden}));if(!t||!t.length)return[];var e=this.products?this.products.map((function(t){return t.id})):[];return t.filter((function(t){return!t.selected_product_id||!e.includes(t.selected_product_id)}))},restoreBackupCartData:function(){if(Modernizr.localstorage){var t=localStorage.getItem(this.getStorageKey());if(t){var e=JSON.parse(t);if(!e.provider||e.provider!==this.connectedProvider)return void this.clearBackup();var i=((Date.now()-Date.parse(e.backuped))/1e3/60/60).toFixed(2);this.validateCartData(e)&&i<=24?this.cartData=e:this.clearBackup()}}},backupCartData:function(){Modernizr.localstorage&&(this.cartData.backuped=(new Date).toISOString(),localStorage.setItem(this.getStorageKey(),JSON.stringify(this.cartData)))},clearBackup:function(){Modernizr.localstorage&&localStorage.removeItem(this.getStorageKey())}}),N.hasEcommerceWidget=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t===h.ZP.environment.constructor?Boolean(e.find((function(t){return t.get("type")===h.ZP.ecommerceCartBlockName}))):Boolean(e.find((function(t){return t.type===h.ZP.ecommerceCartBlockName})))};var V=N},735:function(t,e,i){"use strict";var n=i(321),r=i(736),a=i(340),o=i(343),s={GLOBAL_UNIQUE_KEYS:["hidden","z"],GLOBAL_UNIQUE_KEY_PREFIX:"_",FADE_DURATION:200,getUniqueValue:function(t,e,i){var r=e[this.GLOBAL_UNIQUE_KEY_PREFIX+t]||[],a=n.Z.findWhere(r,{pid:i});return void 0===(a=a||n.Z.findWhere(r,{pid:"default"})||{}).value?e[t]:a.value},resetGlobalData:function(t,e){var i=this;return n.Z.each(o.ZP.viewport_listall,(function(r){n.Z.each(i.GLOBAL_UNIQUE_KEYS,(function(a){r==="viewport_"+e?t.set(i.GLOBAL_UNIQUE_KEY_PREFIX+a,[]):n.Z.isEmpty(t[r])||(t[r][i.GLOBAL_UNIQUE_KEY_PREFIX+a]=[])}))})),{}},isGlobalKey:function(t){return-1!==this.GLOBAL_UNIQUE_KEYS.indexOf(t)},getGlobalPrefixedKey:function(t){return this.isGlobalKey(t)?this.GLOBAL_UNIQUE_KEY_PREFIX+t:null},fillUniqueAttributeSets:function(t,e,i){var r={};return e.is_global?((0,n.Z)(this.GLOBAL_UNIQUE_KEYS).each(function(a){if(n.Z.has(t,a)&&void 0!==t[a]){var o=e[this.GLOBAL_UNIQUE_KEY_PREFIX+a]||[],s=n.Z.findWhere(o,{pid:i}),c=n.Z.findWhere(o,{pid:"default"});s?s.value=t[a]:o.push({pid:i,value:t[a]}),c||o.push({pid:"default",value:void 0===e[a]?null:e[a]}),r[this.GLOBAL_UNIQUE_KEY_PREFIX+a]=o}}.bind(this)),r):t},ensurePageDefRecord:function(t){(0,n.Z)(this.GLOBAL_UNIQUE_KEYS).each(function(e){var i=t[this.GLOBAL_UNIQUE_KEY_PREFIX+e]||[];n.Z.findWhere(i,{pid:"default"})||i.push({pid:"default",value:void 0===t[e]?null:t[e]}),t[this.GLOBAL_UNIQUE_KEY_PREFIX+e]=i}.bind(this))},fillUniqueValues:function(t,e,i){i=i||{},n.Z.each(t,(function(r,a){if(n.Z.contains(this.GLOBAL_UNIQUE_KEYS,a)&&(!i.props||n.Z.contains(i.props,a))){var o=this.getUniqueValue(a,t,e);t[a]=void 0===o?r:o}}),this)},isHidden:function(t,e,i){return this.getUniqueValue("hidden",t,e)||!i&&r.Z.hasExpired(t)},show:function(t,e){e=Boolean(e),t.$el.toggleClass("no-transition",e),t.$el.addClass("above-all-fade"),t.$el.hasClass("fade-in")&&!e||(t.cancelHide&&t.cancelHide(),t.show(),n.Z.delay((function(){t.$el.addClass("fade-in")}),50))},hide:function(t,e){return e=Boolean(e),t.$el.addClass("above-all-fade"),new window.Promise((function(i){t.$el.hasClass("fade-in")||e?(t.$el.toggleClass("no-transition",e),t.$el.removeClass("fade-in"),e?(t.hide(),i()):t.cancelHide=a.default.waitForTransitionEnd(t.$el,s.FADE_DURATION,"opacity",(function(){t.hide(),i()}))):i()}))}};e.Z=s},1074:function(t,e,i){"use strict";i.d(e,{x:function(){return n}});var n=function(t,e){return new Intl.NumberFormat(window.navigator.language||"en-US",{style:"currency",currency:e}).format(t)}},741:function(t,e,i){"use strict";var n=i(321),r=i(710),a={sideAngles:{top:0,right:.5*Math.PI,bottom:Math.PI,left:1.5*Math.PI},calcOrientedTriangleSquare:function(t,e,i){return(e.x-t.x)*(i.y-t.y)-(e.y-t.y)*(i.x-t.x)},intersectsOnAxisProjection:function(t,e,i,n){var r;return t>e&&(r=t,t=e,e=r),i>n&&(r=i,i=n,n=r),t<i&&(t=i),e>n&&(e=n),t<=e},isLinesIntersects:function(t,e,i,n){return a.intersectsOnAxisProjection(t.x,e.x,i.x,n.x)&&a.intersectsOnAxisProjection(t.y,e.y,i.y,n.y)&&a.calcOrientedTriangleSquare(t,e,i)*a.calcOrientedTriangleSquare(t,e,n)<=0&&a.calcOrientedTriangleSquare(i,n,t)*a.calcOrientedTriangleSquare(i,n,e)<=0},isConvexPolygonContainsPoint:function(t,e){for(var i=0;i<t.length;i++){var n=(i+1)%t.length;if(a.calcOrientedTriangleSquare(t[i],t[n],e)<0)return!1}return!0},isConvexPolygonsIntersects:function(t,e){var i,n,r,o;for(i=0;i<t.length;i++)if(a.isConvexPolygonContainsPoint(e,t[i]))return!0;for(i=0;i<e.length;i++)if(a.isConvexPolygonContainsPoint(t,e[i]))return!0;for(i=0;i<t.length;i++)for(n=(i+1)%t.length,r=0;r<e.length;r++)if(o=(r+1)%e.length,a.isLinesIntersects(t[i],t[n],e[r],e[o]))return!0;return!1},doBoundingBoxesIntersect:function(t,e){return t&&e&&!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)},calcBoundingBox:function(t,e,i){var r=a.calcRotatedBox(t),o=n.Z.pluck(r,"x"),s=n.Z.pluck(r,"y"),c=Math.min.apply(null,o),l=Math.max.apply(null,o),d=Math.min.apply(null,s),u=c,h=d,p=l-c,f=Math.max.apply(null,s)-d;return e&&(["n","c","s"].indexOf(e)>-1&&(u=t.left),["w","c","e"].indexOf(e)>-1&&(h=t.top)),i?{width:p,height:f,left:u,top:h}:{bb_width:p,bb_height:f,bb_left:u,bb_top:h}},boxToRect:function(t){return{width:t.width,height:t.height,top:t.top,bottom:t.top+t.height,left:t.left,right:t.left+t.width}},getBoundingBoxOfElements:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=t.map((function(t){return t.parentElement?1!==e?r.Z.getBox(t,e):t.getBoundingClientRect():{bottom:0,height:0,left:0,right:0,top:0,width:0}}));return a.getBoundingBoxOfBoxes(i)},getBoundingBoxOfBoxes:function(t){var e=[],i=[];n.Z.each(t,(function(t){var r=void 0!==t.right?n.Z.extend({},t):a.boxToRect(t);e.push(r.left),e.push(r.right),i.push(r.top),i.push(r.bottom)}));var r={top:Math.min.apply(null,i),right:Math.max.apply(null,e),bottom:Math.max.apply(null,i),left:Math.min.apply(null,e)};return r.width=r.right-r.left,r.height=r.bottom-r.top,r},getBoundingBoxOfBlocks:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=t.map((function(t){var e=t.getBoxData({includeBoundingBox:!0,checkFixedPosition:!0});return{width:e.bb_w,height:e.bb_h,top:e.bb_y,left:e.bb_x}}));return a.getBoundingBoxOfBoxes(e)},calcRotatedBox:function(t){var e=[],i=[0,1,1,0],r=[0,0,1,1],a=t.left+t.width/2,o=t.top+t.height/2,s=t.sinAngle,c=t.cosAngle;return n.Z.each(i,(function(n,l){var d=t.left+t.width*i[l],u=t.top+t.height*r[l],h=d-a,p=o-u;d=a+c*h+s*p,u=o+s*h-c*p;e.push({x:d,y:u})})),e},getDistance:function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},getBestPoints:function(t,e){for(var i,n,r,o=["right","left","bottom","top"],s={distance:1/0,fromPoint:{},toPoint:{}},c=0;c<o.length;c++)for(var l=0;l<o.length;l++)n=a.getSideCenter(t,o[c]),r=a.getSideCenter(e,o[l]),s=(i=a.getDistance(n,r))<s.distance?{distance:i,fromSide:o[c],fromPoint:n,toSide:o[l],toPoint:r}:s;return s},getSideCenter:function(t,e){var i;switch(e){case"left":i={x:t.left,y:t.top+t.height/2};break;case"top":i={x:t.left+t.width/2,y:t.top};break;case"bottom":i={x:t.left+t.width/2,y:t.top+t.height};break;case"right":default:i={x:t.left+t.width,y:t.top+t.height/2}}return i={x:(i.x-t.centerX)*t.cos-(i.y-t.centerY)*t.sin+t.centerX,y:(i.y-t.centerY)*t.cos+(i.x-t.centerX)*t.sin+t.centerY}},getPerpendicularEnd:function(t,e,i,n){var r=i.angle+a.sideAngles[t];return{x:n*Math.sin(r)+e.x,y:-n*Math.cos(r)+e.y}},getBox:function(t){var e=(t.$el&&t.$el[0]||t.length&&t[0]||t).getBoundingClientRect(),i=t.model?(t.model.attributes.angle||0)*Math.PI/180:0;return e=n.Z.extend(e,{angle:i,sin:Math.sin(i),cos:Math.cos(i)}),e=n.Z.extend(e,{centerX:e.left+e.width/2,centerY:e.top+e.height/2})},getResizedBoxNested:function(t,e,i,n){var r=i.width/e.width,a=i.height/e.height;return r="height"===n?a:r,a="width"===n?r:a,{left:(t.left-e.left)*r+i.left,top:(t.top-e.top)*a+i.top,width:t.width*r,height:t.height*a}},getResizedBoxByBB:function(t,e,i){var n=i.left+i.width/2,r=i.top+i.height/2,a=i.width/e.width,o=i.height/e.height,s=t.width*a,c=t.height*o;return{left:n-s/2,top:r-c/2,width:s,height:c}},getBoxLimits:function(t,e){var i=t.width/t.height>1,n=i?e.minheight/t.height:e.minwidth/t.width,r=i?e.maxwidth/t.width:e.maxheight/t.height;return{minwidth:e.minwidth?Math.round(t.width*n):1,minheight:e.minheight?Math.round(t.height*n):1,maxwidth:e.maxwidth?Math.round(t.width*r):1/0,maxheight:e.maxheight?Math.round(t.height*r):1/0}},isBoxInView:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,i=e?e*t.height:1,n=e?e*t.width:1,r=t.height&&t.bottom>=i&&t.bottom<=window.innerHeight,a=t.height&&t.top<=window.innerHeight-i&&t.top>0,o=t.width&&t.right>=n&&t.right<=window.innerWidth,s=t.width&&t.left<=window.innerWidth-n&&t.left>0;return(r||a)&&(o||s)}};e.Z=a},958:function(t,e,i){"use strict";i.d(e,{Z:function(){return v}});var n,r=i(336),a=i.n(r),o=i(312),s=i(321),c=i(340),l=i(710),d=i(349);var u,h,p,f,g,m=(u={},h="template-picture-preview-box",p=(0,d.f)(n||(f=['\n  <div>\n    <div class="picture-preview-box">\n      <div class="picture-preview-box-overlay" style="background-color: <%=overlayColor%>;"></div>\n      <img class="picture-preview-box-image" srcset="<%=previewSrc%>" style="<%= Object.keys(originalStyle).map(function(key) { return key + \':\' + originalStyle[key] }).join(\'; \') %>" />\n    </div>\n  </div>\n'],g||(g=f.slice(0)),n=Object.freeze(Object.defineProperties(f,{raw:{value:Object.freeze(g)}})))),h in u?Object.defineProperty(u,h,{value:p,enumerable:!0,configurable:!0,writable:!0}):u[h]=p,u),v=a().View.extend({viewportWidth:void 0,viewport:void 0,viewerOptions:void 0,initialize:function(t){s.Z.bindAll(this),s.Z.extend(this,t)},render:function(){if(this.picture){this.removing=!1,(0,o.Z)("body").addClass("picture-preview-loading"),this.originalRect=this.getRect(this.$el[0]),this.orientation=this.getOrientation(),this.originalStyle=this.getOriginalStyle();var t=m["template-picture-preview-box"];return this.$preview=(0,o.Z)(t({overlayColor:this.overlayColor,previewSrc:this.getPreviewSrc(),originalStyle:this.originalStyle})),this.$container.append(this.$preview),(0,o.Z)(window).on("scroll",this.onScroll),(0,o.Z)("body").on("keypress keyup keydown",this.onKeyPress),setTimeout(this.setVisible,100),this.$preview}},imagePreload:function(){var t=this;if(!this.removing&&this.picture){var e=this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl||this.picture.final3xUrl||this.picture.final2xUrl||this.picture.finalUrl;this.getPreviewSrc()!==e?(this.img=new Image,this.img.onload=function(){(0,o.Z)("body").removeClass("picture-preview-loading"),t.$preview&&setTimeout((function(){t.removing||t.$preview.find(".picture-preview-box .picture-preview-box-image").attr("src",t.img.src).removeAttr("srcset")}),100)},this.img.src=e):(0,o.Z)("body").removeClass("picture-preview-loading")}},remove:function(t){var e=this;if(this.removing=!0,(0,o.Z)("body").removeClass("picture-preview-loading"),(0,o.Z)("body").off("keypress keyup keydown",this.onKeyPress),(0,o.Z)(window).off("scroll",this.onScroll),this.img&&(this.img.src="",delete this.img),this.$preview){var i=this.$preview.find(".picture-preview-box");i.removeClass("visible loaded").removeClass(this.orientation),c.default.waitForTransitionEnd(i.find(".picture-preview-box-overlay"),300,"opacity",(function(){e.$preview&&e.$preview.remove(),delete e.$preview})),t&&t()}},changeColor:function(t){this.$preview&&this.$preview.find(".picture-preview-box-overlay").css("background-color",t)},onScroll:function(){this.remove()},setVisible:function(){var t=this;if(!this.removing){var e=this.$preview.find(".picture-preview-box img")[0],i=function i(){e.removeEventListener("load",i),t.$preview.find(".picture-preview-box").addClass("visible").addClass(t.orientation),c.default.waitForTransitionEnd(t.$preview.find(".picture-preview-box .picture-preview-box-overlay"),300,"opacity",t.imagePreload)};setTimeout((function(){e.complete?i():e.addEventListener("load",i)}),100)}},getPreviewSrc:function(){var t=this.$el.find("img")[0];return t&&(t.currentSrc||t.src)||this.picture&&(this.picture.unscaledOptimizedUrl||this.picture.final3xUrl||this.picture.final2xUrl||this.picture.finalUrl)},getOriginalStyle:function(){if(!this.originalRect)return{};var t=l.Z.isOn(this.viewport,this.viewportWidth,this.viewerOptions)&&l.Z.isCSSZoom()?l.Z.getRatio(this.viewportWidth):1,e={top:Number(this.originalRect.top+.5*this.originalRect.height)*t+"px",left:Number(this.originalRect.left+.5*this.originalRect.width)*t+"px"};return"portrait"===this.orientation?e.height=this.originalRect.height*t+"px":"landscape"===this.orientation&&(e.width=this.originalRect.width*t+"px"),e},getOrientation:function(){var t=this.originalRect.height/this.originalRect.width,e=(0,o.Z)(window).width();return(0,o.Z)(window).height()/t<e?"portrait":"landscape"},bindClick:function(){var t=this;this.$preview&&this.$preview.on("click",(function(){t.remove()}))},onKeyPress:function(t){27===t.keyCode&&this.remove()},getRect:function(t){var e=s.Z.extend({},t.getBoundingClientRect());if(Modernizr.safari){var i=l.Z.isOn(this.viewport,this.viewportWidth,this.viewerOptions)&&l.Z.isCSSZoom()?l.Z.getRatio(this.viewportWidth):1;e.top=e.top+((0,o.Z)(window).scrollTop()-(0,o.Z)(window).scrollTop()/i)}return e}})},935:function(t,e,i){"use strict";var n=i(308),r=i(936);function a(t,e){if(null==t)return{};var i,n,r=function(t,e){if(null==t)return{};var i,n,r={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(r[i]=t[i]);return r}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(r[i]=t[i])}return r}function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach((function(e){c(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function c(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var l=Boolean(window&&window.viewerConfig&&window.viewerConfig.homepageRewrite),d=Boolean(window&&window.viewerConfig&&window.viewerConfig.isDownloadedSource)&&!l,u=function(t){return n.ZP.allowedLambdaExt.includes(t)},h=function(t){return Boolean(!d&&t&&t.lambdaUrl&&u(t.type))},p=function(t,e){switch(e){case"video":case"slideshow":return Boolean(!d&&t&&t.url&&u(t.type));case"background":return Boolean(!d&&t&&(t.url||t.finalUrl)&&u(t.type));default:return Boolean(!d&&t&&(t.unscaledUrl||t.unscaledOptimizedUrl)&&u(t.type))}},f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.width,i=t.height,r=t.cropX,a=t.cropY,o=t.cropW,s=t.cropH,c=t.originalW,l=void 0===c?9999:c,d=t.originalH,u=void 0===d?9999:d,h=t.quality,p=t.ext,f=t.scale,g=t.animationScale,m=t.isStretched,v=t.dpr,y=t.lossless,b=t.nearLossless,w=t.fit,S=void 0===w?"none":w,P=window.devicePixelRatio||n.ZP.minDpr,k=v||(P<n.ZP.minDpr?n.ZP.minDpr:P),C=[],x=Math.max(f||1,1),O=g||1;if(!m&&e){var T=Math.min(Math.round(e*k*x*O),l);T<l&&C.push("w=".concat(T))}if(!m&&!e&&i){var _=Math.min(Math.round(i*k*x*O),u);_<u&&C.push("h=".concat(_))}if(h&&C.push("q=".concat(h)),p&&C.push("e=".concat(p)),y&&C.push("ll=true"),b&&C.push("nll=true"),"auto"===S&&e&&i){var Z=Math.min(Math.round(i*k*x*O),u);Z<u&&C.push("h=".concat(Z))}return void 0!==r&&void 0!==a&&o&&s&&(o!==l||s!==u)&&(C.push("cX=".concat(r)),C.push("cY=".concat(a)),C.push("cW=".concat(o)),C.push("cH=".concat(s))),C.length?"?".concat(C.join("&")):""},g=function(t){return t?"".concat(t.lambdaUrl||function(t){if(!t)return"";try{var e=new URL(t.unscaledUrl||t.url||t.unscaledOptimizedUrl||t.finalUrl);return"".concat(n.ZP.readymag_lambda_host).concat(e.pathname)}catch(t){return""}}(t)):""},m=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)return"";var i=s({},e);return p(t)&&!h(t)&&(i.cropX=void 0,i.cropY=void 0,i.cropW=e.originalW,i.cropH=e.originalH),r.Z.isSupported("webp")&&(i.ext="webp","png"===t.type&&(i.nearLossless=!0)),"".concat(g(t)).concat(f(i))};e.Z={allowedLambdaExt:u,useLambdaUrl:h,useLambdaUrlOldProjects:p,useLqipUrl:function(t){return Boolean(t&&t.lqipUrl||h(t))},getLambdaUrl:m,getOriginalLambdaUrl:g,getLambdaParams:f,getSrcset:function(t,e){var i=e.dprSet,n=void 0===i?[2,3]:i,r=a(e,["dprSet"]),o=[];(n||[]).forEach((function(e){r.dpr=e;var i=m(t,r);i!==o[o.length-1]&&o.push({dpr:e,url:i})}));var s=o.map((function(t){return"".concat(t.url," ").concat(t.dpr,"x")}));return s.length>1?s.join(", "):void 0},getLqipUrl:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)return"";if(t.lqipUrl)return t.lqipUrl;var i=s({dpr:1,width:n.ZP.lqipWidth,quality:n.ZP.lqipQuality},e);return m(t,i)},getThumbnailUrl:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)return"";var i=s({width:n.ZP.THUMB_SIZE,height:n.ZP.THUMB_SIZE,quality:n.ZP.THUMB_QUALITY,fit:"auto"},e);return m(t,i)}}},1035:function(t,e,i){"use strict";var n=i(312);window.iconSVGCache=[];var r=function(){};r.prototype={MAX_ICON_CACHE_SIZE:30,generateShapeSVG:function(t,e,i,r,a){var o,s=1e5,c=e.get("bg_color")||e.viewport_default&&e.viewport_default.bg_color,l=this.getRGBA(c||"ffffff",e.get("bg_opacity")),d=this.getRGBA(e.get("color"),e.get("opacity"));if("ellipse"==(a="hotspot"===e.get("type")?a||e.get("pin_type"):a||e.get("tp"))){var u=i/2,h=r/2,p=e.get("borders");o=Z("ellipse",{cx:u,cy:h,rx:u,ry:h},l,d,p=Math.min(p,u,h),e.id+"_"+t,e.get("opacity"))}if("rectangle"==a||"polygon"==a){"hotspot"===e.get("type")&&(d=l="rgba(0, 0, 0, 0)");var f,g="rectangle"==a?4:e.get("sides"),m=(p=e.get("borders"),e.get("radius")||0),v=e.get("radius_rect_independent"),y={tlRadius:e.get("radius_rect_tl")||0,trRadius:e.get("radius_rect_tr")||0,blRadius:e.get("radius_rect_bl")||0,brRadius:e.get("radius_rect_br")||0},b=function(t,e,i,n){for(var r,a,o,c=2*Math.PI/t,l=Math.PI/2-(t%2==1?0:c/2),d=[],u=999999,h=-999999,p=999999,f=-999999,g=0;g<t;g++)r=l+g*c,a=.5+.5*Math.cos(r),o=.5-.5*Math.sin(r),d.push({x:a,y:o}),a<u&&(u=a),a>h&&(h=a),o<p&&(p=o),o>f&&(f=o);for(g=0;g<t;g++)d[g].x=(d[g].x-u)*(e/(h-u)),d[g].y=(d[g].y-p)*(i/(f-p)),d[g].x=Math.round(d[g].x*s)/s,d[g].y=Math.round(d[g].y*s)/s;return d}(g,i,r),w=function(t){if(!t)return 99999;for(var e,i=99999,n=t.length,r=0;r<n;r++){var a=t[r].x-t[(r+1)%n].x,o=t[r].y-t[(r+1)%n].y;(e=Math.sqrt(a*a+o*o))<i&&(i=e),t[r].side=e}return i}(b);o=Z("path",{path:"rectangle"===a&&v?function(t,e){var i=t.tlRadius,n=t.trRadius,r=t.brRadius,a=t.blRadius,o=e.trTop,s=e.tlTop,c=e.tlLeft,l=e.blLeft,d=e.blBottom,u=e.brBottom,h=e.brRight,p=e.trRight;return"M ".concat(o.x," 0\n        L ").concat(s.x," ").concat(s.y,"\n        A ").concat(i," ").concat(i," 0 0 0 ").concat(c.x," ").concat(c.y,"\n        L ").concat(l.x," ").concat(l.y,"\n        A ").concat(a," ").concat(a," 0 0 0 ").concat(d.x," ").concat(d.y,"\n        L ").concat(u.x," ").concat(u.y,"\n        A ").concat(r," ").concat(r," 0 0 0 ").concat(h.x," ").concat(h.y,"\n        L ").concat(p.x," ").concat(p.y,"\n        A ").concat(n," ").concat(n," 0 0 0 ").concat(o.x," ").concat(o.y,"\n        Z")}(y,f=function(t,e,i){var n=e.trRadius,r=e.tlRadius,a=e.blRadius,o=e.brRadius;return n=Math.min(n,i/2),r=Math.min(r,i/2),a=Math.min(a,i/2),o=Math.min(o,i/2),{trTop:{x:t[0].x-n,y:t[0].y},tlTop:{x:t[1].x+r,y:t[1].y},tlLeft:{x:t[1].x,y:t[1].y+r},blLeft:{x:t[2].x,y:t[2].y-a},blBottom:{x:t[2].x+a,y:t[2].y},brBottom:{x:t[3].x-o,y:t[3].y},brRight:{x:t[3].x,y:t[3].y-o},trRight:{x:t[0].x,y:t[0].y+n}}}(b,y,w)):function(t,e,i){if(!t)return"";for(var n=t.length,r="",a=0;a<n;a++){var o=2*a+1,s=(2*a+2)%(2*n);if(r+=0==a?"M":"L",e){r+=e[o].x+" "+e[o].y+" ";var c=e[o].x-e[s].x,l=e[o].y-e[s].y,d=1/((c*c+l*l)/4)-1/(i*i),u=Math.sqrt(1/d);r+="A"+u+" "+u+" 0 0 0 "+e[s].x+" "+e[s].y+" "}else r+=t[a].x+" "+t[a].y+" "}return r+" Z "}(b,(f=function(t,e,i){if(!t)return{};if(e<=1e-4)return{};var n=[],r=t.length;e=Math.min(e,i/2);for(var a=0;a<r;a++){var o,c,l,d,u=t[a],h=t[(a+1)%r],p=t[a].side,f=(h.x-u.x)/p,g=(h.y-u.y)/p;o=u.x+f*e,c=u.y+g*e,l=h.x-f*e,d=h.y-g*e,o=Math.round(o*s)/s,c=Math.round(c*s)/s,l=Math.round(l*s)/s,d=Math.round(d*s)/s,n.push({x:o,y:c}),n.push({x:l,y:d})}return{points:n,radius:e}}(b,m,w)).points,f.radius)},l,d,p,e.id+"_"+t,e.get("opacity"))}if("line"==a){p=e.get("weight"),h=Math.round(r/2)+(p%2==1?.5:0);var S,P=[13*p/3,2*p/3].join(" "),k=p>1?[.001,5*p/3].join(" "):[1,2].join(" "),C=.5===p?"crispEdges":"auto",x="dotted"==e.get("stroke")?p/2:0;if(S="M"+x+" "+h+" L"+i+" "+h,"solid"==e.get("stroke")&&(o='<path d="'.concat(S,'" style="fill: none; stroke: ').concat(l,"; stroke-width: ").concat(p,'" shape-rendering="').concat(C,'" />')),"double"==e.get("stroke")){var O="M"+x+" "+(h+p)+" L"+i+" "+(h+p);o='<path d="'.concat("M"+x+" "+(h-p)+" L"+i+" "+(h-p),'" style="fill: none; stroke: ').concat(l,"; stroke-width: ").concat(p,';" shape-rendering="').concat(C,'"/>'),o+='<path d="'.concat(O,'" style="fill: none; stroke: ').concat(l,"; stroke-width: ").concat(p,'" shape-rendering="').concat(C,'"/>')}"dotted"==e.get("stroke")&&(o='<path d="'.concat(S,'" stroke-linecap="round" stroke-dasharray="').concat(k,'" style="fill: none; stroke: ').concat(l,"; stroke-width: ").concat(p,'"  shape-rendering="').concat(C,'"/>')),"dashed"==e.get("stroke")&&(o='<path d="'.concat(S,'" stroke-dasharray="').concat(P,'" style="fill: none; stroke: ').concat(l,"; stroke-width: ").concat(p,'" shape-rendering="').concat(C,'"/>'))}if("icon"==a){var T=this.iconData||this.current_icon_data;if(!T)return null;var _=T.$svg.clone();return _.css({width:"100%",height:"100%"}),l=this.getRGBA(c,1),_.find("*:not(.fixed-color)").each((function(){var t=(0,n.Z)(this);t.css({fill:"","fill-opacity":""}),t.get(0).removeAttribute("fill"),t.get(0).removeAttribute("fill-opacity")})),_.get(0).setAttribute("fill",l),_.get(0).setAttribute("fill-opacity",e.get("bg_opacity")),_}return'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+i+'px" height="'+r+'px">'+o+"</svg>";function Z(t,e,i,n,r,a,o){var s="mask_"+a,c="clip_"+a,l="",d=2;return r>0&&o>.99&&(d=1),l="<defs>",r>0&&(l+='<mask id="'+s+'">',"path"==t&&(l+='<path d="'+e.path+'" style="fill:white; stroke:black; stroke-width:'+r*d+'"/>'),"ellipse"==t&&(l+='<ellipse cx="'+e.cx+'" cy="'+e.cy+'" rx="'+e.rx+'" ry="'+e.ry+'" style="fill:white; stroke:black; stroke-width:'+r*d+'"/>'),l+="</mask>"),l+='<clippath id="'+c+'">',"path"==t&&(l+='<path d="'+e.path+'"/>'),"ellipse"==t&&(l+='<ellipse cx="'+e.cx+'" cy="'+e.cy+'" rx="'+e.rx+'" ry="'+e.ry+'"/>'),l+="</clippath>",l+="</defs>","path"==t&&(l+='<path mask="url(#'+s+')" d="'+e.path+'" style="fill:'+i+'; stroke:none; stroke-width:0; pointer-events: visiblePainted;"/>'),"ellipse"==t&&(l+='<ellipse mask="url(#'+s+')" cx="'+e.cx+'" cy="'+e.cy+'" rx="'+e.rx+'" ry="'+e.ry+'" style="fill:'+i+'; stroke:none; stroke-width:0; pointer-events: visiblePainted;"/>'),0==r||("path"==t&&(l+='<path clip-path="url(#'+c+')" d="'+e.path+'" style="fill:none; stroke:'+n+"; stroke-width:"+2*r+'; pointer-events: visiblePainted;"/>'),"ellipse"==t&&(l+='<ellipse clip-path="url(#'+c+')" cx="'+e.cx+'" cy="'+e.cy+'" rx="'+e.rx+'" ry="'+e.ry+'" style="fill:none; stroke:'+n+"; stroke-width:"+2*r+'; pointer-events: visiblePainted;"/>')),l}},getRGBA:function(t,e){if(0==e)return"none";var i=[parseInt(t.substring(0,2),16),parseInt(t.substring(2,4),16),parseInt(t.substring(4,6),16)];return e>.99?"rgb("+i[0]+","+i[1]+","+i[2]+")":"rgba("+i[0]+","+i[1]+","+i[2]+", "+e+")"}},e.Z=r},979:function(t,e,i){"use strict";var n=i(312),r=i(321),a=function(){};a.prototype={text_viewport_attributes:["style","class","data-size-leading-linked","data-size-leading-ratio","data-anchor-link-pos"],switchTextToViewport:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;if("default"===e)return t;var i=(0,n.Z)("<div>").html(t),a=this.text_viewport_attributes,o=this;i.find("*").each((function(){var t=(0,n.Z)(this);r.Z.each(a,(function(i){var n=o.getViewportAttributeName(i,e),r=o.getViewportAttributeName(i,"default"),a=t.attr(n),s=t.attr(i);t.removeAttr(r),s&&t.attr(r,s),a&&("empty"===a?t.removeAttr(i):t.attr(i,a))}))}));var s=i.html();return i.empty().remove(),s},getViewportAttributeName:function(t,e){var i=t+"-"+e;return/^data/.test(i)||(i="data-"+i),i}},e.Z=a},348:function(t,e,i){"use strict";i.d(e,{Z:function(){return b}});var n,r,a,o,s=i(312),c=i(321),l=i(308),d=i(340),u=i(343),h=i(349);function p(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function f(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var g=(p(o={},"template-export-pdf-typekit-substitution-news-gothic",(0,h.f)(n||(n=f(['\n<style id="export-pdf-typekit-substitution">\n@font-face {\n\tfont-family: "<%=id%>";\n\tsrc: url("/fonts/webtype/News Gothic Bold Italic/c6f4e54e-1d69-4559-b813-e2fc4ff29160-3.woff") format("woff"),\n\t\t url("/fonts/webtype/News Gothic Bold Italic/c6f4e54e-1d69-4559-b813-e2fc4ff29160-4.svg#web") format("svg");\n\tfont-style: italic;\n\tfont-weight: 700;\n}\n@font-face {\n\tfont-family: "<%=id%>";\n\tsrc: url("/fonts/webtype/News Gothic Bold/9aab62b7-bc6f-405a-ad75-227bcf89d9dc-3.woff") format("woff"),\n\t\t url("/fonts/webtype/News Gothic Bold/9aab62b7-bc6f-405a-ad75-227bcf89d9dc-4.svg#web") format("svg");\n\tfont-style: normal;\n\tfont-weight: 700;\n}\n@font-face {\n\tfont-family: "<%=id%>";\n\tsrc: url("/fonts/webtype/News Gothic Italic/6327ba72-bfd5-4038-9658-e3a4a95a5c98-3.woff") format("woff"),\n\t\t url("/fonts/webtype/News Gothic Italic/6327ba72-bfd5-4038-9658-e3a4a95a5c98-4.svg#web") format("svg");\n\tfont-style: italic;\n\tfont-weight: 400;\n}\n@font-face {\n\tfont-family: "<%=id%>";\n\tsrc: url("/fonts/webtype/News Gothic/915b0ec4-cd16-40de-883e-1d77c3d07840-3.woff") format("woff"),\n\t\t url("/fonts/webtype/News Gothic/915b0ec4-cd16-40de-883e-1d77c3d07840-4.svg#web") format("svg");\n\tfont-style: normal;\n\tfont-weight: 400;\n}\n</style>\n'])))),p(o,"template-export-pdf-typekit-substitution-georgia-pro",(0,h.f)(r||(r=f(['\n<style id="export-pdf-typekit-substitution">\n@font-face {\n\tfont-family: "<%=id%>";\n\tsrc: url("/fonts/webtype/Georgia Pro Black/4ec59c91-f66b-4751-8456-e114e9e14673-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Georgia Pro Black/4ec59c91-f66b-4751-8456-e114e9e14673-4.svg#web") format("svg");\n\tfont-style: normal;\n\tfont-weight: 900;\n}\n@font-face {\n\tfont-family: "<%=id%>";\n\tsrc: url("/fonts/webtype/Georgia Pro Bold Italic/6f283590-c3c2-416a-95c2-ca67d04aa929-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Georgia Pro Bold Italic/6f283590-c3c2-416a-95c2-ca67d04aa929-4.svg#web") format("svg");\n\tfont-style: italic;\n\tfont-weight: 700;\n}\n@font-face {\n\tfont-family: "<%=id%>";\n\tsrc: url("/fonts/webtype/Georgia Pro Bold/6f633c58-c751-4d08-9cea-2b27f74f37de-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Georgia Pro Bold/6f633c58-c751-4d08-9cea-2b27f74f37de-4.svg#web") format("svg");\n\tfont-style: normal;\n\tfont-weight: 700;\n}\n@font-face {\n\tfont-family: "<%=id%>";\n\tsrc: url("/fonts/webtype/Georgia Pro Italic/e3bc0ad4-bdaa-4467-82a0-d90f697b7266-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Georgia Pro Italic/e3bc0ad4-bdaa-4467-82a0-d90f697b7266-4.svg#web") format("svg");\n\tfont-style: italic;\n\tfont-weight: 400;\n}\n@font-face {\n\tfont-family: "<%=id%>";\n\tsrc: url("/fonts/webtype/Georgia Pro SemiBold Italic/0e025df5-ba54-4bbb-84b4-c5b337a5b55b-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Georgia Pro SemiBold Italic/0e025df5-ba54-4bbb-84b4-c5b337a5b55b-4.svg#web") format("svg");\n\tfont-style: italic;\n\tfont-weight: 600;\n}\n@font-face {\n\tfont-family: "<%=id%>";\n\tsrc: url("/fonts/webtype/Georgia Pro SemiBold/60fe12ce-0223-4a9a-8e5c-b3e7bd381bc4-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Georgia Pro SemiBold/60fe12ce-0223-4a9a-8e5c-b3e7bd381bc4-4.svg#web") format("svg");\n\tfont-style: normal;\n\tfont-weight: 600;\n}\n@font-face {\n\tfont-family: "<%=id%>";\n\tsrc: url("/fonts/webtype/Georgia Pro/b97bef32-c0cb-4ad3-b724-1204d229731c-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Georgia Pro/b97bef32-c0cb-4ad3-b724-1204d229731c-4.svg#web") format("svg");\n\tfont-style: normal;\n\tfont-weight: 400;\n}\n</style>\n'])))),p(o,"template-export-pdf-typekit-substitution-nitti",(0,h.f)(a||(a=f(['\n<style id="export-pdf-typekit-substitution">\n@font-face {\n\tfont-family: "<%=id%>";\n\tsrc: url("/fonts/webtype/Nitti Light Italic/15aba0ec-4ceb-49e2-985c-a95134a60aed-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Nitti Light Italic/15aba0ec-4ceb-49e2-985c-a95134a60aed-4.svg#web") format("svg");\n\tfont-style: italic;\n\tfont-weight: 300;\n}\n@font-face {\n\tfont-family: "<%=id%>";\n\tsrc: url("/fonts/webtype/Nitti Light/6fd7c5e9-3131-4cb6-a99e-da74343b1253-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Nitti Light/6fd7c5e9-3131-4cb6-a99e-da74343b1253-4.svg#web") format("svg");\n\tfont-style: normal;\n\tfont-weight: 300;\n}\n@font-face {\n\tfont-family: "<%=id%>";\n\tsrc: url("/fonts/webtype/Nitti Medium/9054f262-2d2d-480f-9360-4560f110243b-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Nitti Medium/9054f262-2d2d-480f-9360-4560f110243b-4.svg#web") format("svg");\n\tfont-style: normal;\n\tfont-weight: 500;\n}\n</style>\n'])))),o),m=i(350),v=i(351),y={STYLE_PREFIXES:{paragraph:{viewer:[".used-fonts-test p",".rmwidget.text div p"],editor:["p"],constructor:[".used-fonts-test p",".block.block-text .text-preview p",".controls .control.text_styles .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .paragraph-style .style-caption"]},"header-h1":{viewer:[".used-fonts-test h1",".rmwidget.text div h1"],editor:["h1"],constructor:[".used-fonts-test h1",".block.block-text .text-preview h1",".controls .control.text_styles .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .paragraph-style .style-caption"]},"header-h2":{viewer:[".used-fonts-test h2",".rmwidget.text div h2"],editor:["h2"],constructor:[".used-fonts-test h2",".block.block-text .text-preview h2",".controls .control.text_styles .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .paragraph-style .style-caption"]},"header-h3":{viewer:[".used-fonts-test h3",".rmwidget.text div h3"],editor:["h3"],constructor:[".used-fonts-test h3",".block.block-text .text-preview h3",".controls .control.text_styles .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .paragraph-style .style-caption"]},"header-h4":{viewer:[".used-fonts-test h4",".rmwidget.text div h4"],editor:["h4"],constructor:[".used-fonts-test h4",".block.block-text .text-preview h4",".controls .control.text_styles .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .paragraph-style .style-caption"]},link:{viewer:[".rmwidget.text div a"],editor:["a"],constructor:[".block.block-text .text-preview a",".controls .control.text_link .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .link-style .style-caption"]}},fontsShortList:{},generateStylesStr:function(t){var e,i,n,r="",a=t.style,o=t.indentation?"\t":"",s=";"+(t.lineBreaks?"\n":""),c=t.attrPrefix||"";return"paragraph"==t.tp&&(r+=o+"font-family: "+l("font-family")+s,r+=o+"font-style: "+l("font-style")+s,r+=o+"font-weight: "+l("font-weight")+s,r+=o+"font-size: "+u(l("font-size"))+s,r+=o+"letter-spacing: "+u(l("letter-spacing"))+s,r+=o+"line-height: "+u(l("line-height"))+s,r+=o+"text-align: "+l("text-align")+s,r+=o+"text-decoration: "+l("text-decoration")+s,r+=o+"text-transform: "+l("text-transform")+s,r+=o+"color: "+d.default.getRGBA(l("color"),l("opacity")/100)+s,r+=o+"padding-top: "+u(l("padding-top"))+s,r+=o+"padding-right: "+u(l("padding-right"))+s,r+=o+"padding-bottom: "+u(l("padding-bottom"))+s,r+=o+"padding-left: "+u(l("padding-left"))+s),"link"==t.tp&&(r+=o+"text-decoration: none"+s,r+=o+"color: "+d.default.getRGBA(l("color"),l("opacity")/100)+s,"none"!=l("u-style")?(e=d.default.getRGBA(l("u-color"),l("u-opacity")/100),i=parseInt(l("u-size"),10),n=parseInt(l("u-offset"),10)+i,r+=o+"padding-bottom: "+u(Math.max(n,0))+s,"solid"==l("u-style")&&(r+=o+"background: linear-gradient(to right, "+e+" 0%, "+e+" 100%)"+s,r+=o+"background-size: 1px "+u(i)+s),"dotted"==l("u-style")&&(r+=o+"background: linear-gradient(to right, "+e+" 0%, "+e+" 50%, transparent 50%,transparent 100%)"+s,r+=o+"background-size: "+u(2*i)+" "+u(i)+s),"dashed"==l("u-style")&&(r+=o+"background: linear-gradient(to right, "+e+" 0%, "+e+" 66.6666%, transparent 66.6666%,transparent 100%)"+s,r+=o+"background-size: "+u(3*i)+" "+u(i)+s),r+=n<0?o+"background-position: 0 "+(100+n)+"%"+s:o+"background-position: 0 100%"+s,r+=o+"background-repeat: repeat-x"+s):r+=o+"background: none"+s),r;function l(t){var e=a[c+t];return"inherit"==e&&c&&(e=a[t]),e}function u(t){return t+(/px/i.test(t)?"":"px")}},generateCSS:function(t,e,i,n,r){if(n){var a=this.STYLE_PREFIXES[t][e],o=(r=r||{},this),d="";c.Z.each(n,(function(i){if("paragraph"==t&&(i.tag&&"p"!==i.tag&&l.ZP.AVAILABLE_TEXT_TAGS.includes(i.tag)&&(a=[].concat(o.STYLE_PREFIXES["header-"+i.tag][e],o.STYLE_PREFIXES[t][e]).filter((function(t,e,i){return i.indexOf(t)===e}))),d+=c.Z.map(a,(function(t){return t+"."+i._name})).join(",\n")+" {\n",d+=o.generateStylesStr({tp:t,style:i,indentation:!0,lineBreaks:!0}),d+="}\n\n"),"link"==t){if(r.forcePseudoState&&r.forcePseudoClass==i._name)d+=c.Z.map(a,(function(t){return t+"."+i._name})).join(",\n")+" {\n",d+=o.generateStylesStr({tp:t,style:i,attrPrefix:r.forcePseudoState+"-",indentation:!0,lineBreaks:!0}),d+="}\n\n";else d+=c.Z.map(a,(function(t){return t+"."+i._name})).join(",\n")+" {\n",d+=o.generateStylesStr({tp:t,style:i,indentation:!0,lineBreaks:!0}),d+="}\n\n",c.Z.find(c.Z.keys(i),(function(t){return/^current/.test(t)}))&&(d+=c.Z.map(a,(function(t){return t+".current."+i._name})).join(",\n")+" {\n",d+=o.generateStylesStr({tp:t,style:i,attrPrefix:"current-",indentation:!0,lineBreaks:!0}),d+="}\n\n"),d+=c.Z.map(a,(function(t){return t+".hovered."+i._name})).join(",\n")+" {\n",d+=o.generateStylesStr({tp:t,style:i,attrPrefix:"hover-",indentation:!0,lineBreaks:!0}),d+="}\n\n";d+=c.Z.map(a,(function(t){return t+"."+i._name+" *"})).join(",\n")+" {\n",d+="\tcolor: inherit !important;\n",d+="\ttext-decoration: none !important;\n",d+="}\n\n"}})),i=i||document;var u="text_styles_"+t+"_"+e;(0,s.Z)("#"+u,i).remove();var h=i.createElement("style");h.type="text/css",h.id=u,h.className="text_styles",h.appendChild(i.createTextNode(d)),i.getElementsByTagName("head")[0].appendChild(h)}},appendFontsCssToDocument:function(t,e){window.TypekitPreview&&window.TypekitPreview.setup&&window.TypekitPreview.setup({auth_id:l.ZP.TYPEKIT_ID,auth_token:l.ZP.TYPEKIT_TOKEN,default_subset:"all"});var i,n=(0,s.Z)("link.fonts, style.fonts"),r=[],a=[],o={};n.each((function(){var t=(0,s.Z)(this),e=t.attr("data-provider"),i=t.attr("data-fonts-and-variations").split("||");c.Z.each(i,(function(t){r.push(e+"|"+t)}))})),c.Z.each(t.fonts,(function(t){c.Z.each(t.used_variations||t.variations,(function(e){a.push(t.provider+"|"+t.css_name+"|"+e)}))})),i=c.Z.difference(a,r);var u={};c.Z.each(i,(function(t){var e=t.split("|"),i=e[0],n=e[1],r=e[2],a=i+"|"+n;u[a]=u[a]||[],u[a].push(r)}));var h=[];c.Z.each(u,(function(t,e){var i=e.split("|"),n=i[0],r=i[1],a=t;h.push({provider:n,css_name:r,variations:a})})),c.Z.each(h,(function(e){var i,n=e.provider,r=e.css_name+"|"+e.variations.join("||"+e.css_name+"|");if(o[n]||(o[n]=[]),"google"==n){var a=s.Z.map(e.variations,(function(t){return 100*(t.substr(1,1)-0)+("n"==t.substr(0,1)?"":"italic")}));i={fontAndVariations:r,data:e.css_name.split(" ").join("+")+":"+a.join(",")}}if("webtype"==n&&(i={fontAndVariations:r,data:e.css_name+":"+e.variations.join(",")}),"typetoday"==n&&(i={fontAndVariations:r,data:e.css_name+":"+e.variations.join(",")}),"custom"==n){var l=c.Z.findWhere(t.fonts,{provider:"custom",css_name:e.css_name});l&&l.css_url&&(i={fontAndVariations:r,data:{css_name:e.css_name,css_url:l.css_url,signed_css_url:l.signed_css_url}})}"typekit"==n&&(i={fontAndVariations:r,data:{id:e.css_name,variations:e.variations}}),i&&o[n].push(i)}));var p=RM.screenshot&&"true"==d.default.queryUrlGetParam("pdf");p&&this.loadTypekitSubstitutionFonts(o.typekit);var f=c.Z.has(o,"custom");function g(t){var e=(0,s.Z)("<link>").attr("type","text/css").attr("rel","stylesheet").attr("href",t);(0,s.Z)("head").append(e)}c.Z.each(o,(function(i,n){var r,a,o,u,h,f,m="custom"==n?1:"google"==n?22:i.length,v=Math.ceil(i.length/m),y=0,b=function(){if(a=r*m,o=Math.min((r+1)*m,i.length),u=i.slice(a,o),h=c.Z.pluck(u,"data"),f=c.Z.pluck(u,"fontAndVariations"),(0,s.Z)("link, style").addClass("existing"),"google"==n&&(S=(l.ZP.IS_FILE_PROTOCOL?"http://":"//")+"fonts.googleapis.com/css?family=",w=h.join("%7C"),"&subset=latin,vietnamese,khmer,cyrillic-ext,greek-ext,greek,devanagari,latin-ext,cyrillic",g(S+w+"&subset=latin,vietnamese,khmer,cyrillic-ext,greek-ext,greek,devanagari,latin-ext,cyrillic")),"typekit"==n){if("edit"==t.version&&!p)try{window.TypekitPreview&&window.TypekitPreview.load(h)}catch(t){}"published"==t.version&&t.typekit_url&&("undefined"!=typeof Typekit&&(Typekit=void 0),(0,s.Z)("style.typekit-kit").remove(),s.Z.getScript(t.typekit_url,(function(t,e,i){try{Typekit.load({active:function(){var t=(0,s.Z)("style").filter((function(t,e){return/typekit/i.test(e.innerHTML)}));t.addClass("typekit-kit"),b(t)}})}catch(t){}})))}var v;function b(t){t.addClass("fonts").attr("data-id",d.default.generateUUID()).attr("data-provider",n).attr("data-fonts-and-variations",f.join("||"))}"webtype"==n&&(S=RM.common.isDownloadedSource?l.ZP.readymag_host:"",(0,s.Z)('link.fonts[data-provider="webtype"]').length||(P=window.ServerData&&window.ServerData.fonts&&window.ServerData.fonts.webtype,g(S+P))),"typetoday"!=n||p||(S=RM.common.isDownloadedSource?l.ZP.readymag_host:"",(0,s.Z)('link.fonts[data-provider="typetoday"]').length||(P=window.ServerData&&window.ServerData.fonts&&window.ServerData.fonts.typetoday,g(S+P))),"custom"==n&&(k=h[0].signed_css_url||h[0].css_url,/^\/api\/fonts\//i.test(k)?(v=(0,s.Z)("<style>").attr("type","text/css"),(0,s.Z)("head").append(v),s.Z.get(k,(function(t){v.text(t),++y>=i.length&&c.Z.isFunction(e)&&e()}))):g(k)),b((0,s.Z)("link:not(.existing), style:not(.existing)")),(0,s.Z)("link, style").removeClass("existing")};for(r=0;r<v;r++){var w,S,P,k;b()}})),!f&&c.Z.isFunction(e)&&e()},loadTypekitSubstitutionFonts:function(t){t&&t.length&&c.Z.each(t,(function(t){var e,i=t.data.id,n=(t.data.variations,(e=(e=(e=c.Z.findWhere(y.fontsShortList.typekit,{id:i}))&&e.browse_info)&&e.classification)&&e.length&&e[0]||"sans-serif"),r={"sans-serif":"news-gothic",decorative:"news-gothic",handmade:"news-gothic",blackletter:"news-gothic",script:"news-gothic","slab-serif":"news-gothic",serif:"georgia-pro",monospaced:"nitti"},a=(0,g["template-export-pdf-typekit-substitution-"+(r[n]||r["sans-serif"])])({id:i});(0,s.Z)("head").append(a)}))},appendFontsCssToIFrame:function(t){var e=(0,s.Z)("link.fonts, style.fonts"),i=(0,s.Z)("link.fonts, style.fonts",t),n={},r=(0,s.Z)("head",t);i.each((function(){n[(0,s.Z)(this).attr("data-id")]=!0})),e.each((function(){var t=(0,s.Z)(this),e=this.href;if(!n[t.attr("data-id")]){var i=t.clone();e&&Modernizr.safari&&i.attr("href",e+"&edit_mode=true"),i.appendTo(r)}}))},isFastFontLoadCheckAvailable:function(){return Boolean(document.fonts&&window.Promise)},fastWaitForFontLoad:function(t,e,i){var n;if(document.fonts){var r=i+" "+e+" 12px "+t,a=(0,m._)("viewer.simpleFontLoadCheck")?document.fonts.load(r):document.fonts.load(r).then(function(){return document.fonts.check(r)?r:this.fontLoadedTimeoutCheck(r)}.bind(this)),o=new window.Promise((function(t,e){setTimeout(e.bind(null,r),3500)}));n=window.Promise.race([a,o])}else n=window.Promise.reject();return n},exactWaitForFontLoad:function(t,e,i,n){var r=i+" "+e+" 12px "+t+", Arial",a=i+" "+e+" 12px Arial",o=(0,s.Z)('<canvas width="20" height="20"></canvas>'),c=o[0],l=c.getContext("2d"),d="",u="",h=+new Date;o.appendTo("body").css({position:"absolute",left:0,top:"-999px"}),function s(){var p=+new Date-h>1e4,f=function(){var t=r;l.clearRect(0,0,20,20),d||(d=c.toDataURL("image/png"),t=a);l.font=t,l.fillStyle="000",l.fillText("a1-&q",0,20);var e=c.toDataURL("image/png");u||(u=e);return e!=d&&e!=u}();if(f||p)return l=void 0,o.remove(),void n(f,t,e,i);setTimeout(s,100)}()},fontLoadedTimeoutCheck:function(t){var e=Date.now(),i=function i(n,r){var a=Date.now()-e;document.fonts.check(t)?n(t):a<3500?setTimeout(i.bind(null,n,r),100):r(t)};return new window.Promise((function(t,e){i(t,e)}))},getHotspotTextModels:function(t){var e=[];return t.widgets_collection&&t.widgets_collection.length&&(e=t.widgets_collection.filter((function(e){return"text"==e.get("type")&&t.get("wids").indexOf(e.get("_id"))>-1}))),t._nestedWidgetsJSON&&t._nestedWidgetsJSON.length?e=c.Z.filter(t._nestedWidgetsJSON,(function(t){return"text"==t.type})):t.wids&&t.wids.length&&(e=c.Z.filter(t.wids,(function(t){return"text"==t.type}))),e},getUsedFontsFromWidgetsModels:function(t){var e={},i={},n={},r={},a={},o={},s=t.models;function d(t,e){return"function"==typeof t.get?t.get(e):t[e]}for(var h=0;h<s.length;h++){var p=s[h];if("slideshow"==d(p,"type")&&d(p,"text_style")){var f=d(p,"text_style");f["font-family"]&&f["font-weight"]&&f["font-style"]&&(i[f["font-family"]+"|"+f["font-style"]+"|"+f["font-weight"]]=1)}if("button"==d(p,"type")){d(p,"font-family")&&d(p,"font-weight")&&d(p,"font-style")&&(n[d(p,"font-family")+"|"+d(p,"font-style")+"|"+d(p,"font-weight")]=1);for(var g=0;g<u.ZP.viewports.length;g++){var m=p["viewport_"+u.ZP.viewports[g].name];m&&(n[m["font-family"]+"|"+m["font-style"]+"|"+m["font-weight"]]=1)}}if(d(p,"type")===l.ZP.ecommerceCartBlockName&&d(p,"font-family")&&d(p,"font-weight")&&d(p,"font-style")&&(a[d(p,"font-family")+"|"+d(p,"font-style")+"|"+d(p,"font-weight")]=1),d(p,"type")===l.ZP.addToCartBlockName&&(d(p,"font-family")&&d(p,"font-weight")&&d(p,"font-style")&&(o[d(p,"font-family")+"|"+d(p,"font-style")+"|"+d(p,"font-weight")]=1),d(p,"attrs-font-family")&&d(p,"attrs-font-weight")&&d(p,"attrs-font-style")&&(o[d(p,"attrs-font-family")+"|"+d(p,"attrs-font-style")+"|"+d(p,"attrs-font-weight")]=1)),"form"==d(p,"type")){var b=d(p,"style-"+d(p,"style")+"-fields"),w=c.Z.clone(d(p,"style-"+d(p,"style")+"-button-default"));c.Z.isEmpty(w)||(w["font-family"]="inherit"==w["font-family"]?b["font-family"]:w["font-family"],w["font-style"]="inherit"==w["font-style"]?b["font-style"]:w["font-style"],w["font-weight"]="inherit"==w["font-weight"]?b["font-weight"]:w["font-weight"]),r[b["font-family"]+"|"+b["font-style"]+"|"+b["font-weight"]]=1,w&&(r[w["font-family"]+"|"+w["font-style"]+"|"+w["font-weight"]]=1);for(var S=0;S<u.ZP.viewports.length;S++){var P=p["viewport_"+u.ZP.viewports[S].name];P&&(b=P["style-"+P.style+"-fields"],w=c.Z.clone(P["style-"+P.style+"-button-default"]),c.Z.isEmpty(w)||(w["font-family"]="inherit"==w["font-family"]?b["font-family"]:w["font-family"],w["font-style"]="inherit"==w["font-style"]?b["font-style"]:w["font-style"],w["font-weight"]="inherit"==w["font-weight"]?b["font-weight"]:w["font-weight"]),b&&(r[b["font-family"]+"|"+b["font-style"]+"|"+b["font-weight"]]=1),w&&(r[w["font-family"]+"|"+w["font-style"]+"|"+w["font-weight"]]=1))}}"text"===d(p,"type")&&3===d(p,"version")&&c.Z.extend(e,v.Z.getTextWidgetFontsList(p,t.activeViewports)),"text"===d(p,"type")&&d(p,"text")&&3!==d(p,"version")&&c.Z.extend(e,this.scanTextForFontsAndVariationsRaw(d(p,"text"),d(p,"version"),t.excludeUnusedDefault,t.activeViewports)),"hotspot"==d(p,"type")&&c.Z.each(this.getHotspotTextModels(p),c.Z.bind((function(i){var n=d(i,"text");n&&c.Z.extend(e,this.scanTextForFontsAndVariationsRaw(n,d(i,"version"),t.excludeUnusedDefault))}),this))}var k=c.Z.extend({},e,i,n,r,a,o),C={},x={bold:700,normal:400};c.Z.each(k,(function(t,e){var i=e.split("|"),n=i[0],r=i[1].toLowerCase(),a=i[2].toLowerCase(),o=a in x?x[a]:a;C[n]=C[n]||[],C[n].push("variable"===o?"v":("italic"===r?"i":"n")+Math.floor(o/100))}));var O,T=[],_=this;return c.Z.each(C,(function(e,i){(O=c.Z.findWhere(y.fontsShortList.webtype,{name:i}))?T.push({provider:"webtype",css_name:O.name,name:O.name,variations:O.variations,used_variations:_.calcBrowserUsedVariation(e,O.variations)}):(O=c.Z.findWhere(y.fontsShortList.typetoday,{name:i}))?T.push({provider:"typetoday",css_name:O.name,name:O.name,variations:O.variations,used_variations:_.calcBrowserUsedVariation(e,O.variations)}):(O=c.Z.findWhere(y.fontsShortList.google,{family:i}))?T.push({provider:"google",css_name:O.family,name:O.family,variations:O.variations,used_variations:_.calcBrowserUsedVariation(e,O.variations)}):(O=c.Z.findWhere(y.fontsShortList.typekit,{id:i}))?T.push({provider:"typekit",css_name:O.id,name:O.name,variations:O.variations,used_variations:_.calcBrowserUsedVariation(e,O.variations)}):t.includeCustom&&(O=c.Z.findWhere(t.customList,{css_name:i}))&&T.push({provider:"custom",css_name:O.css_name,css_url:O.css_url,name:O.name,variations:O.variations,used_variations:_.calcBrowserUsedVariation(e,O.variations)})})),T.filter((function(t){return t.used_variations&&t.used_variations.length>0}))},getUsedParagraphStylesFromWidgetsModels:function(t){var e,i,n="";for(e=0;e<t.length;e++)"text"==s(i=t[e],"type")&&s(i,"text")&&(n+=s(i,"text")),"hotspot"==s(i,"type")&&c.Z.each(this.getHotspotTextModels(i),c.Z.bind((function(t){n+=s(t,"text")||""}),this));var r=[],a=RM.constructorRouter.workspace.mag.edit_params.get("paragraph_styles");if(n)for(e=0;e<a.length;e++){var o=a[e];n.indexOf(o._name)>=0&&r.push(o)}function s(t,e){return"function"==typeof t.get?t.get(e):t[e]}return r},getUsedLinkStylesFromWidgetsModels:function(t){var e,i,n="";for(e=0;e<t.length;e++)"text"==s(i=t[e],"type")&&s(i,"text")&&(n+=s(i,"text")),"hotspot"==s(i,"type")&&c.Z.each(this.getHotspotTextModels(i),c.Z.bind((function(t){n+=s(t,"text")||""}),this));var r=[],a=RM.constructorRouter.workspace.mag.edit_params.get("link_styles");if(n)for(e=0;e<a.length;e++){var o=a[e];n.indexOf(o._name)>=0&&r.push(o)}function s(t,e){return"function"==typeof t.get?t.get(e):t[e]}return r},sortFontsByProvider:function(t){var e=[],i=[],n={};return c.Z.each(t,(function(t){"typekit"===t.provider&&e.push({id:t.css_name,variations:t.used_variations}),"custom"===t.provider&&i.push(t.css_name);var r="used_"+t.provider+"_fonts";n[r]=n[r]||[],"custom"===t.provider?n[r].push(t.css_name):n[r].push({id:t.css_name,variations:t.used_variations})})),{typekit:e,custom:i,dictionary:n}},scanTextForFontsAndVariationsRaw:function(t,e,i,n){var r,a,o,l,d,h,p,f,g,m,v={},y={},b=[],w=document.defaultView.getComputedStyle;for(r=0;r<u.ZP.viewports.length;r++)if(t.split("-"+u.ZP.viewports[r].name).length>1){if(n&&-1===n.indexOf(u.ZP.viewports[r].name))continue;b.push(u.ZP.viewports[r].name)}(o=(0,s.Z)(".used-fonts-test")).length||(o=(0,s.Z)("<div>").addClass("used-fonts-test").css({position:"absolute",display:"none !important",left:-9999,width:999}).appendTo("body")),o.removeClass("v1 v2").addClass("v"+(e||1)),(a=o[0]).innerHTML=t,h=(d=a.querySelectorAll("span,p,a")).length;var S,P=(l=w(a,null)).fontFamily+"|"+l.fontStyle+"|"+l.fontWeight;v[P]=1;for(var k=!1,C=function(t){return-1!==c.Z.findIndex(t.childNodes,(function(t){return t.nodeType===Node.TEXT_NODE&&t.textContent.replace(/\r?\n/g,"").length}))},x=c.Z.filter(d,C),O=0;O<x.length;O++)S=(l=w(x[O],null)).fontFamily+"|"+l.fontStyle+"|"+l.fontWeight,k=k||S===P,v[l.fontFamily+"|"+l.fontStyle+"|"+l.fontWeight]=1;var T=C(a);for(r=0;r<b.length;r++)if("default"!=(g=b[r])){for(O=0;O<h;O++)(p=(m=d[O]).getAttribute("data-style-"+g))&&("empty"==p?m.removeAttribute("style"):m.setAttribute("style",p)),(f=m.getAttribute("data-class-"+g))&&("empty"==f?m.removeAttribute("class"):m.setAttribute("class",f)),C(m)&&(S=(l=w(m,null)).fontFamily+"|"+l.fontStyle+"|"+l.fontWeight,k=k||S===P,v[S]=1);r<b.length-1&&(a.innerHTML=t,h=(d=a.querySelectorAll("span,p,a")).length)}return!i||k||T||delete v[P],c.Z.each(v,(function(t,e){var i=e.split("|"),n=i[0],r=i[1].toLowerCase(),a=i[2].toLowerCase();n=(n=n.split(",")[0]).replace(/'|"/g,""),a=(a=(a=a.replace(/normal/g,"400")).replace(/regular/g,"400")).replace(/bold/g,"700"),y[n+"|"+r+"|"+a]=1})),y},calcBrowserUsedVariation:function(t,e){for(var i={},n=0;n<t.length;n++){for(var r,a,o,s=t[n],l=s.substr(1,1),d=s.substr(0,1),u=99999,h="",p=0;p<e.length;p++)r=e[p].substr(1,1)-0,a=e[p].substr(0,1),l<4&&(o=10*Math.abs(r-l)+(a==d?0:1e3)+(r<=l?0:100)),l>5&&(o=10*Math.abs(r-l)+(a==d?0:1e3)+(r>=l?0:100)),4==l&&(o=5==r?0+(a==d?0:1e3)+0:10*Math.abs(r-l)+(a==d?0:1e3)+(r<=l?0:100)),5==l&&(o=10*Math.abs(r-l)+(a==d?0:1e3)+(r<=l?0:100)),l==r&&d==a&&(o=0),o<u&&(u=o,h=e[p]);i[h]=1}return c.Z.keys(i).filter((function(t){return!!t}))},getVeryShortList:function(t){var e={google:[],typekit:[],webtype:[],typetoday:[]};return c.Z.each(t,(function(t){var i,n=t.provider;switch(n){case"google":i={provider:n,family:t.name,variations:t.variations};break;case"typekit":i={provider:n,id:t.css_name,name:t.name,variations:t.variations};break;case"webtype":case"typetoday":i={provider:n,name:t.name,variations:t.variations}}e[n]&&e[n].push(i)})),e},getCustomVariationNameByFVD:function(t,e){return(y.fontCustomVariationNames[t]||{})[e]},setShortList:function(t){y.fontsShortList=t||{},y.fontCustomVariationNames={},c.Z.each(y.fontsShortList,(function(t,e){c.Z.each(t,(function(t){if(t.custom_variation_names){var i;switch(e){case"google":i=t.family;break;case"typekit":case"webtype":case"typetoday":i=t.name}y.fontCustomVariationNames[i]=t.custom_variation_names}}))}))}};window.fontsShortListCallback=function(t){y.setShortList(t)};var b=y},944:function(t,e,i){"use strict";var n=i(312),r=i(340),a={getVideoAspectFromPoster:function(t,e){var i={abort:function(){u.onload=null,u.onerror=null}},r={aspect_poster:null,aspect_real:null};if(!t)return e(r),i;var a,o,s,c,l,d,u=new Image;return u.onload=function(){l=u.width,d=u.height,s=200,c=Math.floor(s*(d/l)),a=(0,n.Z)('<canvas id="qqq" width="200" height="'+c+'"></canvas>').css("visibility","hidden").appendTo("body"),(o=a[0].getContext("2d")).drawImage(u,0,0,s,c);var t,i,h=o.getImageData(0,0,s,c),p=0,f=0,g=0,m=0;for(i=0;i<=c/2;i++){if(w(i,"row").isContrast){(i<=1||w(i-1,"row").isBlack||w(i-2,"row").isBlack)&&(p=i);break}}for(i=c-1;i>c/2;i--){if(w(i,"row").isContrast){(i>=c-2||w(i+1,"row").isBlack||w(i+2,"row").isBlack)&&(f=c-1-i);break}}var v=Math.max(p,f),y=0;if(!v){for(t=0;t<=100;t++){if(w(t,"column").isContrast){(t<=1||w(t-1,"column").isBlack||w(t-2,"column").isBlack)&&(g=t);break}}for(t=199;t>100;t--){if(w(t,"column").isContrast){(t>=198||w(t+1,"column").isBlack||w(t+2,"column").isBlack)&&(m=199-t);break}}y=Math.max(m,g)}v>c/3&&(v=0),y>s/3&&(y=0);var b=l/d;function w(t,e){var i,n,r,a,o,l="row"==e?s:c,d=0,u=0;for(i=0;i<l;i++)n=("row"==e?t*s+i:i*s+t)<<2,d+=(r=h.data[n])+(a=h.data[n+1])+(o=h.data[n+2]),r<20&&a<20&&o<20&&u++;return{isBlack:(d/=3*l)<5&&l-u<3,isContrast:u<l/2}}v?b=s/(c-2*v):y&&(b=(s-2*y)/c),a.remove(),r.aspect_poster=l/d,r.aspect_real=b,e(r)},u.onerror=function(){e(r)},u.src="/api/proxy/?url="+encodeURIComponent(t),i},setVideoPosition:function(t){if(t.aspect_poster&&t.$media&&t.$media.length){var e=t.$container.css("width"),i=t.$container.css("height");if(/px/.test(e+i))e=parseInt(e),i=parseInt(i);else{if(!t.mag)return;var n=t.mag.getContainerSizeCached();e=n.width,i=n.height}var r,a,o=t.aspect_poster,s=t.aspect_real||o,c=t.controls_remove?5:0,l=e+2*c,d=i+2*c,u=l,h=d;if(o)l/d>s?a=(r=l)/s:r=(a=d)*s,o<s?h=(u=r)/o:u=(h=a)*o;if("vimeo"==t.provider.toLowerCase()&&t.controls_remove){var p=50-(h-d)/2,f=46-(u-l)/2;if(p>0||f>0){var g=(h+2*p)/h,m=(u+2*f)/u,v=Math.max(g,m);u*=v,h*=v}}if("youtube"==t.provider.toLowerCase()&&t.controls_remove){var y=103-(h-d)/2;y>0&&(u=(h+=2*y)*o)}var b=-c-(u-l)/2,w=-c-(h-d)/2;t.$media.css({left:b,top:w,width:u,height:h})}},getHighResVideoThumbnail:function(t){if(!t.provider||!t.thumbnail_url)return Promise.resolve(t.thumbnail_url||"");function e(t,e){return t.replace(/(\/)(\w*default)(\.\w+$)/i,"$1"+e+"$3")}function i(t,e){return t.replace(/(\/)(\w+_)(\d+x\d+|\d+)(\.\w+$)/i,"$1$2"+e+"$4")}var n,r=[];switch(t.provider.toLowerCase()){case"vimeo":r.push({url:i(t.thumbnail_url,"1280"),width:1280}),r.push({url:i(t.thumbnail_url,"640"),width:640});break;case"youtube":r.push({url:e(t.thumbnail_url,"maxresdefault"),width:1280}),r.push({url:e(t.thumbnail_url,"sddefault"),width:640})}return(n=r)&&n.length?new window.Promise((function(e){var i=0;!function e(r,a,o){(function(t,e){var i=new Image,n=new window.Promise((function(t){function n(){i.removeEventListener("load",r),i.removeEventListener("error",a)}function r(){t(e<=i.naturalWidth),n()}function a(){t(!1),n()}i.addEventListener("load",r),i.addEventListener("error",a)}));return i.src=t,n})(r,a).then((function(a){a?o(r):++i<n.length?e(n[i].url,n[i].width,o):o(t.thumbnail_url)}))}(n[i].url,n[i].width,e)})):Promise.resolve(t.thumbnail_url)},getEmbedData:function(t,e,i){return n.Z.ajax({type:"GET",url:"/api/proxy/",dataType:"json",data:{url:/oembed/i.test(t)?t:this.getEmbedUrl(t)},success:function(t){t.url=t.url&&r.default.toHttps(t.url),t.thumbnail_url=t.thumbnail_url&&r.default.toHttps(t.thumbnail_url),"function"==typeof e&&e(t)},error:function(t,e,n){"abort"!==e&&"function"==typeof i&&i(t,e,n)},global:!1})},getEmbedUrl:function(t){if(this.isVimeo(t))return"https://vimeo.com/api/oembed.json?url="+encodeURIComponent(t);var e=a.getYoutubeIdFromUrl(t);return e?"https://www.youtube.com/oembed?format=json&url="+encodeURIComponent("https://www.youtube.com/watch?v="+e):""},getYoutubeIdFromUrl:function(t){var e=t.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/);if(e&&11===e[2].length)return e[2];return(e=t.match(/.*(youtu.*\&v=)([^#\&\?]*).*/))&&11===e[2].length?e[2]:null},getVimeoIdFromUrl:function(t){var e=t.match(/(video\/)(\w+)(_\d+x\d+|_\d+)(\.\w+$)/i);return e&&e[2]?e[2]:null},getVideoProvider:function(t){return this.isVimeo(t)?"Vimeo":this.isYoutube(t)?"YouTube":""},isVimeo:function(t){return/vimeo\.com\/.+/.test(t)},isYoutube:function(t){return!!this.getYoutubeIdFromUrl(t)}};e.Z=a},1022:function(t,e){"use strict";function i(t){return new i.fn.init(t)}var n={},r={};Array.prototype.slice;function a(t,e,i){if(!i.contentWindow.postMessage)return!1;var n=JSON.stringify({method:t,value:e});i.contentWindow.postMessage(n,"*")}function o(t){var e,i;try{i=(e=JSON.parse(t.data)).event||e.method}catch(t){}if(!/^https?:\/\/player.vimeo.com/.test(t.origin))return!1;var a=e.value,o=e.data,s=""===s?null:e.player_id,c=function(t,e){return e?n[e]&&n[e][t]:n[t]}(i,s),l=[];return"ready"!==i||r[s]||(r[s]=!0),!!c&&(void 0!==a&&l.push(a),o&&l.push(o),s&&l.push(s),l.length>0?c.apply(null,l):c.call())}function s(t,e,i){i?(n[i]||(n[i]={}),n[i][t]=e):n[t]=e}function c(t){return!!(t&&t.constructor&&t.call&&t.apply)}i.fn=i.prototype={element:null,init:function(t){return"string"==typeof t&&(t=document.getElementById(t)),this.element=t,this.element?this:null},api:function(t,e){if(!this.element||!t)return!1;var i=this.element,n=""!==i.id?i.id:null,r=c(e)?null:e,o=c(e)?e:null;return o&&s(t,o,n),a(t,r,i),this},addEvent:function(t,e){if(!this.element)return!1;var i=this.element,n=""!==i.id?i.id:null;return s(t,e,n),"ready"!=t?a("addEventListener",t,i):"ready"==t&&r[n]&&e.call(null,n),this},removeEvent:function(t){if(!this.element)return!1;var e=this.element,i=function(t,e){if(e&&n[e]){if(!n[e][t])return!1;n[e][t]=null}else{if(!n[t])return!1;n[t]=null}return!0}(t,""!==e.id?e.id:null);"ready"!=t&&i&&a("removeEventListener",t,e)}},i.fn.init.prototype=i.fn,window.addEventListener?window.addEventListener("message",o,!1):window.attachEvent("onmessage",o),e.Z=i},1008:function(t,e){"use strict";var i=["DOMMouseScroll","mousewheel"];e.Z=function(t,e,n,r){t||(t=document),e||(e=window),"boolean"!=typeof n&&(n=!0);var a,o,s,c=function(t){!function(t,e,i,n){i&&(t.preventDefault?t.preventDefault():event.returnValue=!1);var r=t.detail||-t.wheelDelta/40;r*=19,"number"!=typeof n||isNaN(n)||(r*=n),e.scrollBy?e.scrollBy(0,r):e.scrollTop+=r}(t=t||window.event,e,n,r)};return(a=t.addEventListener)?(a.call(t,i[0],c,!1),a.call(t,i[1],c,!1)):(a=t.attachEvent)&&a.call(t,"on"+i[1],c),(o=t.removeEventListener)?s=function(){o.call(t,i[0],c,!1),o.call(t,i[1],c,!1)}:(o=t.detachEvent)&&(s=function(){o.call(t,"on"+i[1],c)}),{restore:s}}},1067:function(t,e,i){"use strict";var n=i(336),r=i.n(n),a=i(321),o=i(340),s=i(736),c=i(710),l=i(741),d=i(323);function u(t,e,i,n,r,a,o){try{var s=t[a](o),c=s.value}catch(t){return void i(t)}s.done?e(c):Promise.resolve(c).then(n,r)}function h(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function p(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(Object(i),!0).forEach((function(e){f(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function f(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function g(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return m(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function v(t){var e;if("undefined"!=typeof Symbol){if(Symbol.asyncIterator&&null!=(e=t[Symbol.asyncIterator]))return e.call(t);if(Symbol.iterator&&null!=(e=t[Symbol.iterator]))return e.call(t)}throw new TypeError("Object is not async iterable")}var y=r().View.extend({initialize:function(t){a.Z.bindAll(this),a.Z.extend(this,t);var e={};a.Z.each(this.widgets,a.Z.bind((function(t){if(t.hasAnimation()){var i=t.fixed_position||t.is_full_width||t.is_full_height||t.sticked?o.default.generateUUID():s.Z.getUuidHash(t.getAnimations())||o.default.generateUUID();e[i]=e[i]||[],e[i].push(t)}}),this)),this.animations=[];var i=!d.Z.isDesktop||!Modernizr.safari;a.Z.each(e,function(t){this.addAnimation(t,{allowAccelerate:i})}.bind(this)),this.start.__debounced=a.Z.debounce(this.start,300)},addAnimation:function(t,e){var i=this;e=e||{},t=a.Z.isArray(t)?t:[t];var n=["nonMove","moveOnly"].concat(g(s.Z.EVENT_TYPES)).reverse();g(t[0].getAnimations()).map((function(t){return s.Z.isMoveOnly(t)?p(p({},t),{},{effects:"moveOnly"}):s.Z.isNonMove(t)?p(p({},t),{},{effects:"nonMove"}):t})).sort((function(t,e){return n.indexOf(t.effects||t.type)-n.indexOf(e.effects||e.type)})).filter((function(t){return!s.Z.isEmpty(t)})).map((function(n){var r=n.type;if(d.Z.isDesktop||"hover"!==r||t[0].getAnimationTriggers(n.UUID).length){var a=t[0].animationObjects,o=Boolean(a&&a.length),s=new b[r]({page:i.page,widgets:t,rawAnimation:n,$container:o?a[a.length-1].$el:void 0,allowAccelerate:e.allowAccelerate,isNested:o,topmostAnimation:o?a[0]:void 0});i.animations.push(s)}}))},removeAnimation:function(t){this.animations=a.Z.without(this.animations,t),t&&t.destroy()},start:function(){a.Z.each(this.animations,(function(t){t.start()}))},stop:function(){a.Z.each(this.animations,(function(t){t.stop()}))},resetStarted:function(){a.Z.each(this.animations,(function(t){t.started=!1}))},onScroll:function(t){t=t||{},(this.page.mag.currentPage===this.page||t.forceApply)&&a.Z.each(this.animations,(function(e){e.onScroll&&e.onScroll(t)}))},onResize:function(t){a.Z.each(this.animations,(function(e){e.onResize(t)}))},updateTimelines:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];a.Z.each(this.animations,(function(e){t.includes(e.animation.UUID)||e.createAnimationTimeline()}))},hasScaleUp:function(){return Boolean(a.Z.find(this.animations,(function(t){return s.Z.isScaleUp(t.animation)})))},destroy:function(){a.Z.each(this.animations,(function(t){t.destroy()})),delete this.animations}}),b={},w=r().View.extend({visibilityRatio:.2,className:"animation-container",scrolledToView:!1,useOnscrollBoundsFallback:!window.IntersectionObserver,initialize:function(t){a.Z.bindAll(this),a.Z.extend(this,t),a.Z.each(this.widgets,a.Z.bind((function(t){t.animationObj=this,t.animationObjects=[].concat(g(t.animationObjects||[]),[this])}),this)),this.isFixed=this.widgets[0].fixed_position,this.isFullwidth=this.widgets[0].is_full_width,this.isFullheight=this.widgets[0].is_full_height,this.isSticked=this.widgets[0].sticked,this.isAbove=this.widgets[0].is_above,this.playOnce=!this.page.mag.isPreview&&this.playOnce,this.$container=this.$container||(this.isFixed||this.isAbove?this.widgets[0].$fixedContainer:this.page.$content),this.$el.appendTo(this.$wrapper?this.$wrapper:this.$container),this.createAnimationTimeline(t),this.onResize({updateAll:!0})},createAnimationTimeline:function(t){t=t||{},this.timeline&&this.timeline.destroy(),this.animation=s.Z.getNormalizedAnimation(this.rawAnimation,this.isFixed,this.isFullwidth,this.isFullheight,this.page.scale,this.page.pageViewport,this.page.mag.getViewportWidth(this.page.pageViewport),this.page.mag.viewOpts),this.timeline=s.Z.createAnimationTimeline({el:this.$el,steps:this.animation.steps,type:this.animation.type,force3d:!1,animationTrigger:this.animation.trigger,selfTriggered:Boolean(a.Z.intersection(s.Z.normalizeAnimationTriggers(this.animation.trigger),this.widgets.map((function(t){return t._id}))).length),screenshotMode:!!RM.screenshot})},start:function(){this.timeline&&this.paused&&(this.paused=!1,this.timeline.resume())},stop:function(){this.timeline&&this.timeline.active&&(this.isAbove||(this.paused=!0,this.timeline.pause()))},getAnimationContainer:function(){return this.$el},modifyWidgetPosition:function(t){return this.isFixed?(t.dimensions.left="50%",t.dimensions.top="50%",t.dimensions.right="",t.dimensions.bottom="",t.dimensions["margin-left"]=-t.dimensions.width/2,t.dimensions["margin-top"]=-t.dimensions.height/2):(t.dimensions.left-=this.bbox_css.left+(this.isNested?this.topmostAnimation.bbox_css.left:0),t.dimensions.top-=this.bbox_css.top+(this.isNested?this.topmostAnimation.bbox_css.top:0)),t},onResize:function(t){if((t=t||{}).updateAll||this.isFixed&&this.prevPageScale!==this.page.scale||this.isFullwidth||this.isFullheight||this.isSticked){var e,i={t:Number.POSITIVE_INFINITY,l:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,r:Number.NEGATIVE_INFINITY,z:0};this.isFixed||this.isFullwidth||this.isFullheight||this.isSticked?this.bbox_css=p(p({},this.widgets[0].calcBoxStyle({calcBBox:!0}).dimensions),this.isNested?{left:0,top:0,"margin-left":0,"margin-top":0}:{}):(a.Z.each(this.widgets,(function(t){e=t.calcBoxStyle({calcBBox:!0}).dimensions,i.t=Math.min(i.t,e.top),i.l=Math.min(i.l,e.left),i.b=Math.max(i.b,e.top+e.height),i.r=Math.max(i.r,e.left+e.width),i.z=Math.max(i.z,e["z-index"])}),this),this.bbox_css={left:this.isNested?0:i.l,top:this.isNested?0:i.t,width:i.r-i.l,height:i.b-i.t,"z-index":i.z}),this.$el.css(this.bbox_css)}this.innerContentTop=this.page.contentPosition.top/this.page.scale,this.innerContainerHeight=this.page.mag.getContainerSizeCached().height/this.page.scale,this.prevPageScale=this.page.scale},withTriggerOrElement:function(t){var e,i=this;return(e=regeneratorRuntime.mark((function e(){var n,r,a,o,s,c,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=!0,a=!1,e.prev=3,s=v(i.animation.trigger.filter((function(t){return t})));case 5:return e.next=7,s.next();case 7:return c=e.sent,r=c.done,e.next=11,c.value;case 11:if(l=e.sent,r){e.next=27;break}return d=l,e.prev=14,e.t0=n,e.next=18,i.page.mag.getWidgetById(d,i.page);case 18:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.next=24;break;case 22:e.prev=22,e.t2=e.catch(14);case 24:r=!0,e.next=5;break;case 27:e.next=33;break;case 29:e.prev=29,e.t3=e.catch(3),a=!0,o=e.t3;case 33:if(e.prev=33,e.prev=34,r||null==s.return){e.next=38;break}return e.next=38,s.return();case 38:if(e.prev=38,!a){e.next=41;break}throw o;case 41:return e.finish(38);case 42:return e.finish(33);case 43:n.forEach((function(e){e.rendered?t(e.$el):i.listenToOnce(e,"rendered",(function(){return t(e.$el)}))})),n.length||t(i.$el);case 45:case"end":return e.stop()}}),e,null,[[3,29,33,43],[14,22],[34,,38,42]])})),function(){var t=this,i=arguments;return new Promise((function(n,r){var a=e.apply(t,i);function o(t){u(a,n,r,o,s,"next",t)}function s(t){u(a,n,r,o,s,"throw",t)}o(void 0)}))})()},getBBScaleFactor:function(){return c.Z.isOnForRatio(this.page.pageViewport,this.page.scale,this.page.mag.viewOpts)&&c.Z.isCSSZoom()?this.page.scale:1},isInView:function(){var t=l.Z.getBoundingBoxOfElements(this.widgets.map((function(t){return t.$el[0]})),this.getBBScaleFactor());return l.Z.isBoxInView(t,this.visibilityRatio)},notifyWhenInOrOutOfView:function(){var t=this;window.requestAnimationFrame((function(){t.isInView()?(t.scrolledToView=!0,t.scrolledOutOfView=!1,t.trigger("scrolledToView")):(t.scrolledToView=!1,t.scrolledOutOfView=!0,t.trigger("scrolledOutOfView"))}))},whenInView:function(){return this.whenInOrOutOfView("in")},whenOutOfView:function(){var t=this;return this.isInView()?this.whenInOrOutOfView("out"):this.whenInOrOutOfView("in").then((function(){return t.whenInOrOutOfView("out")}))},whenInOrOutOfView:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"in",i="in"===e,n="out"===e;if(this.useOnscrollBoundsFallback)return i&&this.isInView()||n&&!this.isInView()?window.Promise.resolve():new window.Promise((function(e){t.listenToOnce(t,n?"scrolledOutOfView":"scrolledToView",e)}));var r=this.widgets.map((function(t){return t.$el[0]})),a=l.Z.getBoundingBoxOfElements(r,this.getBBScaleFactor());return i?new window.Promise((function(e){var i=new window.IntersectionObserver((function(t){t.some((function(t){return t.isIntersecting}))&&(r.forEach((function(t){return i.unobserve(t)})),e())}),{rootMargin:"-".concat(a.height*t.visibilityRatio,"px 0px")});r.forEach((function(t){return i.observe(t)}))})):n?Promise.all(r.map((function(t){return new window.Promise((function(e){var i=new window.IntersectionObserver((function(n){n.every((function(t){return!t.isIntersecting}))&&(i.unobserve(t),e())}));i.observe(t)}))}))):void 0},destroy:function(){this.stop(),this.timeline&&this.timeline.destroy(),this.remove()}});b.scroll=w.extend({onScroll:function(t){if(t=t||{},this.timeline&&(this.page.mag.currentPage===this.page&&!this.isAbove||t.forceApply)){var e=this.isAbove?t.scroll:Math.max(0,this.page.visibleWidgetsCoords.scrollTop||0);if(this.isFixed)this.timeline.seek(e);else{var i=this.animation.steps[0].start_point||"bottom",n=this.bbox_css.top+(this.isNested?this.topmostAnimation.bbox_css.top:0)+this.innerContentTop,r=n-this.innerContainerHeight,a={top:1,center:.5,bottom:0}[i]*(n-r)+r+this.animation.steps[0].start_offset||0;a<=0?this.timeline.seek(e/this.page.scale):this.timeline.seek(Math.max(0,e-a*this.page.scale)/this.page.scale)}}},onResize:function(){w.prototype.onResize.apply(this,arguments),this.onScroll()}}),b.load=w.extend({initialize:function(){w.prototype.initialize.apply(this,arguments);var t=this.animation.steps;this.startWhenInView=t&&t.length&&t[0].startWhenInView,this.notifyWhenInOrOutOfView.__throttled=a.Z.throttle(this.notifyWhenInOrOutOfView,100)},start:function(){w.prototype.start.apply(this,arguments),this.isReady().then(function(){this.timeline.play(),this.started=!0}.bind(this)).catch((function(t){t&&console.log(t&&t.stack)}))},onScroll:function(){this.useOnscrollBoundsFallback&&this.notifyWhenInOrOutOfView.__throttled()},isReady:function(){var t,e=this;if(RM.screenshot||this.started||o.default.PageVisibilityManager.isPageHidden())t=window.Promise.reject();else{var i=this.widgets[0],n=[],r=window.Promise.all(this.widgets.map((function(t){return t.loaded?window.Promise.resolve():new window.Promise((function(i){return e.listenToOnce(t,"loaded",i)}))})));if(this.isAbove){var a=this.page.mag.aboveAnimationsReady?window.Promise.resolve():new window.Promise(function(t){this.listenToOnce(this.page.mag,"aboveAnimationsReady",t)}.bind(this)),s=i.rendered?window.Promise.resolve():new window.Promise(function(t){this.listenToOnce(i,"rendered",t)}.bind(this)),c=i.wasHidden?new window.Promise(function(t){this.listenToOnce(i,"shown",t)}.bind(this)):window.Promise.resolve();n=this.startWhenInView?[s,c,r]:[a,s,c,r]}else{var l=this.page.started?window.Promise.resolve():new window.Promise(function(t){this.listenToOnce(this.page,"started",t)}.bind(this)),d=this.page.loadAnimationsReady?window.Promise.resolve():new window.Promise(function(t){this.listenToOnce(this.page,"loadAnimationsReady",t)}.bind(this)),u=this.page.isCurrent()?window.Promise.resolve():new window.Promise(function(t){this.listenToOnce(this.page,"changedTo",t)}.bind(this)),h=this.startWhenInView?r.then((function(){return e.whenInView()})):window.Promise.resolve();n=this.startWhenInView?[l,u,h]:[d,l]}t=window.Promise.all(n)}return t}}),b.click=w.extend({resetWhenOutOfView:!1,initialize:function(){w.prototype.initialize.apply(this,arguments);var t=function(t){t.on("click",this.onClick),t.css("cursor","pointer")}.bind(this);this.willStopOnEnd=!1,this.lastTimeClick=0,this.withTriggerOrElement(t),this.notifyWhenInOrOutOfView.__throttled=a.Z.throttle(this.notifyWhenInOrOutOfView,100)},onClick:function(){var t=this,e=s.Z.getPermanentAnimationId(this.widgets[0],this.animation.UUID),i=this.timeline&&!this.timeline.active&&this.timeline.reversed&&s.Z.hasPlayed(e);this.timeline&&!i&&(+new Date-this.lastTimeClick<300||(this.lastTimeClick=+new Date,this.timeline.active?(this.willStopOnEnd?this.timeline.off("full-cycle-end",this.onCycleEnd):this.timeline.on("full-cycle-end",this.onCycleEnd),this.willStopOnEnd=!this.willStopOnEnd):(this.willStopOnEnd=!1,this.timeline.reversed?this.timeline.reverse():this.timeline.play(),this.animation.playOnce&&!s.Z.hasPlayed(e)&&s.Z.persistHasPlayed(e),this.animation.resetWhenOutOfView&&this.whenOutOfView().then((function(){t.timeline.stop(),t.timeline.applyStepState("initial"),t.timeline.reversed=!1})),a.Z.each(this.widgets,(function(e){"video"===e.type&&e.player&&(t.timeline.reversed?e.player.pause():e.player.play())})))))},onScroll:function(){this.useOnscrollBoundsFallback&&this.notifyWhenInOrOutOfView.__throttled()},onCycleEnd:function(){this.willStopOnEnd=!1,this.timeline.off("full-cycle-end",this.onCycleEnd),this.timeline.loop?this.timeline.isFullLoop?this.timeline.stop():this.timeline.reverse():this.timeline.reversed?this.timeline.reverse():this.timeline.play()},destroy:function(){var t=function(t){t.css("cursor","")};this.withTriggerOrElement(t),w.prototype.destroy.apply(this,arguments)}}),b.hover=w.extend({initialize:function(){if(w.prototype.initialize.apply(this,arguments),d.Z.isDesktop){var t=function(t){t.on("mouseenter",this.onMouseEnter),t.on("mouseleave",this.onMouseLeave)}.bind(this);a.Z.each(this.widgets,a.Z.bind((function(t){-1!==["text","shape","picture","button"].indexOf(t.type)&&(t.hasHoverAnimation=!0)}),this)),this.withTriggerOrElement(t)}},onMouseEnter:function(){this.timeline&&(this.timeline.active?!this.timeline.loop&&this.timeline.reversed?this.timeline.on("full-cycle-end",this.onCycleEnd):this.timeline.off("full-cycle-end",this.onCycleEnd):!this.timeline.reversed&&this.timeline.play())},onMouseLeave:function(){this.timeline&&(this.timeline.active?!this.timeline.loop&&this.timeline.reversed?this.timeline.off("full-cycle-end",this.onCycleEnd):this.timeline.on("full-cycle-end",this.onCycleEnd):!this.timeline.loop&&this.timeline.reversed&&this.timeline.reverse())},onCycleEnd:function(){this.timeline.off("full-cycle-end",this.onCycleEnd),this.timeline.loop?this.timeline.isFullLoop?this.timeline.stop():this.timeline.reverse():this.timeline.reversed?this.timeline.reverse():this.timeline.play()}}),e.Z=y},1084:function(t,e,i){"use strict";var n=i(336),r=i.n(n),a=i(321),o=i(1085),s=r().View.extend({template:o.Z["template-viewer-branding"],initialize:function(t){return a.Z.bindAll(this),a.Z.extend(this,t),this},render:function(){var t=this.mag&&this.mag.num_id,e=t?"utm_source=made_with_readymag&utm_medium=referral&utm_campaign=".concat(t):"";return this.setElement(this.template({utm_params:e})),this.$el.appendTo(this.$container),this.listenTo(this.mag,"pageChanged",this.onPageChange),a.Z.delay(function(){this.$el.removeClass("offscreen-initially")}.bind(this),800),this},onPageChange:function(t,e){},hide:function(){this.$el.stop().fadeOut(200)},show:function(){this.$el.stop().fadeIn(200)}});e.Z=s},1075:function(t,e,i){"use strict";var n=i(321),r=i(312),a=i(957),o=i.n(a),s=i(678),c=i(765),l=i.n(c),d=i(891),u=i.n(d),h=i(1071),p=i(1072),f=i(340),g=i(342),m=i(308),v=i(1074),y=i(347);function b(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function w(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?b(Object(i),!0).forEach((function(e){S(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function S(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var P=Backbone.View.extend({template:p.Z["template-viewer-cart-sidebar"],initialize:function(t){return n.Z.bindAll(this),this.mag=t,this.environment=this.mag.router.environment,this.rendered=!1,this.havePrices=!1,this.isHiddenSettings=!0,this.hoveredItem=null,this.render(),this},render:function(){if(!RM.screenshot){var t=RM.viewerRouter?RM.viewerRouter.getUserPermissions():RM.constructorRouter.me.get("permissions");if(t&&t.can_use_e_commerce&&!this.mag.eCommerceManager.isConstructor()&&this.mag.eCommerceManager.haveEcommerceCartWidget&&this.mag.eCommerceManager.getConnectedProvider()&&!this.rendered){this.rendered=!0,this.provider=this.mag.eCommerceManager.getConnectedProvider(),document.querySelectorAll("#cart-sidebar").length&&document.querySelectorAll("#cart-sidebar").forEach((function(t){return t.parentNode.removeChild(t)})),this.setElement(this.template({isMobile:(0,h.isMobile)(),isViewer:this.environment===m.ZP.environment.viewer,imgPublicPath:y.folderImagesPath})),this.$el.appendTo((0,r.Z)("body")),this.$toolbar=(0,r.Z)(".toolbar.for-viewer"),this.$tabs=this.$el.find(".cart-sidebar-tabs"),this.$items=this.$el.find(".cart-items-list"),this.$closeButton=this.$el.find(".close-button"),this.$footer=this.$el.find(".sidebar-footer"),this.$calcTextContainer=this.$el.find(".text-size-calc-container"),this.$itemsTab=this.$tabs.find(".tab-items"),this.$checkOutButton=this.$itemsTab.find(".сheck-out-btn"),this.cartWidgetData=this.mag.eCommerceManager.getCartWidgetData(),this.environment===m.ZP.environment.preview&&(this.cartWidgetData&&this.cartWidgetData._id&&this.setupSettingsPanel(),window.RM.constructorRouter.on("previewClose",this.closeSideBar.bind(this)),this.bindTextInputsEvents());var e=this.$el.find(".svg");o()(e),this.$el.find("[data-alt]:not(.rmalttext)").RMAltText(),this.generateSidebarCSS(this.cartWidgetData);var i=this.mag.eCommerceManager.getEcommerceData();return(0,r.Z)('<div class="ec-cart-widget"></div><div><script data-cfasync="false" type="text/javascript" src="https://app.ecwid.com/script.js?'.concat(i.ecwid.serviceData.storeId,"&data_platform=code&data_date=").concat(l()(this.mag.published?this.mag.published:this.mag.creation_date).format("YYYY-MM-DD"),'" charset="utf-8"><\/script></div>')).appendTo(this.$el),this.renderSidebarTexts(),this.renderCartItems(),this.bindDomEvents(),g.Z.on("ecommerce:cartsidebar:visibility:changed",this.toggleSidebar),this.mag.eCommerceManager.events.on("ecommerce:cartdata:changed",this.renderCartItems),this}}},bindDomEvents:function(){this.$closeButton.on("click",this.closeSideBar.bind(this)),this.$checkOutButton.on("click",this.goToCheckout.bind(this)),(0,r.Z)(document).on("mouseover",".cart-sidebar .sidebar-body .cart-item-block",this.cartItemBlockHover),(0,r.Z)(document).on("mouseleave",".cart-sidebar .sidebar-body .cart-item-block",this.cartItemBlockLeave),this.bindStaticTextFieldsHovers()},unbindDomEvents:function(){this.$closeButton.off("click",this.closeSideBar),this.$checkOutButton.off("click",this.goToCheckout.bind(this)),(0,r.Z)(document).off("mouseover",".cart-sidebar .sidebar-body .cart-item-block",this.cartItemBlockHover),(0,r.Z)(document).off("mouseleave",".cart-sidebar .sidebar-body .cart-item-block",this.cartItemBlockLeave)},bindStaticTextFieldsHovers:function(){this.environment===m.ZP.environment.preview&&(this.$itemsTab.find(".cart-title-input, .empty-cart-title-input").on("mouseover",(function(t){(0,r.Z)(t.target).addClass("active")})),this.$itemsTab.find(".cart-title-input, .empty-cart-title-input").on("mouseleave",(function(t){(0,r.Z)(t.target).is(":focus")||(0,r.Z)(t.target).removeClass("active")})),this.$itemsTab.find(".сheck-out-btn").on("mouseover",(function(t){(0,r.Z)(t.target).find(".cart-checkout-input").addClass("active")})),this.$itemsTab.find(".сheck-out-btn").on("mouseleave",(function(t){var e=(0,r.Z)(t.target).find(".cart-checkout-input");e.is(":focus")||e.removeClass("active")})))},hideSidebar:function(){this.$el.removeClass("show"),(0,r.Z)("body").removeClass("cart-sidebar-shown"),(0,r.Z)("html").removeClass("cart-disable-scroll"),!this.isHiddenSettings&&this.settingsPanel&&(this.isHiddenSettings=!0,this.settingsPanel.isHidden=this.isHiddenSettings)},toggleSidebar:function(t){t?this.hideSidebar():(this.$el.addClass("show"),(0,r.Z)("body").addClass("cart-sidebar-shown"),(0,r.Z)("html").addClass("cart-disable-scroll"))},closeSideBar:function(){this.mag.eCommerceManager.isCartSidebarHidden||this.mag.eCommerceManager.changeCartSidebarVisibility()},generateSidebarCSS:function(t){this.stylesElementId="cart_sidebar_styles_".concat(t._id);var e=f.default.getRGBA(t["bar-color"],t["bar-color-opacity"]/100),i=f.default.getRGBA(t["bar-background-color"],t["bar-background-color-opacity"]/100),n=f.default.getRGBA(t["bar-color"],.45*t["bar-color-opacity"]/100),a=this.getAdditionalColor(i),o="    .cart-sidebar {\n\n      color: ".concat(e,";\n      background-color: ").concat(i,";\n      box-shadow: ").concat(t["bar-shadow"]?"0 0 4px rgba(124, 124, 125, 0.5)":"none",";\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar textarea {\n\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar input {\n\n      color: ").concat(e,";\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar input::placeholder {\n\n      color: ").concat(n,";\n    }\n\n    .cart-sidebar .cart-title-input.active {\n\n      border-color: ").concat((0,s.transparentize)(.8,e),";\n    }\n\n    .cart-sidebar .empty-cart-title-input.active {\n\n      border-color: ").concat((0,s.transparentize)(.8,e),";\n    }\n\n    .cart-sidebar .cart-price-input.active, .cart-sidebar .cart-quantity-input.active {\n\n      border-color: ").concat((0,s.transparentize)(.2,n),";\n    }\n\n    .cart-sidebar .cart-checkout-input.active {\n\n      border-color: ").concat((0,s.transparentize)(.8,e),";\n    }\n\n    .cart-sidebar .cart-price-input {\n\n      color: ").concat(n,";\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar .cart-quantity-input {\n\n      color: ").concat(n,";\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar button {\n\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar select {\n\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar .sidebar-btn {\n\n      color: ").concat(e,";\n      border-color: ").concat(n,";\n    }\n\n    .cart-sidebar .preloader svg path {\n\n      stroke: ").concat(e,";\n    }\n\n    .cart-sidebar .sidebar-btn path {\n\n      fill: ").concat(e,";\n    }\n\n    .cart-sidebar .expand-arrow svg path {\n\n      fill: ").concat(e,";\n    }\n\n    .cart-sidebar .cart-cancel-btn {\n\n      color: ").concat(e,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block.hover {\n\n      background-color: ").concat(a,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-attributes {\n\n      color: ").concat(n,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-price {\n\n      color: ").concat(n,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-items-quantity {\n\n      color: ").concat(n,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-remove-btn-icon path {\n\n      fill: ").concat(e,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-decrease-btn-icon rect {\n\n      fill: ").concat(e,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-increase-btn-icon path {\n\n      fill: ").concat(e,";\n    }\n\n    .cart-sidebar .sidebar-settings-container .settings-button path {\n\n      stroke: ").concat(e,";\n    }\n\n    .cart-sidebar .sidebar-settings-container .settings-button:hover path {\n\n      stroke: ").concat(n,";\n    }\n\n    .cart-sidebar.cart-is-mobile .sidebar-body .cart-item-block {\n\n      background-color: ").concat(a,";\n    }");(0,r.Z)("#".concat(this.stylesElementId)).remove();var c=document.createElement("style");c.type="text/css",c.id=this.stylesElementId,c.className="cart-sidebar-styles",c.appendChild(document.createTextNode(o)),document.querySelector("head").appendChild(c)},getAdditionalColor:function(t){return(0,s.getLuminance)(t)<.05&&(0,s.getContrast)("#fff",t)-(0,s.getContrast)("#000",t)>=8?(0,s.lighten)(.1,t):(0,s.darken)(.1,t)},renderCartItems:function(){var t=this.mag.eCommerceManager.getCartData();if(t){var e=Object.keys(t.prices);this.$items.empty(),this.havePrices=Boolean(e.length),this.havePrices?(this.$itemsTab.find(".сheck-out-btn").css("display","block"),this.$itemsTab.find(".empty-cart").css("display","none")):(this.$itemsTab.find(".сheck-out-btn").css("display","none"),this.$itemsTab.find(".empty-cart").css("display","flex")),this.renderPricesCartItems(e);var i=this.$items.find(".svg");o()(i),this.renderSidebarTexts(),this.unbindTextInputsEvents(!0),this.bindTextInputsEvents(!0)}},renderPricesCartItems:function(t){var e=this,i=this.mag.eCommerceManager.getCartData();t.forEach((function(t){var n=i.prices[t];n.active&&e.renderCartItem(n)}))},renderCartItem:function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"price",a=this.mag.eCommerceManager.getCartItenKey(t),o=this.hoveredItem===a,s=(0,r.Z)("<div/>",{class:"cart-item-block".concat(o?" hover":"")});s.data("".concat(n,"-id"),a);var c=(null===(e=t.selectedCombination)||void 0===e?void 0:e.thumbnailUrl)||t.image||t.images&&t.images.length;if(c){var l=this.getProductImage(t);i=(0,r.Z)("<div/>",{class:"cart-item-image",css:{"background-position":"center center","background-size":"cover","background-repeat":"no-repeat","background-image":"url(".concat(l,")")}}),s.append(i)}var d=(0,r.Z)("<div/>",{class:i?"cart-item-title":"cart-item-title without-image"}).text(t.nameTranslated&&t.nameTranslated[this.mag.eCommerceManager.userLocale]?t.nameTranslated[this.mag.eCommerceManager.userLocale]:t.name),u=t.cart_count,h=this.getOneItemPrice(t),p=(0,v.x)(h,t.currency),f=(0,v.x)((h*u).toFixed(2),t.currency),g=(0,r.Z)("<div/>",{class:"cart-item-price"}),m=(0,r.Z)("<input/>",{type:"text",class:"cart-text-input cart-price-input",name:"price",placeholder:"Price",maxlength:"32",translate:"no",autocomplete:"no",autocorrect:"no",spellcheck:"false"});m.get(0).dataset.dynamicWidth=!0;var b=(0,r.Z)("<span/>").html(u>1?": ".concat(p," × ").concat(u," = ").concat(f):": ".concat(p));g.append(m).append(b);var w=this.getTranslatedOptions(t),S=(0,r.Z)("<div/>",{class:"cart-items-quantity"}),P=(0,r.Z)("<input/>",{type:"text",class:"cart-text-input cart-quantity-input",name:"quantity",placeholder:"Quantity",maxlength:"32",translate:"no",autocomplete:"no",autocorrect:"no",spellcheck:"false"});P.get(0).dataset.dynamicWidth=!0;var k=(0,r.Z)("<span/>").html(": ".concat(u));S.append(P).append(k);var C=(0,r.Z)("<div/>",{class:"cart-item-remove-btn",title:"remove"}).attr("data-".concat(n,"-id"),a),x=(0,r.Z)("<img/>",{class:"svg cart-item-remove-btn-icon",src:(0,y.findImagePath)("./viewer/cart-sidebar/cart-item-delete.svg")});C.append(x),C.on("click",this.onRemoveItem);var O=(0,r.Z)("<div/>",{class:"cart-item-edit-group"}),T=(0,r.Z)("<div/>",{class:"cart-item-increase-btn"}).attr("data-".concat(n,"-id"),a),_=(0,r.Z)("<img/>",{class:"svg cart-item-increase-btn-icon",src:(0,y.findImagePath)("./viewer/cart-sidebar/cart-item-increase.svg")});if(T.append(_),O.append(T),this.mag.eCommerceManager.isOutOfStock(t)||(T.addClass("active"),T.on("click",this.onIncreaseItem)),u>1){var Z=(0,r.Z)("<div/>",{class:"cart-item-decrease-btn decrease-btn-".concat(a)}).attr("data-".concat(n,"-id"),a),M=(0,r.Z)("<img/>",{class:"svg cart-item-decrease-btn-icon",src:(0,y.findImagePath)("./viewer/cart-sidebar/cart-item-decrease.svg")});Z.append(M),O.append(Z),Z.on("click",this.onDecreaseItem)}else{var I=this.$items.find("decrease-btn-".concat(a));I.off("click",this.onDecreaseItem),I.remove()}s.append(d).append(w).append(g).append(S).append(C).append(O),this.$items.append(s)},getProductImage:function(t){var e;return null!==(e=t.selectedCombination)&&void 0!==e&&e.thumbnailUrl?t.selectedCombination.thumbnailUrl:t.image?t.image:t.images?t.images[0]:""},getTranslatedOptions:function(t){var e=this;if(t.selectedOptions){var i=(0,r.Z)("<div/>",{class:"cart-item-attributes"});return Object.keys(t.selectedOptions).forEach((function(n){var a=f.default.capitalize(n),o=t.selectedOptions[n],s=e.mag.eCommerceManager.userLocale,c=t.options.find((function(t){return t.name===n}));if(null!=c&&c.nameTranslated&&null!=c&&c.nameTranslated[s]&&(a=f.default.capitalize(c.nameTranslated[s])),null!=c&&c.choices){var l=c.choices.find((function(e){return e.text===t.selectedOptions[n]}));null!=l&&l.textTranslated&&null!=l&&l.textTranslated[s]&&(o=l.textTranslated[s])}var d=(0,r.Z)("<div/>",{class:"cart-item-attribute"}).html("".concat(a,": ").concat(o));i.append(d)})),i}},getOneItemPrice:function(t){var e,i=t.price;return null!==(e=t.selectedCombination)&&void 0!==e&&e.price&&(i=t.selectedCombination.price),t.selectedOptions&&Object.keys(t.selectedOptions).forEach((function(e){var n=t.options.find((function(t){return t.name===e})),r=n?n.choices.find((function(i){return i.text===t.selectedOptions[e]})):null;r&&r.priceModifier&&("ABSOLUTE"===r.priceModifierType?i+=r.priceModifier:"PERCENT"===r.priceModifierType&&(i+=t.price*(r.priceModifier/100).toFixed(2)))})),i},onRemoveItem:function(t){t.currentTarget.dataset.priceId&&this.mag.eCommerceManager.removeFromCart(t.currentTarget.dataset.priceId)},onIncreaseItem:function(t){t.currentTarget.dataset.priceId&&this.mag.eCommerceManager.increaseCartItem(t.currentTarget.dataset.priceId)},onDecreaseItem:function(t){t.currentTarget.dataset.priceId&&this.mag.eCommerceManager.decreaseCartItem(t.currentTarget.dataset.priceId)},goToCheckout:function(t){var e=this;if(!t.isDefaultPrevented()){var i=this.mag.eCommerceManager.getCartData(),n=window.Ecwid;if(n){n.init();var a=Object.keys(i.prices),o=[];n.Cart.clear(),a.forEach((function(t){var s={id:Number(i.prices[t].id),quantity:i.prices[t].cart_count,callback:function(i,s,c){var l;i&&(l=t,o.push(l)),a.length===o.length&&(n.OnOrderPlaced.add((function(){e.mag.eCommerceManager.clearCart(),e.mag.eCommerceManager.getProducts(e.mag.eCommerceManager.connectedProvider)})),n.Cart.gotoCheckout(),e.closeSideBar(),e.mag.eCommerceManager.getProducts(e.mag.eCommerceManager.connectedProvider).then((function(){e.mag.eCommerceManager.updateCartProductItems()})),(0,r.Z)("html, body").css({overflow:"auto"}),(0,r.Z)(".ecwid-popup-closeButton, .ecwid-overlay").on("mousedown",(function(){(0,r.Z)("html, body").css("overflow","")})),(0,r.Z)(".ecwid-popup").on("mousedown",(function(t){t.currentTarget===t.target&&(0,r.Z)("html, body").css("overflow","")})),n.OnOrderPlaced.add((function(t){setTimeout((function(){(0,r.Z)(".ec-confirmation__continue > .form-control--done > button").on("mousedown",(function(){(0,r.Z)("html, body").css("overflow","")}))}),300)})))}};i.prices[t].selectedOptions?s.options=w({},i.prices[t].selectedOptions):i.prices[t].options.length&&i.prices[t].options.forEach((function(t){t.required&&(s.options||(s.options={}),s.options[t.name]=t.choices[t.defaultChoice])})),n.Cart.addProduct(s)}))}else alert("No Ecwid")}},getTextFieldModelKey:function(t){return"bar-".concat(t)},getSidebarTextValue:function(t){var e=this.getTextFieldModelKey(t);return this.cartWidgetData&&this.cartWidgetData[e]?u()(this.cartWidgetData[e]):m.ZP.defaultSidebarTexts[t]?m.ZP.defaultSidebarTexts[t]:null},calcTextFieldSize:function(t){if(!t)return null;var e=getComputedStyle(t);this.$calcTextContainer.css({"font-family":e.fontFamily,"font-size":e.fontSize,"font-style":e.fontStyle,"font-weight":e.fontWeight,"letter-spacing":e.letterSpacing}),this.$calcTextContainer.text(t.value);var i=this.$calcTextContainer.width();return Math.ceil(i)},renderSidebarTexts:function(){var t=this;this.$itemsTab.find(".cart-text-input").each((function(e,i){var n=i.getAttribute("name"),r=t.getSidebarTextValue(n);if(r&&(i.value=r,i.dataset.dynamicWidth)){var a=t.calcTextFieldSize(i);a&&(i.style.width="".concat(a,"px"))}}))},bindTextInputsEvents:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$itemsTab.find(".cart-text-input"+(e?'[data-dynamic-width="true"]':"")).each((function(e,i){(0,r.Z)(i).on("click",t.onTextFieldClick),(0,r.Z)(i).on("input",t.onTextFieldChange),(0,r.Z)(i).on("blur",t.onTextFieldBlur)})),e&&this.environment===m.ZP.environment.preview&&(this.$itemsTab.find(".cart-item-block").on("mouseover",this.onDynamicMouseOver),this.$itemsTab.find(".cart-item-block").on("mouseleave",this.onDynamicMouseLeave))},unbindTextInputsEvents:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$itemsTab.find(".cart-text-input"+(e?'[data-dynamic-width="true"]':"")).each((function(e,i){(0,r.Z)(i).off("click",t.onTextFieldClick),(0,r.Z)(i).off("input",t.onTextFieldChange),(0,r.Z)(i).off("blur",t.onTextFieldBlur)})),e&&this.environment===m.ZP.environment.preview&&(this.$itemsTab.find(".cart-item-block").off("mouseover",this.onDynamicMouseOver),this.$itemsTab.find(".cart-item-block").off("mouseleave",this.onDynamicMouseLeave))},onDynamicMouseOver:function(t){(0,r.Z)(t.target).find(".cart-price-input, .cart-quantity-input").addClass("active")},onDynamicMouseLeave:function(t){(0,r.Z)(t.target).find(".cart-price-input, .cart-quantity-input").each((function(){(0,r.Z)(this).is(":focus")||(0,r.Z)(this).removeClass("active")}))},onTextFieldClick:function(t){t.preventDefault()},onTextFieldChange:function(t){if(t.target.dataset.dynamicWidth){var e=this.calcTextFieldSize(t.target);e&&(t.target.style.width="".concat(e,"px"))}},onTextFieldFocus:function(t){this.environment===m.ZP.environment.preview&&(0,r.Z)(t.target).addClass("active")},onTextFieldBlur:function(t){var e=this;this.environment===m.ZP.environment.preview&&(0,r.Z)(t.target).removeClass("active");var i=t.target.getAttribute("name"),n=this.getSidebarTextValue(i);if(n)if(t.target.value){if(this.cartWidgetModel){var a=S({},this.getTextFieldModelKey(i),t.target.value);this.updateCartWidgetData(a),this.cartWidgetModel.save(a,{toHistory:!1,skipHistory:!0,patch:!0}).then((function(){t.target.dataset.dynamicWidth&&e.renderSidebarTexts()}))}}else t.target.value=n},toogleSettings:function(){this.isHiddenSettings=!this.isHiddenSettings,this.settingsPanel&&(this.settingsPanel.isHidden=this.isHiddenSettings)},getSettingsData:function(){var t={};if(this.cartWidgetData){var e=n.Z.clone(this.cartWidgetData);t={"bar-color":e["bar-color"],"bar-color-opacity":e["bar-color-opacity"],"bar-background-color":e["bar-background-color"],"bar-background-color-opacity":e["bar-background-color-opacity"],"bar-shadow":e["bar-shadow"],"bar-font-family":e["bar-font-family"],"bar-font-style":e["bar-font-style"],"bar-font-weight":e["bar-font-weight"],"bar-letter-spacing":e["bar-letter-spacing"]}}return{isHidden:this.isHiddenSettings,model:t,onOverlayClick:this.onSettingsOverlayClick.bind(this)}},setupSettingsPanel:function(){},onSettingsOverlayClick:function(){this.toogleSettings()},onModelChange:function(t){this.saveModelChanges_debounced(t)},saveModelChanges:function(t){var e=this;this.updateCartWidgetData(t),this.generateSidebarCSS(this.cartWidgetData),this.cartWidgetModel&&this.cartWidgetModel.save(t,{toHistory:!1,skipHistory:!0,patch:!0}).then((function(){e.renderSidebarTexts()}))},updateCartWidgetData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.cartWidgetData=w(w({},this.cartWidgetData),t)},destroy:function(){if(this.rendered)return this.mag.eCommerceManager.events.off("ecommerce:cartsidebar:visibility:changed"),this.mag.eCommerceManager.events.off("ecommerce:cartdata:changed"),this.$items.find(".cart-item-remove-btn").each((function(t,e){(0,r.Z)(e).off("click")})),this.unbindDomEvents(),this.settingsPanel&&(this.settingsPanel.$off("change",this.onModelChange),this.settingsPanel.$destroy()),this.$settingButton&&this.$settingButton.off("click",this.toogleSettings),this.environment===m.ZP.environment.preview&&this.unbindTextInputsEvents(),(0,r.Z)("#".concat(this.stylesElementId)).remove(),this.remove()},cartItemBlockHover:function(t){var e=(0,r.Z)(t.currentTarget);e&&e.length&&(e.addClass("hover").siblings().removeClass("hover"),this.hoveredItem=e.data("price-id")||e.data("sku-id"))},cartItemBlockLeave:function(t){var e=(0,r.Z)(t.currentTarget);e&&e.length&&(e.removeClass("hover"),(e.data("price-id")||e.data("sku-id"))===this.hoveredItem&&(this.hoveredItem=null))}});e.Z=P},1070:function(t,e,i){"use strict";var n=i(321),r=i(312),a=i(957),o=i.n(a),s=i(678),c=i(891),l=i.n(c),d=i(1071),u=i(1072),h=i(340),p=i(342),f=i(308),g=i(1074),m=i(1073),v=i(886),y=i(347);function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(t,e,i,n,r,a,o){try{var s=t[a](o),c=s.value}catch(t){return void i(t)}s.done?e(c):Promise.resolve(c).then(n,r)}function S(t){return function(){var e=this,i=arguments;return new Promise((function(n,r){var a=t.apply(e,i);function o(t){w(a,n,r,o,s,"next",t)}function s(t){w(a,n,r,o,s,"throw",t)}o(void 0)}))}}function P(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function k(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?P(Object(i),!0).forEach((function(e){C(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):P(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function C(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var x,O,T,_,Z,M,I,$,E,D,L,j,A,R=f.ZP.stripe_live?f.ZP.STRIPE_LIVE_PUBLIC_KEY:f.ZP.STRIPE_TEST_PUBLIC_KEY,F=Backbone.View.extend({template:u.Z["template-viewer-cart-sidebar"],cardStyle:{base:{letterSpacing:"0.3px",color:"#0080FF",fontSize:"16px",fontFamily:"-apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Ubuntu, 'Fira Sans', Roboto, 'Avenir Next', 'Helvetica Neue', Helvetica, Arial, sans-serif","::placeholder":{color:"#CFD7DF"},fontSmoothing:"antialiased"},invalid:{color:"#e5424d",":focus":{color:"#303238"}}},getRenderStatus:function(){return this.rendered},initialize:function(t){return n.Z.bindAll(this),this.mag=t,this.environment=this.mag.router.environment,this.rendered=!1,this.haveSkus=!1,this.havePrices=!1,this.checkoutCompete=!1,this.isHiddenSettings=!0,this.activeTab="tab-items",this.orderLoading=!1,this.paymentLoading=!1,this.hoveredItem=null,this.shippingForm={name:{value:null,error:null,validationRules:[{title:"required"}]},phone:{value:null,error:null,validationRules:[{title:"phoneNumber"}]},line1:{value:null,error:null,validationRules:[{title:"required"}]},line2:{value:null,error:null,validationRules:[]},city:{value:null,error:null,validationRules:[{title:"required"}]},state:{value:null,error:null,validationRules:[]},country:{value:"default",error:null,validationRules:[{title:"required",func:function(t,e){return"default"===e?"field is required":null}}]},postal_code:{value:null,error:null,validationRules:[]},email:{value:null,error:null,validationRules:[{title:"required"},{title:"email"}]},note:{value:null,error:null,validationRules:[]}},this.cardHolderNameValue=null,this.clearShippingFormField_debounced=n.Z.debounce(this.clearShippingFormField,200),this.render(),this},render:function(){if(!RM.screenshot){var t=RM.viewerRouter?RM.viewerRouter.getUserPermissions():RM.constructorRouter.me.get("permissions");if(t&&t.can_use_e_commerce&&!this.mag.eCommerceManager.isConstructor()&&this.mag.eCommerceManager.haveEcommerceCartWidget&&this.mag.eCommerceManager.isMagConnectedTo("stripe")&&!this.rendered){this.rendered=!0,document.querySelectorAll("#cart-sidebar").length&&document.querySelectorAll("#cart-sidebar").forEach((function(t){return t.parentNode.removeChild(t)})),this.setElement(this.template({isMobile:(0,d.isMobile)(),isViewer:this.environment===f.ZP.environment.viewer,imgPublicPath:y.folderImagesPath})),this.$el.appendTo((0,r.Z)("body")),this.$toolbar=(0,r.Z)(".toolbar.for-viewer"),this.$tabs=this.$el.find(".cart-sidebar-tabs"),this.$items=this.$el.find(".cart-items-list"),this.$closeButton=this.$el.find(".close-button"),this.$footer=this.$el.find(".sidebar-footer"),this.$navButtons=this.$el.find(".sidebar-btn"),this.$calcTextContainer=this.$el.find(".text-size-calc-container"),this.$itemsTab=this.$tabs.find(".tab-items"),this.$shippingTab=this.$tabs.find(".tab-inputs"),this.$orderTab=this.$tabs.find(".tab-order"),this.$paymentTab=this.$tabs.find(".tab-checkout"),this.$goToPayment=this.$orderTab.find(".cart-pay-btn"),this.$orderDetails=this.$orderTab.find(".order-details"),this.$orderItems=this.$orderTab.find(".order-items-list"),this.$orderError=this.$orderTab.find(".order-error"),this.$orderShippingAddress=this.$orderTab.find(".order-shipping-address"),this.$orderShippingMethod=this.$orderTab.find(".order-shipping-method"),this.$orderShippingEmail=this.$orderTab.find(".order-shipping-email"),this.$orderTax=this.$orderTab.find(".order-tax"),this.$orderTotalPrice=this.$orderTab.find(".order-total-price"),this.$paymentSuccess=this.$tabs.find("#payment-success-msg"),this.$paymentFailed=this.$tabs.find("#payment-failed-msg"),this.cartWidgetData=this.mag.eCommerceManager.getCartWidgetData(),this.environment===f.ZP.environment.preview&&(this.cartWidgetData&&this.cartWidgetData._id&&this.setupSettingsPanel(),window.RM.constructorRouter.on("previewClose",this.closeSideBar.bind(this)),this.bindTextInputsEvents());var e=this.$el.find(".svg");return o()(e),this.$el.find("[data-alt]:not(.rmalttext)").RMAltText(),this.generateSidebarCSS(this.cartWidgetData),this.renderSidebarTexts(),this.renderCartItems(),this.renderShippingForm(),this.initNavigation(),this.bindDomEvents(),p.Z.on("ecommerce:cartsidebar:visibility:changed",this.toggleSidebar),this.mag.eCommerceManager.events.on("ecommerce:cartdata:changed",this.renderCartItems),this}}},bindDomEvents:function(){this.$closeButton.on("click",this.closeSideBar.bind(this)),this.$tabs.find(".cart-cancel-btn").on("click",this.cancelOrder.bind(this)),(0,r.Z)(document).on("mouseover",".cart-sidebar .sidebar-body .cart-item-block",this.cartItemBlockHover),(0,r.Z)(document).on("mouseleave",".cart-sidebar .sidebar-body .cart-item-block",this.cartItemBlockLeave),this.bindStaticTextFieldsHovers()},unbindDomEvents:function(){this.$closeButton.off("click",this.closeSideBar),this.$tabs.find(".cart-cancel-btn").off("click",this.cancelOrder),(0,r.Z)(document).off("mouseover",".cart-sidebar .sidebar-body .cart-item-block",this.cartItemBlockHover),(0,r.Z)(document).off("mouseleave",".cart-sidebar .sidebar-body .cart-item-block",this.cartItemBlockLeave)},bindStaticTextFieldsHovers:function(){this.environment===f.ZP.environment.preview&&(this.$itemsTab.find(".cart-title-input, .empty-cart-title-input").on("mouseover",(function(t){(0,r.Z)(t.target).addClass("active")})),this.$itemsTab.find(".cart-title-input, .empty-cart-title-input").on("mouseleave",(function(t){(0,r.Z)(t.target).is(":focus")||(0,r.Z)(t.target).removeClass("active")})),this.$itemsTab.find(".сheck-out-btn").on("mouseover",(function(t){(0,r.Z)(t.target).find(".cart-checkout-input").addClass("active")})),this.$itemsTab.find(".сheck-out-btn").on("mouseleave",(function(t){var e=(0,r.Z)(t.target).find(".cart-checkout-input");e.is(":focus")||e.removeClass("active")})))},hideSidebar:function(){this.$el.removeClass("show"),(0,r.Z)("body").removeClass("cart-sidebar-shown"),(0,r.Z)("html").removeClass("cart-disable-scroll"),!this.isHiddenSettings&&this.settingsPanel&&(this.isHiddenSettings=!0,this.settingsPanel.isHidden=this.isHiddenSettings)},toggleSidebar:function(t){t?(this.hideSidebar(),this.checkoutCompete&&(this.mag.eCommerceManager.clearCart(),this.goToInitialTab(),this.hideSuccessPaymentMessage(),this.$paymentFailed.empty()),this.clearOrderError()):(this.$el.addClass("show"),(0,r.Z)("body").addClass("cart-sidebar-shown"),(0,r.Z)("html").addClass("cart-disable-scroll"))},closeSideBar:function(){this.mag.eCommerceManager.isCartSidebarHidden||this.mag.eCommerceManager.changeCartSidebarVisibility()},initNavigation:function(){this.$tabs.find("[data-tab^='tab-']").each(function(t,e){(0,r.Z)(e).on("click",function(t){if(!t.isDefaultPrevented())if(this.haveSkus&&this.havePrices)window.alert("You can't buy all these products, try separately");else if(this.haveSkus||this.havePrices){if("tab-inputs"===e.dataset.tab&&(this.updateShippingForm(),RM.analytics&&RM.analytics.sendEvent("Checkout 1st step completed")),"tab-order"===e.dataset.tab){if(!this.validateShippingForm())return void this.renderShippingFormErrors();this.clearShippingFormErrors(),RM.analytics&&RM.analytics.sendEvent("Checkout 2nd step completed");var i,r,a=this.mag.eCommerceManager.getShippingForm();a&&(i=n.Z.mapObject(a,(function(t){return{value:t.value}})),r=n.Z.mapObject(this.shippingForm,(function(t){return{value:t.value}}))),(!a||a&&!n.Z.isEqual(i,r))&&(this.mag.eCommerceManager.setShippingForm(this.shippingForm),this.havePrices&&(this.needForUpdateCustomer=!0)),this.haveSkus&&this.renderOrderTab(),this.havePrices&&this.renderOrderTabForPrices()}"tab-checkout"===e.dataset.tab&&(RM.analytics&&RM.analytics.sendEvent("Checkout 3rd step completed"),this.haveSkus&&this.renderCheckoutForm(),this.havePrices&&this.renderCheckoutFormPaymentIntent()),this.goToTabByClassname("."+e.dataset.tab)}}.bind(this))}.bind(this))},goToTabByClassname:function(t){this.$tabs.find(".cart-sidebar-tab").each((function(t,e){(0,r.Z)(e).removeClass("active")})),this.$tabs.find(t).addClass("active"),this.activeTab=t.slice(1)},goToInitialTab:function(){this.goToTabByClassname(".tab-items")},generateSidebarCSS:function(t){var e="cart_sidebar_styles_".concat(t._id),i=h.default.getRGBA(t["bar-color"],t["bar-color-opacity"]/100),n=h.default.getRGBA(t["bar-background-color"],t["bar-background-color-opacity"]/100),a=h.default.getRGBA(t["bar-color"],.45*t["bar-color-opacity"]/100),o=this.getAdditionalColor(n);this.cardStyle=k(k({},this.cardStyle),{},{base:k(k({},this.cardStyle.base),{},{color:i,fontWeight:t["bar-font-weight"],"::placeholder":{color:a}}),invalid:k(k({},this.cardStyle.invalid),{},{color:a,fontWeight:t["bar-font-weight"],":focus":{color:i},"::placeholder":{color:a}})});var c="    .cart-sidebar {\n\n      color: ".concat(i,";\n      background-color: ").concat(n,";\n      box-shadow: ").concat(t["bar-shadow"]?"0 0 4px rgba(124, 124, 125, 0.5)":"none",";\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar textarea {\n\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar input {\n\n      color: ").concat(i,";\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar input::placeholder {\n\n      color: ").concat(a,";\n    }\n\n    .cart-sidebar .cart-title-input.active {\n\n      border-color: ").concat((0,s.transparentize)(.8,i),";\n    }\n\n    .cart-sidebar .empty-cart-title-input.active {\n\n      border-color: ").concat((0,s.transparentize)(.8,i),";\n    }\n\n    .cart-sidebar .cart-price-input.active, .cart-sidebar .cart-quantity-input.active {\n\n      border-color: ").concat((0,s.transparentize)(.2,a),";\n    }\n\n    .cart-sidebar .cart-checkout-input.active {\n\n      border-color: ").concat((0,s.transparentize)(.8,i),";\n    }\n\n    .cart-sidebar .cart-price-input {\n\n      color: ").concat(a,";\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar .cart-quantity-input {\n\n      color: ").concat(a,";\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar button {\n\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar select {\n\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar .sidebar-btn {\n\n      color: ").concat(i,";\n      border-color: ").concat(a,";\n    }\n\n    .cart-sidebar .preloader svg path {\n\n      stroke: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-btn path {\n\n      fill: ").concat(i,";\n    }\n\n    .cart-sidebar .expand-arrow svg path {\n\n      fill: ").concat(i,";\n    }\n\n    .cart-sidebar .cart-cancel-btn {\n\n      color: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block.hover {\n\n      background-color: ").concat(o,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-attributes {\n\n      color: ").concat(a,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-price {\n\n      color: ").concat(a,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-items-quantity {\n\n      color: ").concat(a,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-remove-btn-icon path {\n\n      fill: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-decrease-btn-icon rect {\n\n      fill: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-increase-btn-icon path {\n\n      fill: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .order-details-form, .cart-sidebar .sidebar-body .order-details-form .form-input {\n\n      color: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .order-details-form .form-input::placeholder {\n\n      color: ").concat(a,";\n    }\n\n    .cart-sidebar .sidebar-body .order-details-form .rm-native-fake-select {\n\n      color: ").concat(a,";\n    }\n\n    .cart-sidebar .sidebar-body .order-details-form .rm-native-fake-select.selected {\n\n      color: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .order-details-form svg path {\n\n      fill: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .order-details-form .form-title {\n\n      color: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .form-error {\n\n      background-color: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .order-details-form .rm-native-select-popup {\n\n      background-color: ").concat(o,";\n    }\n\n    .cart-sidebar .tab-order .order-details .order-title-row {\n\n      color: ").concat(a,";\n    }\n\n    .cart-sidebar .tab-order .order-details .rm-native-fake-select {\n\n      color: ").concat(i,";\n    }\n\n    .cart-sidebar .tab-checkout .payment-input {\n\n      color: ").concat(i,";\n    }\n\n    .cart-sidebar .tab-checkout .payment-input::placeholder {\n\n      color: ").concat(a,";\n    }\n\n    .cart-sidebar .tab-checkout #payment-failed-msg .error-icon {\n\n      border-color: ").concat(a,";\n    }\n\n    .cart-sidebar .tab-checkout #payment-failed-msg .error-icon svg g {\n\n      fill: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-settings-container .settings-button path {\n\n      stroke: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-settings-container .settings-button:hover path {\n\n      stroke: ").concat(a,";\n    }\n\n    .cart-sidebar.cart-is-mobile .sidebar-body .cart-item-block {\n\n      background-color: ").concat(o,";\n    }");(0,r.Z)("#".concat(e)).remove();var l=document.createElement("style");l.type="text/css",l.id=e,l.className="cart-sidebar-styles",l.appendChild(document.createTextNode(c)),document.querySelector("head").appendChild(l)},getAdditionalColor:function(t){return(0,s.getLuminance)(t)<.05&&(0,s.getContrast)("#fff",t)-(0,s.getContrast)("#000",t)>=8?(0,s.lighten)(.1,t):(0,s.darken)(.1,t)},renderCartItems:function(){var t=this.mag.eCommerceManager.getCartData();if(t&&t.skus){var e=Object.keys(t.skus),i=Object.keys(t.prices);this.$items.empty(),this.haveSkus=!!e.length,this.havePrices=!!i.length,this.haveSkus||this.havePrices?(this.$itemsTab.find(".сheck-out-btn").css("display","block"),this.$itemsTab.find(".empty-cart").css("display","none")):(this.$itemsTab.find(".сheck-out-btn").css("display","none"),this.$itemsTab.find(".empty-cart").css("display","flex")),this.renderPricesCartItems(i),this.renderSkusCartItems(e);var n=this.$items.find(".svg");o()(n),this.renderSidebarTexts(),this.unbindTextInputsEvents(!0),this.bindTextInputsEvents(!0)}},renderCartItem:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"price",n=this.hoveredItem===t.id,a=(0,r.Z)("<div/>",{class:"cart-item-block".concat(n?" hover":"")});a.data("".concat(i,"-id"),t.id);var o=t.image||t.productObject.images&&t.productObject.images.length;if(o){var s=t.image?t.image:t.productObject.images?t.productObject.images[0]:"";e=(0,r.Z)("<div/>",{class:"cart-item-image",css:{"background-position":"center center","background-size":"cover","background-repeat":"no-repeat","background-image":"url(".concat(s,")")}}),a.append(e)}var c=(0,r.Z)("<div/>",{class:e?"cart-item-title":"cart-item-title without-image"}).text(t.productObject.name),l=t.cart_count,d=(("price"===i?t.unit_amount:t.price)/100).toFixed(2),u=(0,g.x)(d,t.currency),p=(0,g.x)((d*l).toFixed(2),t.currency),f=(0,r.Z)("<div/>",{class:"cart-item-price"}),m=(0,r.Z)("<input/>",{type:"text",class:"cart-text-input cart-price-input",name:"price",placeholder:"Price",maxlength:"32",translate:"no",autocomplete:"no",autocorrect:"no",spellcheck:"false"});m.get(0).dataset.dynamicWidth=!0;var v,b=(0,r.Z)("<span/>").html(l>1?": ".concat(u," × ").concat(l," = ").concat(p):": ".concat(u));if(f.append(m).append(b),"sku"===i){v=(0,r.Z)("<div/>",{class:"cart-item-attributes"});var w=t.attributes;for(var S in w){var P=(0,r.Z)("<div/>",{class:"cart-item-attribute"}).html("".concat(h.default.capitalize(S),": ").concat(w[S]));v.append(P)}}var k=(0,r.Z)("<div/>",{class:"cart-items-quantity"}),C=(0,r.Z)("<input/>",{type:"text",class:"cart-text-input cart-quantity-input",name:"quantity",placeholder:"Quantity",maxlength:"32",translate:"no",autocomplete:"no",autocorrect:"no",spellcheck:"false"});C.get(0).dataset.dynamicWidth=!0;var x=(0,r.Z)("<span/>").html(": ".concat(l));k.append(C).append(x);var O=(0,r.Z)("<div/>",{class:"cart-item-remove-btn",title:"remove"}).attr("data-".concat(i,"-id"),t.id),T=(0,r.Z)("<img/>",{class:"svg cart-item-remove-btn-icon",src:(0,y.findImagePath)("./viewer/cart-sidebar/cart-item-delete.svg")});O.append(T),O.on("click",this.onRemoveItem);var _=(0,r.Z)("<div/>",{class:"cart-item-edit-group"}),Z=(0,r.Z)("<div/>",{class:"cart-item-increase-btn"}).attr("data-".concat(i,"-id"),t.id),M=(0,r.Z)("<img/>",{class:"svg cart-item-increase-btn-icon",src:(0,y.findImagePath)("./viewer/cart-sidebar/cart-item-increase.svg")});if(Z.append(M),_.append(Z),("price"===i||this.mag.eCommerceManager.checkItemQuantity(t.id))&&(Z.addClass("active"),Z.on("click",this.onIncreaseItem)),l>1){var I=(0,r.Z)("<div/>",{class:"cart-item-decrease-btn decrease-btn-".concat(t.id)}).attr("data-".concat(i,"-id"),t.id),$=(0,r.Z)("<img/>",{class:"svg cart-item-decrease-btn-icon",src:(0,y.findImagePath)("./viewer/cart-sidebar/cart-item-decrease.svg")});I.append($),_.append(I),I.on("click",this.onDecreaseItem)}else{var E=this.$items.find("decrease-btn-".concat(t.id));E.off("click",this.onDecreaseItem),E.remove()}"price"===i?a.append(c).append(f).append(k).append(O).append(_):a.append(c).append(v).append(f).append(k).append(O).append(_),this.$items.append(a)},renderPricesCartItems:function(t){var e=this,i=this.mag.eCommerceManager.getCartData();t.forEach((function(t){var n=i.prices[t];n.active&&e.renderCartItem(n)}))},renderSkusCartItems:function(t){var e=this,i=this.mag.eCommerceManager.getCartData();t.forEach((function(t){var n=i.skus[t];n.active&&e.renderCartItem(n,"sku")}))},onRemoveItem:function(t){t.currentTarget.dataset.priceId?this.mag.eCommerceManager.removeFromCart(t.currentTarget.dataset.priceId):t.currentTarget.dataset.skuId&&this.mag.eCommerceManager.removeSkuFromCart(t.currentTarget.dataset.skuId)},onIncreaseItem:function(t){t.currentTarget.dataset.priceId?this.mag.eCommerceManager.increaseCartItem(t.currentTarget.dataset.priceId):t.currentTarget.dataset.skuId&&this.mag.eCommerceManager.increaseSkuCartItem(t.currentTarget.dataset.skuId)},onDecreaseItem:function(t){t.currentTarget.dataset.priceId?this.mag.eCommerceManager.decreaseCartItem(t.currentTarget.dataset.priceId):t.currentTarget.dataset.skuId&&this.mag.eCommerceManager.decreaseSkuCartItem(t.currentTarget.dataset.skuId)},getTextFieldModelKey:function(t){return"bar-".concat(t)},getSidebarTextValue:function(t){var e=this.getTextFieldModelKey(t);return this.cartWidgetData&&this.cartWidgetData[e]?l()(this.cartWidgetData[e]):f.ZP.defaultSidebarTexts[t]?f.ZP.defaultSidebarTexts[t]:null},calcTextFieldSize:function(t){if(!t)return null;var e=getComputedStyle(t);this.$calcTextContainer.css({"font-family":e.fontFamily,"font-size":e.fontSize,"font-style":e.fontStyle,"font-weight":e.fontWeight,"letter-spacing":e.letterSpacing}),this.$calcTextContainer.text(t.value);var i=this.$calcTextContainer.width();return Math.ceil(i)},renderSidebarTexts:function(){var t=this;this.$itemsTab.find(".cart-text-input").each((function(e,i){var n=i.getAttribute("name"),r=t.getSidebarTextValue(n);if(r&&(i.value=r,i.dataset.dynamicWidth)){var a=t.calcTextFieldSize(i);a&&(i.style.width="".concat(a,"px"))}}))},bindTextInputsEvents:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$itemsTab.find(".cart-text-input"+(e?'[data-dynamic-width="true"]':"")).each((function(e,i){(0,r.Z)(i).on("click",t.onTextFieldClick),(0,r.Z)(i).on("input",t.onTextFieldChange),(0,r.Z)(i).on("focus",t.onTextFieldFocus),(0,r.Z)(i).on("blur",t.onTextFieldBlur)})),e&&this.environment===f.ZP.environment.preview&&(this.$itemsTab.find(".cart-item-block").on("mouseover",this.onDynamicMouseOver),this.$itemsTab.find(".cart-item-block").on("mouseleave",this.onDynamicMouseLeave))},unbindTextInputsEvents:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$itemsTab.find(".cart-text-input"+(e?'[data-dynamic-width="true"]':"")).each((function(e,i){(0,r.Z)(i).off("click",t.onTextFieldClick),(0,r.Z)(i).off("input",t.onTextFieldChange),(0,r.Z)(i).off("focus",t.onTextFieldFocus),(0,r.Z)(i).off("blur",t.onTextFieldBlur)})),e&&this.environment===f.ZP.environment.preview&&(this.$itemsTab.find(".cart-item-block").off("mouseover",this.onDynamicMouseOver),this.$itemsTab.find(".cart-item-block").off("mouseleave",this.onDynamicMouseLeave))},onDynamicMouseOver:function(t){(0,r.Z)(t.target).find(".cart-price-input, .cart-quantity-input").addClass("active")},onDynamicMouseLeave:function(t){(0,r.Z)(t.target).find(".cart-price-input, .cart-quantity-input").each((function(){(0,r.Z)(this).is(":focus")||(0,r.Z)(this).removeClass("active")}))},onTextFieldClick:function(t){t.preventDefault()},onTextFieldChange:function(t){if(t.target.dataset.dynamicWidth){var e=this.calcTextFieldSize(t.target);e&&(t.target.style.width="".concat(e,"px"))}},onTextFieldFocus:function(t){this.environment===f.ZP.environment.preview&&(0,r.Z)(t.target).addClass("active")},onTextFieldBlur:function(t){var e=this;this.environment===f.ZP.environment.preview&&(0,r.Z)(t.target).removeClass("active");var i=t.target.getAttribute("name"),n=this.getSidebarTextValue(i);if(n)if(t.target.value){if(this.cartWidgetModel){var a=C({},this.getTextFieldModelKey(i),t.target.value);this.updateCartWidgetData(a),this.cartWidgetModel.save(a,{toHistory:!1,skipHistory:!0,patch:!0}).then((function(){t.target.dataset.dynamicWidth&&e.renderSidebarTexts()}))}}else t.target.value=n},renderShippingForm:(A=S(regeneratorRuntime.mark((function t(){var e,a,o,s,c,l,d,u,h=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(e=n.Z.clone(m.h)).unshift({value:"default",caption:"Country"}),a=this.mag.eCommerceManager.getCartData(),(o=a.shippingForm)&&"object"===b(o)&&(this.shippingForm=o),t.next=7,i.e(25).then(i.bind(i,1146));case 7:return s=t.sent,c=s.default,t.next=11,Promise.resolve().then(i.bind(i,344));case 11:l=t.sent,d=l.default,u=d.extend(c),this.countrySelect=new u({el:this.$tabs.find(".countries-select").get(0),propsData:{options:function(){return e},value:this.shippingForm.country.value,isDesktop:!1,callback:this.onCountryChange}}),this.mag.eCommerceManager.hasShippableProducts()?this.$shippingTab.find(".shipping-form").removeClass("hidden"):this.$shippingTab.find(".shipping-form").addClass("hidden"),this.$tabs.find(".order-details-form .form-input").each((function(t,e){var i=e.getAttribute("name");h.shippingForm[i]&&(e.value=h.shippingForm[i].value),(0,r.Z)(e).on("input",h.onShippingFormChange)}));case 17:case"end":return t.stop()}}),t,this)}))),function(){return A.apply(this,arguments)}),updateShippingForm:function(){var t=this.mag.eCommerceManager.getShippingForm();t&&"object"===b(t)&&(this.shippingForm=t),this.mag.eCommerceManager.hasShippableProducts()?this.$shippingTab.find(".shipping-form").removeClass("hidden"):this.$shippingTab.find(".shipping-form").addClass("hidden")},onCountryChange:function(t){this.shippingForm.country.value=t,this.countrySelect.value=t,this.clearShippingFormField_debounced("country")},onShippingFormChange:function(t){var e=t.target.getAttribute("name");void 0!==this.shippingForm[e]&&"object"===b(this.shippingForm[e])&&(this.shippingForm[e].value=t.target.value,this.clearShippingFormField_debounced(e))},renderShippingFormErrors:function(){var t=this;Object.keys(this.shippingForm).forEach((function(e){t.shippingForm[e].error&&t.$shippingTab.find(".form-error.".concat(e,"-error")).removeClass("hidden")}))},clearShippingFormErrors:function(){var t=this;Object.keys(this.shippingForm).forEach((function(e){t.$tabs.find(".form-error.".concat(e,"-error")).addClass("hidden")}))},clearShippingFormField:function(t){if(void 0!==this.shippingForm[t]&&this.shippingForm[t].error){var e=this.validateShippingFormField(t);e&&e.success&&(this.$tabs.find(".form-error.".concat(t,"-error")).addClass("hidden"),this.shippingForm[t].error=null)}},validateShippingFormField:function(t){var e=this,i=[];if(void 0!==this.shippingForm[t])return this.shippingForm[t].validationRules.length?(this.shippingForm[t].validationRules.forEach((function(n){if("function"==typeof n.func){var r=n.func(t,e.shippingForm[t].value);r&&i.push(r)}else{var a=e["".concat(n.title,"Validation")](t,e.shippingForm[t].value);a&&i.push(a)}})),i.length?{success:!1,error:!0,errorMessages:i}:{success:!0}):{success:!0}},requiredValidation:function(t,e){return e?null:"field is required"},emailValidation:function(t,e){return e?h.default.isValidEmail(e)?null:"it's not email":null},phoneNumberValidation:function(t,e){return e?h.default.isValidPhoneNumber(e)?null:"it's not  phone number":null},validateShippingForm:function(){var t=!1;if(this.mag.eCommerceManager.hasShippableProducts())for(var e in this.shippingForm){var i=this.validateShippingFormField(e);i&&(i.success?this.shippingForm[e].error=null:(this.shippingForm[e].error=i.errorMessages,t=!0))}else{var n=this.validateShippingFormField("email");n&&(n.success?this.shippingForm.email.error=null:(this.shippingForm.email.error=n.errorMessages,t=!0))}return!t},renderOrderTab:function(){var t=this;this.clearOrderError();var e=this.mag.eCommerceManager.getCartData(),i=e.order;if(i&&i.created<Math.floor(Date.parse(e.changed)/1e3))return this.showOrderLoader(),void this.mag.eCommerceManager.cancelOrder().then((function(e){e.data&&"canceled"===e.data.status&&(t.mag.eCommerceManager.deleteOrder(),t.createOrder())})).catch((function(e){t.hideOrderLoader(),t.renderOrderError(e&&e.message?e.message:""),t.mag.eCommerceManager.deleteOrder()}));i?this.renderOrderDetails():this.createOrder()},renderOrderTabForPrices:(j=S(regeneratorRuntime.mark((function t(){var e,i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.clearOrderError(),this.showOrderLoader(),t.next=4,this.getCustomer();case 4:if(!(e=t.sent)){t.next=42;break}return t.next=8,this.getInvoiceItemsForCustomer(e.id);case 8:if(!t.sent){t.next=42;break}return t.next=12,this.getInvoiceForCustomer(e.id);case 12:if(!(i=t.sent)){t.next=42;break}if(!(i.created<Math.floor(Date.parse(this.mag.eCommerceManager.getCartData().changed)/1e3))){t.next=41;break}if(!this.needForUpdateCustomer){t.next=19;break}return t.next=18,this.updateOrCreateCustomer();case 18:this.needForUpdateCustomer=!1;case 19:return t.prev=19,t.next=22,this.cancelInvoice(i);case 22:t.next=29;break;case 24:return t.prev=24,t.t0=t.catch(19),this.renderOrderError("can't cancel old order"),this.hideOrderLoader(),t.abrupt("return");case 29:return t.prev=29,t.next=32,this.createInvoiceWithItems();case 32:(n=t.sent)&&this.renderInvoiceDetails(n),t.next=39;break;case 36:t.prev=36,t.t1=t.catch(29),this.renderOrderError("can't create order");case 39:t.next=42;break;case 41:this.renderInvoiceDetails(i);case 42:this.hideOrderLoader();case 43:case"end":return t.stop()}}),t,this,[[19,24],[29,36]])}))),function(){return j.apply(this,arguments)}),renderInvoiceDetails:(L=S(regeneratorRuntime.mark((function t(e){var i,n,a,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.$orderItems.empty(),this.$orderShippingAddress.empty(),this.$orderShippingMethod.empty(),this.$orderShippingEmail.empty(),this.$orderTax.empty(),this.$orderTotalPrice.empty(),e.lines.data.forEach((function(t){var e=(0,r.Z)("<div/>",{class:"order-item"}).html(t.quantity+" × "+t.description),i=(0,r.Z)("<div/>",{class:"order-item-price"}).text((0,g.x)((t.amount/100).toFixed(2),t.currency));e.append(i),o.$orderItems.append(e)})),e.customer_shipping&&e.customer_shipping.address&&(i=function(t){return t?" ".concat(t):""},n=e.customer_shipping.address,a="".concat(n.line1).concat(i(n.line2)," ").concat(n.city,",").concat(i(n.state)).concat(i(n.postal_code)," ").concat(n.country),this.$orderShippingAddress.text(a),this.$tabs.find(".shipping-details").removeClass("hidden")),this.$orderShippingMethod.parent(".shipping-method.order-row").addClass("hidden"),this.$orderDetails.find(".order-id").text(String(e.id).slice(0,20)+"..."),this.$orderShippingEmail.text(e.customer_email),this.$orderDetails.find(".shipping-email").removeClass("hidden"),e.customer_phone?(this.$orderDetails.find(".order-shipping-phone").text(e.customer_phone),this.$orderDetails.find(".shipping-phone").removeClass("hidden")):this.$orderDetails.find(".shipping-phone").addClass("hidden"),e.tax?(this.$orderTax.parent(".shipping-tax-size.order-row").removeClass("hidden"),this.$orderTax.text((0,g.x)((e.tax/100).toFixed(2),e.currency))):this.$orderTax.parent(".shipping-tax-size.order-row").addClass("hidden"),this.$orderTotalPrice.text((0,g.x)((e.total/100).toFixed(2),e.currency)),this.$goToPayment.removeClass("hidden");case 16:case"end":return t.stop()}}),t,this)}))),function(t){return L.apply(this,arguments)}),getCustomer:(D=S(regeneratorRuntime.mark((function t(){var e,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((e=this.mag.eCommerceManager.getCartData()).customer){t.next=17;break}return t.prev=2,t.next=5,this.mag.eCommerceManager.createOrUpdateCustomer(this.mag.num_id,this.generateCustomerDataFromShippingForm(e.shippingForm));case 5:if(!(i=t.sent)||!i.data){t.next=9;break}return this.mag.eCommerceManager.setCustomer(i.data),t.abrupt("return",i.data);case 9:t.next=15;break;case 11:throw t.prev=11,t.t0=t.catch(2),console.error(t.t0),t.t0;case 15:t.next=18;break;case 17:return t.abrupt("return",e.customer);case 18:case"end":return t.stop()}}),t,this,[[2,11]])}))),function(){return D.apply(this,arguments)}),updateOrCreateCustomer:(E=S(regeneratorRuntime.mark((function t(){var e,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.mag.eCommerceManager.getCartData(),t.next=3,this.mag.eCommerceManager.createOrUpdateCustomer(this.mag.num_id,this.generateCustomerDataFromShippingForm(e.shippingForm));case 3:if(!(i=t.sent)||!i.data){t.next=7;break}return this.mag.eCommerceManager.setCustomer(i.data),t.abrupt("return",i.data);case 7:case"end":return t.stop()}}),t,this)}))),function(){return E.apply(this,arguments)}),generateCustomerDataFromShippingForm:function(t){var e={email:t.email.value,name:t.name.value,shipping:{address:{country:t.country.value,city:t.city.value,line1:t.line1.value},name:t.name.value}};return t.phone.value&&(e.phone=t.phone.value,e.shipping.phone=t.phone.value),t.line2.value&&(e.shipping.address.line2=t.line2.value),t.postal_code.value&&(e.shipping.address.postal_code=t.postal_code.value),t.state.value&&(e.shipping.address.state=t.state.value),e},getInvoiceItemsForCustomer:($=S(regeneratorRuntime.mark((function t(e){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((i=this.mag.eCommerceManager.getCartData()).invoiceItems&&i.invoiceItems.length>0)){t.next=5;break}return t.abrupt("return",i.invoiceItems);case 5:return t.next=7,this.createInvoiceItemsForCustomer(e);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return $.apply(this,arguments)}),createInvoiceItemsForCustomer:(I=S(regeneratorRuntime.mark((function t(e){var i,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.mag.eCommerceManager.getCartData(),n=Object.keys(i.prices).map((function(t){return{price:i.prices[t].id,quantity:i.prices[t].cart_count}})),t.prev=2,t.next=5,this.mag.eCommerceManager.createInvoiceItems(this.mag.num_id,e,n);case 5:if(!((r=t.sent)&&r.data&&r.data.length)){t.next=9;break}return this.mag.eCommerceManager.setInvoiceItems(r.data),t.abrupt("return",r.data);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),console.error(t.t0);case 14:case"end":return t.stop()}}),t,this,[[2,11]])}))),function(t){return I.apply(this,arguments)}),getInvoiceForCustomer:(M=S(regeneratorRuntime.mark((function t(e){var i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=this.mag.eCommerceManager.getCartData()).invoice||!i.invoice.id){t.next=15;break}return t.next=4,this.mag.eCommerceManager.getInvoice(this.mag.num_id,i.invoice.id);case 4:if(!(n=t.sent)||"draft"!==n.status&&"open"!==n.status){t.next=10;break}return this.mag.eCommerceManager.setInvoice(n),t.abrupt("return",n);case 10:return t.next=12,this.createInvoiceForCustomer(e);case 12:return t.abrupt("return",t.sent);case 13:t.next=18;break;case 15:return t.next=17,this.createInvoiceForCustomer(e);case 17:return t.abrupt("return",t.sent);case 18:case"end":return t.stop()}}),t,this)}))),function(t){return M.apply(this,arguments)}),createInvoiceForCustomer:(Z=S(regeneratorRuntime.mark((function t(e){var i,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.mag.eCommerceManager.getCartData(),n={customer:e,collection_method:"charge_automatically",auto_advance:!1},i.shippingForm&&i.shippingForm.note.value&&(n.metadata={customer_note:i.shippingForm.note.value}),t.prev=3,t.next=6,this.mag.eCommerceManager.createInvoice(this.mag.num_id,n);case 6:if(!(r=t.sent)||!r.data){t.next=10;break}return this.mag.eCommerceManager.setInvoice(r.data),t.abrupt("return",r.data);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3),t.t0&&t.t0.type===v.Kq.nothingToInvoice&&(this.mag.eCommerceManager.clearCart(),this.goToInitialTab());case 15:case"end":return t.stop()}}),t,this,[[3,12]])}))),function(t){return Z.apply(this,arguments)}),createInvoiceWithItems:(_=S(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getCustomer();case 2:return e=t.sent,t.next=5,this.createInvoiceItemsForCustomer(e.id);case 5:return t.next=7,this.createInvoiceForCustomer(e.id);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t,this)}))),function(){return _.apply(this,arguments)}),cancelInvoice:(T=S(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("draft"!==e.status){t.next=5;break}return t.next=3,this.mag.eCommerceManager.deleteDraftInvoice(this.mag.num_id,e.id);case 3:t.next=8;break;case 5:if("open"!==e.status&&"uncollectible"!==e.status){t.next=8;break}return t.next=8,this.mag.eCommerceManager.voidDraftInvoice(this.mag.num_id,e.id);case 8:this.mag.eCommerceManager.unsetInvoiceItems(),this.mag.eCommerceManager.unsetInvoice();case 10:case"end":return t.stop()}}),t,this)}))),function(t){return T.apply(this,arguments)}),createOrder:function(){this.showOrderLoader(),this.mag.eCommerceManager.updateCartData().then(function(){var t=this,e=this.generateOrderRequestData();e&&e instanceof Error?this.renderOrderError(e.message):e&&e.currency&&r.Z.ajax({type:"POST",url:"/api/projects/"+this.mag.num_id+"/ecommerce/stripe/orders/",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){t.hideOrderLoader(),e&&e.data&&(t.mag.eCommerceManager.setOrder(e.data),t.renderOrderDetails())},error:function(e){var i=JSON.parse(e.responseText);t.hideOrderLoader(),t.renderOrderError(i.message)}})}.bind(this)).catch(function(t){this.hideOrderLoader(),t&&t.message&&this.renderOrderError(t.message)}.bind(this))},showOrderLoader:function(){this.orderLoading||(this.orderLoading=!0,this.$goToPayment.hasClass("hidden")||this.$goToPayment.addClass("hidden"),this.$orderTab.find(".preloader").addClass("show"),this.$orderDetails.addClass("hidden"))},hideOrderLoader:function(){this.orderLoading&&(this.orderLoading=!1,this.$goToPayment.hasClass("hidden")&&this.$goToPayment.removeClass("hidden"),this.$orderTab.find(".preloader").removeClass("show"),this.$orderDetails.removeClass("hidden"))},renderOrderDetails:(O=S(regeneratorRuntime.mark((function t(){var e,n,a,o,s,c,l,d,u,h,p,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.mag.eCommerceManager.getOrder(),this.$orderItems.empty(),this.$orderShippingAddress.empty(),this.$orderShippingMethod.empty(),this.$orderShippingEmail.empty(),this.$orderTax.empty(),this.$orderTotalPrice.empty(),e.items.forEach(function(t){if("tax"===t.type)n=t;else if("shipping"===t.type)a=t;else{var e=(0,r.Z)("<div/>",{class:"order-item"}).html(t.quantity+" × "+t.description),i=(0,r.Z)("<div/>",{class:"order-item-price"}).text((0,g.x)((t.amount/100).toFixed(2),t.currency));e.append(i),this.$orderItems.append(e)}}.bind(this)),e.shipping?(o=function(t){return t?" ".concat(t):""},s=e.shipping.address,c="".concat(s.line1).concat(o(s.line2)," ").concat(s.city,",").concat(o(s.state)).concat(o(s.postal_code)," ").concat(s.country),this.$orderShippingAddress.text(c),this.$tabs.find(".shipping-details").removeClass("hidden")):this.$tabs.find(".shipping-details").addClass("hidden"),!(e.shipping_methods.length>1)){t.next=23;break}return l=this.shippingMethodsOptions(e.shipping_methods),t.next=13,i.e(25).then(i.bind(i,1146));case 13:return d=t.sent,u=d.default,t.next=17,Promise.resolve().then(i.bind(i,344));case 17:h=t.sent,p=h.default,f=p.extend(u),this.shippingMethodSelect?(this.shippingMethodSelect.options=function(){return l},this.shippingMethodSelect.value=a.parent):this.shippingMethodSelect=new f({el:this.$orderShippingMethod.get(0),propsData:{options:function(){return l},value:a.parent,isDesktop:!1,callback:this.onShippingMethodChange}}),t.next=25;break;case 23:this.$orderShippingMethod.parent(".shipping-method.order-row").removeClass("hidden"),this.$orderShippingMethod.text(a.description+" "+(0,g.x)((a.amount/100).toFixed(2),a.currency));case 25:this.$orderDetails.find(".order-id").text(String(e.id).slice(0,20)+"..."),e.email?(this.$orderShippingEmail.text(e.email),this.$orderDetails.find(".shipping-email").removeClass("hidden")):this.$orderDetails.find(".shipping-email").addClass("hidden"),e.phone?(this.$orderDetails.find(".order-shipping-phone").text(e.phone),this.$orderDetails.find(".shipping-phone").removeClass("hidden")):this.$orderDetails.find(".shipping-phone").addClass("hidden"),n&&(this.$orderTax.parent(".shipping-tax-size.order-row").removeClass("hidden"),this.$orderTax.text(n.description+" "+(0,g.x)((n.amount/100).toFixed(2),n.currency))),this.$orderTotalPrice.text((0,g.x)((e.amount/100).toFixed(2),e.currency)),this.$goToPayment.removeClass("hidden");case 31:case"end":return t.stop()}}),t,this)}))),function(){return O.apply(this,arguments)}),shippingMethodsOptions:function(t){return t.map((function(t){return{value:t.id,caption:t.description+" "+(0,g.x)((t.amount/100).toFixed(2),t.currency)}}))},onShippingMethodChange:function(t){var e=this;this.shippingMethodSelect.value=t,this.showOrderLoader(),this.mag.eCommerceManager.changeShippingMethod(t).then((function(t){e.hideOrderLoader(),t.data&&(e.mag.eCommerceManager.setOrder(t.data),e.renderOrderDetails())})).catch((function(){e.hideOrderLoader()}))},renderOrderError:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$orderError.find(".order-error-message").text(t),this.$orderError.removeClass("hidden"),this.$orderDetails.addClass("hidden"),this.$goToPayment.addClass("hidden")},clearOrderError:function(){this.$orderError.addClass("hidden"),this.$orderDetails.removeClass("hidden"),this.$goToPayment.removeClass("hidden")},transformShippingFormToOrderRequest:function(){var t=this.checkShippableInCart(),e={currency:"usd",email:this.shippingForm.email.value,items:[]};return this.shippingForm.note.value&&(e.metadata={note:this.shippingForm.note.value}),t?(e.shipping={name:this.shippingForm.name.value,phone:this.shippingForm.phone.value,address:{line1:this.shippingForm.line1.value,line2:this.shippingForm.line2.value,city:this.shippingForm.city.value,state:this.shippingForm.state.value,country:this.shippingForm.country.value,postal_code:this.shippingForm.postal_code.value}},e):e},generateOrderRequestData:function(){var t=this.mag.eCommerceManager.getCartData();if(!t||!t.skus)return new Error("Empty cart");var e=[],i=this.transformShippingFormToOrderRequest();for(var n in t.skus)t.skus[n].active&&(i.items.push({type:t.skus[n].object,parent:n,currency:t.skus[n].currency,quantity:t.skus[n].cart_count}),-1===e.indexOf(t.skus[n].currency)&&e.push(t.skus[n].currency));return e.length>1?new Error("mixed currencies"):(i.currency=e.pop(),i)},cancelOrder:function(){var t=this;if(this.showPaymentLoader(),this.havePrices){var e=this.mag.eCommerceManager.getCartData();e.invoice&&this.cancelInvoice(e.invoice).then((function(){t.hidePaymentLoader(),t.goToTabByClassname(".tab-items")})).catch((function(){t.hidePaymentLoader()}))}else this.mag.eCommerceManager.cancelOrder().then((function(e){t.hidePaymentLoader(),e.data&&"canceled"===e.data.status&&(t.mag.eCommerceManager.deleteOrder(),t.goToTabByClassname(".tab-items"))})).catch((function(){t.hidePaymentLoader()}))},renderCheckoutFormPaymentIntent:(x=S(regeneratorRuntime.mark((function t(){var e,i,n,r,a,o,s,c,l=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.mag.eCommerceManager.getCustomer()){t.next=4;break}return this.$paymentFailed.text("Customer not found"),t.abrupt("return");case 4:return t.next=6,this.getInvoiceForCustomer(e.id);case 6:if(i=t.sent){t.next=10;break}return this.$paymentFailed.text("Invoice not found"),t.abrupt("return");case 10:if(n=this.mag.eCommerceManager.getCartData(),this.showPaymentLoader(),"draft"!==i.status){t.next=27;break}return t.next=15,this.mag.eCommerceManager.finalizeInvoice(this.mag.num_id,i.id);case 15:return r=t.sent,this.mag.eCommerceManager.setInvoice(r),t.next=19,this.mag.eCommerceManager.getPaymentIntent(this.mag.num_id,r.payment_intent);case 19:if((a=t.sent).receipt_email){t.next=23;break}return t.next=23,this.mag.eCommerceManager.updatePaymentIntent(this.mag.num_id,a.id,{receipt_email:n.shippingForm.email.value});case 23:this.clientSecret=a.client_secret,this.hidePaymentLoader(),t.next=36;break;case 27:if("open"!==i.status){t.next=36;break}return t.next=30,this.mag.eCommerceManager.getPaymentIntent(this.mag.num_id,i.payment_intent);case 30:if((o=t.sent).receipt_email){t.next=34;break}return t.next=34,this.mag.eCommerceManager.updatePaymentIntent(this.mag.num_id,o.id,{receipt_email:n.shippingForm.email.value});case 34:this.clientSecret=o.client_secret,this.hidePaymentLoader();case 36:s=this.mag.eCommerceManager.getStripeConnectedUserId(),this.stripe||(this.stripe=Stripe(R,{stripeAccount:s})),c=this.stripe.elements(),this.cardNumber||(this.cardNumber=c.create("cardNumber",{style:this.cardStyle,placeholder:"Card number"}),this.cardNumber.mount("#card-number-element"),this.cardNumber.addEventListener("change",(function(t){var e=l.$paymentTab.find(".card-number-error");t.error?e.removeClass("hidden"):e.addClass("hidden")})),this.cardNumber.addEventListener("ready",(function(t){l.renderCartHolderInput()}))),this.cardExpiry||(this.cardExpiry=c.create("cardExpiry",{style:this.cardStyle,placeholder:"M/Y"}),this.cardExpiry.mount("#card-expiry-element"),this.cardExpiry.addEventListener("change",(function(t){var e=l.$paymentTab.find(".card-expiry-error");t.error?e.removeClass("hidden"):e.addClass("hidden")}))),this.cardCvc||(this.cardCvc=c.create("cardCvc",{style:this.cardStyle,placeholder:"Security code"}),this.cardCvc.mount("#card-cvc-element"),this.cardCvc.addEventListener("change",(function(t){var e=l.$paymentTab.find(".card-cvc-error");t.error?e.removeClass("hidden"):e.addClass("hidden")}))),this.form||(this.form=document.getElementById("payment-form"),this.form.addEventListener("submit",this.onPaymentFormSubmit.bind(this)));case 43:case"end":return t.stop()}}),t,this)}))),function(){return x.apply(this,arguments)}),renderCheckoutForm:function(){var t=this,e=this.mag.eCommerceManager.getStripeConnectedUserId();this.stripe||(this.stripe=Stripe(R,{stripeAccount:e}));var i=this.stripe.elements();this.cardNumber||(this.cardNumber=i.create("cardNumber",{style:this.cardStyle,placeholder:"Card number"}),this.cardNumber.mount("#card-number-element"),this.cardNumber.addEventListener("change",(function(e){var i=t.$paymentTab.find(".card-number-error");e.error?i.removeClass("hidden"):i.addClass("hidden")})),this.cardNumber.addEventListener("ready",(function(e){t.renderCartHolderInput()}))),this.cardExpiry||(this.cardExpiry=i.create("cardExpiry",{style:this.cardStyle,placeholder:"M/Y"}),this.cardExpiry.mount("#card-expiry-element"),this.cardExpiry.addEventListener("change",(function(e){var i=t.$paymentTab.find(".card-expiry-error");e.error?i.removeClass("hidden"):i.addClass("hidden")}))),this.cardCvc||(this.cardCvc=i.create("cardCvc",{style:this.cardStyle,placeholder:"Security code"}),this.cardCvc.mount("#card-cvc-element"),this.cardCvc.addEventListener("change",(function(e){var i=t.$paymentTab.find(".card-cvc-error");e.error?i.removeClass("hidden"):i.addClass("hidden")}))),this.form||(this.form=document.getElementById("payment-form"),this.form.addEventListener("submit",this.onPaymentFormSubmit.bind(this)))},renderCartHolderInput:function(){this.cardHolderName||(this.cardHolderName=this.$paymentTab.find(".card-name-input"),this.cardHolderName.removeClass("hidden"),this.cardHolderName.on("input",this.onCardHolderNameChange))},onCardHolderNameChange:function(t){this.cardHolderNameValue=t.target.value,this.cardHolderNameValue?this.$paymentTab.find(".card-name-error").hasClass("hidden")||this.$paymentTab.find(".card-name-error").addClass("hidden"):this.$paymentTab.find(".card-name-error").hasClass("hidden")&&this.$paymentTab.find(".card-name-error").removeClass("hidden")},onPaymentFormSubmit:function(t){t.preventDefault(),this.cardHolderNameValue?(this.$paymentTab.find(".card-name-error").addClass("hidden"),this.haveSkus?this.onSkuPaymentFormSubmit():this.havePrices&&this.onPricesPaymentFormSubmit()):this.$paymentTab.find(".card-name-error").removeClass("hidden")},onSkuPaymentFormSubmit:function(){var t=this;this.stripe.createToken(this.cardNumber,{name:this.cardHolderNameValue}).then((function(e){e.error||t.stripeTokenHandler(e.token)}))},onPricesPaymentFormSubmit:function(){var t=this;this.clientSecret?(this.hideErrorPaymentMessage(),this.showPaymentLoader(),this.stripe.confirmCardPayment(this.clientSecret,{payment_method:{card:this.cardNumber,billing_details:{name:this.cardHolderNameValue}}}).then((function(e){e.error?(t.hidePaymentLoader(),t.showErrorPaymentMessage("Payment Failed on confirmCardPayment"),t.checkoutCompete=!0):(t.hidePaymentLoader(),"succeeded"===e.paymentIntent.status&&(t.showSuccessPaymentMessage(),RM.analytics&&RM.analytics.sendEvent("Checkout success")),t.checkoutCompete=!0)}))):this.showErrorPaymentMessage("Not client secret")},stripeTokenHandler:function(t,e){var i=this.mag.eCommerceManager.getOrder();if(i){var n=i.email;n?(this.hideErrorPaymentMessage(),this.showPaymentLoader(),r.Z.ajax({type:"POST",url:"/api/projects/"+this.mag.num_id+"/ecommerce/stripe/orders/"+i.id+"/pay/",data:JSON.stringify({stripe_token:t.id,email:n}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){this.hidePaymentLoader(),t&&t.data&&("paid"===t.data.status&&(RM.analytics&&RM.analytics.sendEvent("Checkout success"),this.showSuccessPaymentMessage(),"function"==typeof e&&e({status:"success"})),this.checkoutCompete=!0)}.bind(this),error:function(){this.hidePaymentLoader(),this.showErrorPaymentMessage("Payment Failed"),"function"==typeof e&&e({status:"fail"}),this.checkoutCompete=!0}.bind(this)})):this.showErrorPaymentMessage("Email is required")}else this.showErrorPaymentMessage("Order not found")},showPaymentLoader:function(){this.paymentLoading||(this.paymentLoading=!0,this.$paymentTab.find(".preloader").addClass("show"),this.$paymentTab.find(".cart-payment-btn").css("display","none"),this.$paymentTab.find(".cart-cancel-btn").css("display","none"))},hidePaymentLoader:function(){this.paymentLoading&&(this.paymentLoading=!1,this.$paymentTab.find(".preloader").removeClass("show"),this.$paymentTab.find(".cart-payment-btn").css("display","block"),this.$paymentTab.find(".cart-cancel-btn").css("display","block"))},showErrorPaymentMessage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$paymentFailed.find(".error-message").text(t),this.$paymentFailed.addClass("show")},hideErrorPaymentMessage:function(){this.$paymentFailed.find(".error-message").empty(),this.$paymentFailed.removeClass("show")},showSuccessPaymentMessage:function(){this.$paymentTab.find(".sidebar-header").css("display","none"),this.$paymentTab.find(".sidebar-body").css("display","none"),this.$paymentSuccess.addClass("show")},hideSuccessPaymentMessage:function(){this.$paymentTab.find(".sidebar-header").css("display","block"),this.$paymentTab.find(".sidebar-body").css("display","block"),this.$paymentSuccess.removeClass("show")},toogleSettings:function(){this.isHiddenSettings=!this.isHiddenSettings,this.settingsPanel&&(this.settingsPanel.isHidden=this.isHiddenSettings)},getSettingsData:function(){var t={};if(this.cartWidgetData){var e=n.Z.clone(this.cartWidgetData);t={"bar-color":e["bar-color"],"bar-color-opacity":e["bar-color-opacity"],"bar-background-color":e["bar-background-color"],"bar-background-color-opacity":e["bar-background-color-opacity"],"bar-shadow":e["bar-shadow"],"bar-font-family":e["bar-font-family"],"bar-font-style":e["bar-font-style"],"bar-font-weight":e["bar-font-weight"],"bar-letter-spacing":e["bar-letter-spacing"]}}return{isHidden:this.isHiddenSettings,model:t,onOverlayClick:this.onSettingsOverlayClick.bind(this)}},setupSettingsPanel:function(){},onSettingsOverlayClick:function(){this.toogleSettings()},onModelChange:function(t){this.saveModelChanges_debounced(t)},saveModelChanges:function(t){var e=this;this.updateCartWidgetData(t),this.generateSidebarCSS(this.cartWidgetData),this.cartWidgetModel&&this.cartWidgetModel.save(t,{toHistory:!1,skipHistory:!0,patch:!0}).then((function(){e.renderSidebarTexts()}))},updateCartWidgetData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.cartWidgetData=k(k({},this.cartWidgetData),t)},checkShippableInCart:function(){var t=this.mag.eCommerceManager.getCartData();for(var e in t.skus)if(t.skus[e].productObject.shippable)return!0;return!1},destroy:function(){var t=this;if(this.rendered)return this.checkoutCompete&&(this.mag.eCommerceManager.clearCart(),this.goToInitialTab(),this.hideSuccessPaymentMessage(),this.$paymentFailed.empty()),this.mag.eCommerceManager.events.off("ecommerce:cartsidebar:visibility:changed"),this.mag.eCommerceManager.events.off("ecommerce:cartdata:changed"),this.form&&this.form.removeEventListener("submit",this.onPaymentFormSubmit),this.cardHolderName&&this.cardHolderName.off("input",this.onCardHolderNameChange),this.$tabs.find("[data-tab^='tab-']").each((function(t,e){(0,r.Z)(e).off("click")})),this.$items.find(".cart-item-remove-btn").each((function(t,e){(0,r.Z)(e).off("click")})),this.$tabs.find(".order-details-form .form-input").each((function(e,i){(0,r.Z)(i).off("input",t.onShippingFormChange)})),this.unbindDomEvents(),this.settingsPanel&&(this.settingsPanel.$off("change",this.onModelChange),this.settingsPanel.$destroy()),this.$settingButton&&this.$settingButton.off("click",this.toogleSettings),this.environment===f.ZP.environment.preview&&this.unbindTextInputsEvents(),this.remove()},cartItemBlockHover:function(t){var e=(0,r.Z)(t.currentTarget);e&&e.length&&(e.addClass("hover").siblings().removeClass("hover"),this.hoveredItem=e.data("price-id")||e.data("sku-id"))},cartItemBlockLeave:function(t){var e=(0,r.Z)(t.currentTarget);e&&e.length&&(e.removeClass("hover"),(e.data("price-id")||e.data("sku-id"))===this.hoveredItem&&(this.hoveredItem=null))}});e.Z=F},1082:function(t,e,i){"use strict";var n=i(312),r=i(336),a=i.n(r),o=i(321),s=i(1083),c=i(323),l=i(347),d=i(342),u=a().View.extend({template:s.Z["template-viewer-mag-menu"],events:{"click .page":"onPageClick"},initialize:function(t){return o.Z.bindAll(this),o.Z.extend(this,t),this.IMG_STUB=(0,l.findImagePath)("./spacer.gif"),c.Z.isPhone?"horizontal"===this.viewerType?(this.PAGE_WIDTH=140,this.PAGE_HEIGHT=92):(this.PAGE_WIDTH=240,this.PAGE_HEIGHT=158):(this.PAGE_WIDTH="vertical"===this.viewerType?240:280,this.PAGE_HEIGHT="vertical"===this.viewerType?158:184),this.loadVisibleScreenshots.__debounced=o.Z.debounce(this.loadVisibleScreenshots,500),this.unloadInvisibleScreenshots.__debounced=o.Z.debounce(this.unloadInvisibleScreenshots,3e3),this},render:function(){this.setElement(this.template({mag:this.mag,pages:this.pages,width:this.PAGE_WIDTH,height:this.PAGE_HEIGHT,stub:this.IMG_STUB,viewerType:this.viewerType,publishDate:this.publishDate,hasProjectInfo:this.hasProjectInfo,common:RM.common})),this.$el.appendTo(this.$container),this.$pagesWrapper=this.$(".pages-wrapper");var t=this.$(".page");if("horizontal"==this.viewerType?(this.$(".pages").css("width",t.length*this.PAGE_WIDTH),this.$pagesWrapper.scrollLeft(99999)):(this.$(".pages").css("height",t.length*this.PAGE_HEIGHT),this.$pagesWrapper.scrollTop(99999)),c.Z.isDesktop&&(this.scroll=this.$(".scroll-wrapper").RMScroll({$container:this.$pagesWrapper,$content:this.$(".pages"),$handle:this.$(".scroll"),wheelScrollSpeed:1.3,gap_start:8,gap_end:8,maxHandleSize:136,dragScroll:!0,tp:this.viewerType}).data("scroll")),this.$pagesWrapper.bind("scroll",this.onScroll),this.cacheSize(),this.cacheScroll(),this.cachePagesPos(),this.loadedScreenshots={},this.showInitially&&(this.loadVisibleScreenshots(),this.show(!0)),"horizontal"==this.viewerType&&c.Z.isPhone||(0,n.Z)(".menu-info .mag-title").dotdotdot({height:c.Z.isPhone?48:68,wrap:"letter",callback:o.Z.bind((function(t,e){t&&this.$(".menu-info .mag-title").attr("title",this.mag.title)}),this)}),!c.Z.isDesktop){var e="horizontal"==this.viewerType?this.$el.height():this.$el.width(),i=this.$el.add(this.$toolbar);"horizontal"==this.viewerType&&this.mag.navigation&&(i=i.add(this.mag.navigation.$bottom)),this.menuSwipe=i.RMSwipe({$scrollElements:this.$pagesWrapper,minTransitionSpeed:200,maxTransitionSpeed:400,rubberBand:!1,getCurrentConstraints:o.Z.bind((function(){var t={};return t.$referenceItem=this.$el,t="horizontal"==this.viewerType?this.shown?{up:{max:0,noTrigger:!0},down:{max:e}}:{up:{max:e},down:{max:0,noTrigger:!0}}:this.shown?{left:{max:0,noTrigger:!0},right:{max:e}}:{left:{max:e},right:{max:0,noTrigger:!0}}}),this),callback:o.Z.bind((function(t){this.shown?this.hide():this.show()}),this)}).data("swipe")}return this.isPreview&&this.listenTo(RM.constructorRouter,"renewScreenshot",this.renewScreenshot),this.listenTo(this.mag,"pageChanged",this.onPageChange),this.listenTo(this.mag,"keypress-"+n.Z.keycodes.m,this.toggle),this.listenTo(this.mag,"keypress-"+n.Z.keycodes.esc,this.hide),d.Z.on("constructorSettings:open",this.show),d.Z.on("constructorSettings:close",this.hide),(0,n.Z)(window).on("resize",this.onResize),this.$el.bind("mousewheel",this.onMouseWheel),this},show:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.shown||(this.shown=!0,e&&this.$el.css({transition:"none"}),this.mag.$el.addClass("viewer-mag-menu-shown"),(0,n.Z)("html").addClass("mag-menu-shown"),this.mag.$el.toggleClass("viewer-mag-menu-no-project-info",!this.hasProjectInfo),this.loadOtherScreenshots(),this.mag.trigger("menuShown"),d.Z.trigger("magMenu:open"),e&&setTimeout((function(){return t.$el.css({transition:""})}))),this},toggle:function(){return this.shown?this.hide():this.show()},hide:function(){return this.shown&&(this.mag.$el.removeClass("viewer-mag-menu-shown viewer-mag-menu-no-project-info"),(0,n.Z)("html").removeClass("mag-menu-shown"),this.clearLoadOtherTimeout(),this.mag.focusCurrentPage(),this.shown=!1,this.mag.trigger("menuHidden"),d.Z.trigger("magMenu:close")),this},destroy:function(){return(0,n.Z)(window).off("resize",this.onResize),(0,n.Z)("html").removeClass("mag-menu-shown"),d.Z.trigger("magMenu:close"),this.$el.unbind("mousewheel",this.onMouseWheel),this.menuSwipe&&this.menuSwipe.destroy(),this.$pagesWrapper.unbind("scroll",this.onScroll),d.Z.off("constructorSettings:open",this.show),d.Z.off("constructorSettings:close",this.hide),this.remove()},onMouseWheel:function(t){t.preventDefault()},onResize:function(){this.cacheSize(),this.scroll&&this.scroll.recalc(),this.mag.currentPage&&this.shiftToPage(this.mag.currentPage.num,!1)},onScroll:function(){this.cacheScroll()},cacheSize:function(){this.cachedData=this.cachedData||{},this.cachedData.scrollSize="horizontal"==this.viewerType?this.$pagesWrapper.width():this.$pagesWrapper.height()},cacheScroll:function(){this.cachedData=this.cachedData||{},this.cachedData.scrollPos="horizontal"==this.viewerType?this.$pagesWrapper.scrollLeft():this.$pagesWrapper.scrollTop()},cachePagesPos:function(){this.cachedData=this.cachedData||{},this.cachedData.pagesPos={};var t=this.cachedData.pagesPos,e=this.viewerType,i=this.PAGE_WIDTH,n=this.PAGE_HEIGHT;o.Z.each(this.pages,(function(r,a){t[r.num]=a*("horizontal"==e?i:n)}))},onPageChange:function(t,e){this.shown||(this.loadVisibleScreenshots.__debounced(),!c.Z.isDesktop&&this.unloadInvisibleScreenshots.__debounced()),this.shiftToPage(t.num,this.shown),o.Z.isEmpty(this.loadedScreenshots)&&this.loadVisibleScreenshots()},shiftToPage:function(t,e){var i,n=this.$('.page[data-num="'+t+'"]'),r=this.cachedData.scrollSize,a=this.cachedData.scrollPos,o="horizontal"==this.viewerType?this.PAGE_WIDTH:this.PAGE_HEIGHT,s=this.cachedData.pagesPos[t],c=a+o/2,l=a+r-o/2;if(this.$(".page.active").removeClass("active"),n.addClass("active"),s<c)i=s-c;else{if(!(s+o>l))return;i=s+o-l}var d={};d["horizontal"==this.viewerType?"scrollLeft":"scrollTop"]=a+i,this.$pagesWrapper.stop().animate(d,e?300:0)},onPageClick:function(t){if(!this.scroll||!this.scroll.wasContentDrag){var e=(0,n.Z)(t.currentTarget).data("num");this.mag.currentPage&&e==this.mag.currentPage.num||this.mag.showPage(e,{animation:!1})}},renewScreenshot:function(t){var e=this.$(".page").filter((function(){return(0,n.Z)(this).data("id")==t})),i=RM.constructorRouter.mag.pages.find((function(e){return e.id==t})),r=i&&i.getScreenshot(this.PAGE_WIDTH);e.attr("data-src")?e.attr("data-src",r):e.find(".screenshot").prop("src",r)},getVisibleScreenshotRange:function(){var t=this.cachedData.scrollSize,e=this.cachedData.scrollPos,i="horizontal"==this.viewerType?this.PAGE_WIDTH:this.PAGE_HEIGHT;return{min:Math.max(0,Math.floor(e/i)),max:Math.min(this.mag.getPagesCount()-1,Math.floor((e+t)/i))}},loadVisibleScreenshots:function(){if(this.mag.pages&&this.mag.pages.length){var t=this.getVisibleScreenshotRange(),e=this;this.$(".page").each((function(i){var r,a=(r=(0,n.Z)(this)).attr("data-src");i>=t.min&&i<=t.max&&a&&!e.loadedScreenshots[i]&&((r=(0,n.Z)(this)).find(".screenshot").prop("src",a),r.removeAttr("data-src"),e.loadedScreenshots[i]=!0)}))}},unloadInvisibleScreenshots:function(){if(!this.shown){var t=this.getVisibleScreenshotRange(),e=this;this.$(".page").each((function(i){var r,a=(r=(0,n.Z)(this)).attr("data-src");(i<t.min||i>t.max)&&!a&&e.loadedScreenshots[i]&&((r=(0,n.Z)(this)).attr("data-src",r.find(".screenshot").prop("src")),r.find(".screenshot").prop("src",e.IMG_STUB),delete e.loadedScreenshots[i])}))}},loadOtherScreenshots:function(){this.clearLoadOtherTimeout(),this.loadOtherSafeTimeout=500,this.loadNextScreenshot()},loadNextScreenshot:function(){var t,e,i,n=this.getVisibleScreenshotRange(),r=Math.floor((n.min+n.max)/2),a=this.loadedScreenshots,o=this.mag.getPagesCount()-1;for(t=r;t<=o&&a[t];t++);for(e=r;e>=0&&a[e];e--);if(!(e<0&&t>o)){a[i=t>o?e:e<0?t:t-r>r-e?e:t]=!0;var s=this.$(".page").eq(i),c=s.find(".screenshot"),l=this;c.one("load error",(function(t){clearTimeout(l.$curLoadingTimeout),l.loadNextScreenshot()})),this.$curLoadingTimeout=setTimeout((function(){c.off(),l.loadOtherSafeTimeout*=1.1,l.loadNextScreenshot()}),this.loadOtherSafeTimeout),c.prop("src",s.attr("data-src")),s.removeAttr("data-src"),this.$curLoadingScreenshot=c}},clearLoadOtherTimeout:function(){this.$curLoadingScreenshot&&this.$curLoadingScreenshot.off(),clearTimeout(this.$curLoadingTimeout)}});e.Z=u},1063:function(t,e,i){"use strict";var n=i(312),r=i(336),a=i.n(r),o=i(321),s=i(1064),c=i(346),l=i(340),d=i(308),u=i(348),h=i(341),p=i(867),f=i(735),g=i(736),m=i(710),v=i(1065),y=i(343),b=i(1068),w=i(1067),S=i(727),P=i.n(S),k=i(323),C=i(350),x=i(886),O=i(1070),T=i(1075),_=i(1076),Z=i(1078),M=i(1084),I=i(347),$=i(1042),E=i.n($),D=i(741);function L(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function j(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?L(Object(i),!0).forEach((function(e){A(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):L(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function A(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var R=a().View.extend({TYPEKIT_PREVIEW_API_LINK:"//use.typekit.net/previewkits/pk-v1.js",PRELOAD_COUNT_HORIZONTAL:{backward:(0,C._)("viewer.turnOffHorizontalPreload")?0:1,forward:(0,C._)("viewer.turnOffHorizontalPreload")?0:k.Z.isDesktop?5:k.Z.isPhone?3:2},PRELOAD_COUNT_VERTICAL:{backward:k.Z.isDesktop?2e3:(k.Z.isPhone,1e3),forward:k.Z.isDesktop?3e3:(k.Z.isPhone,2e3)},SCROLLABLE_TRESHOLD:100,SCROLL_SNAP:0,template:s.Z["template-viewer-mag"],initialize:function(t,e){var i=this;o.Z.bindAll(this),t||(t={}),o.Z.defaults(t,{pages:[]}),this.hasWidgetsWithVerticalOnscrollAnimation=!1;var r=(0,o.Z)(t.pages).chain().reduce((function(t,e){return t.concat(e.wids||[])}),[]).each((function(t){g.Z.normalizeAnimations(t.animation).find((function(t){return"scroll"===t.type&&t.steps&&t.steps.find((function(t){return t.dy}))}))&&(i.hasWidgetsWithVerticalOnscrollAnimation=!0)})).filter({is_global:!0}).value();this.staticGlobalWidgetsData=(0,o.Z)(r).filter((function(t){return!t.is_above})),this.aboveGlobalWidgetsData=(0,o.Z)(r).filter((function(t){return t.is_above}));var a=o.Z.pluck(this.aboveGlobalWidgetsData,"_id");return t.pages.forEach((function(t){t.pagePath=t.pagePath||t.uri||t.num.toString()})),t.pages.forEach((function(t){t.uri=t.pagePath})),(0,o.Z)(t.pages).each(function(t){t.wids=(t.wids||[]).concat(o.Z.reject(this.staticGlobalWidgetsData,(function(e){return e.pid===t._id}))),t.wids=o.Z.unique(t.wids,(function(t){return t._id||Math.random()})),t.wids=(0,o.Z)(t.wids).filter((function(t){return!o.Z.contains(a,t._id)}))}.bind(this)),o.Z.extend(this,t),this.model=new c.w(t,{parse:!0}),this.router=e,this.eCommerceManager=new x.ZP(this.router,this,this.router.environment),this.setupEcommerceSidebar(),this.isPreview=e.isPreview,this.$container=e.$mags_container,k.Z.isDesktop&&(0,n.Z)("<div>").bind("mousewheel",(function(){})),this.setViewerOptions(this.getMagViewport()),this.continueLoading.__debounced=o.Z.debounce(this.continueLoading,200),this.loadPages.__debounced=o.Z.debounce(this.loadPages,700),this.onResize.__debounced=o.Z.debounce(this.onResize,300),this.redrawAboveGlobalWidgets.__debounced=o.Z.debounce(this.redrawAboveGlobalWidgets,500,!0),this.widgetPackCount=0,this.getAboveGlobalBoxMemoized=o.Z.memoize(this.getAboveGlobalBox,(function(t,e,i){return t+" "+(e&&e.num)+" "+(e&&e.pageViewport)+" "+(i&&i.width)+" "+(i&&i.height)})),this},setViewerOptions:function(t){var e={arrows:!0,menubutton:!0,projectinfo:!0,sharebutton:!0,pagecounter:!0,controlsontop:!1,viewertype:"vertical",slidein:!1,scalewidth:3600,lqip:!1};(e=o.Z.extend(e,this.model.get("opts"))).viewertype=RM.screenshot?"horizontal":e.viewertype,(!k.Z.isDesktop||this.isPreview&&"default"!==t)&&(e.slidein=!1),"vertical"===e.viewertype&&(k.Z.isDesktop?this.isStickyVerticalViewer=!e.slidein&&!this.isPreview&&!this.hasWidgetsWithVerticalOnscrollAnimation:(this.isStickyVerticalViewer=Modernizr.csspositionsticky,this.isStickyVerticalViewer||(e.viewertype="horizontal",this.pages.length>1&&(e.arrows=!0)))),e.sharebutton=e.sharebutton&&!this.isPreview&&!!this.published&&!this.is_private,e.pagecounter=e.pagecounter&&!this.isPreview&&this.pages.length>1,e.branding=(o.Z.isUndefined(e.branding)?e.endpage:e.branding)&&!this.isPreview,this.model.user&&this.model.user.get&&"540dc7a3a5c9259a383b910b"==this.model.user.get("_id")&&(e=o.Z.extend(e,{arrows:!0,menubutton:this.isPreview,sharebutton:!1,pagecounter:!1,branding:!1})),this.viewOpts=e,this.PRELOAD_COUNT="horizontal"==this.viewOpts.viewertype?this.PRELOAD_COUNT_HORIZONTAL:this.PRELOAD_COUNT_VERTICAL},setViewerClasses:function(){this.$el.removeClass("viewer-type-horizontal viewer-type-vertical").addClass("viewer-type-"+this.viewOpts.viewertype).removeClass("pages-pos-normal pages-pos-overlap").addClass("pages-pos-"+(this.viewOpts.slidein?"overlap":"normal")),"vertical"==this.viewOpts.viewertype&&((0,n.Z)("html").addClass("overflow-on-vertical-view"),this.isStickyVerticalViewer&&(this.$el.addClass("viewer-type-vertical-sticky"),(0,n.Z)("body").addClass("overflow-on-vertical-view"))),this.viewOpts.controlsontop&&(0,n.Z)("html").addClass("controls-on-top"),(0,n.Z)("html").addClass("new-settings")},unsetViewerClasses:function(){this.$el.removeClass("viewer-type-horizontal viewer-type-vertical").removeClass("pages-pos-normal pages-pos-overlap"),"vertical"==this.viewOpts.viewertype&&((0,n.Z)("html").removeClass("overflow-on-vertical-view"),this.$magScrollSizer.css("height",""),this.isStickyVerticalViewer&&(this.$el.removeClass("viewer-type-vertical-sticky"),(0,n.Z)("body").removeClass("overflow-on-vertical-view"))),(0,n.Z)("html").removeClass("controls-on-top")},render:function(){if(!this.active){this.title=this.title||"Project",this.magOpenTime=new Date,document.documentElement.style.setProperty("--min-desktop-width","".concat(y.ZP.dictionary[y.sJ.Default].min_scale_width,"px")),this.setElement(this.template({hasStandaloneBottomArrow:!this.isPreview&&"vertical"==this.viewOpts.viewertype&&this.viewOpts.arrows,isPreview:!!this.isPreview,icons:{sprite:(0,I.findImagePath)("./common/navigation/sprite".concat(I.is2X?"@2x":"",".png"))}})),this.$el.appendTo(this.$container),this.setViewerClasses(),(0,n.Z)("body").on("click","a.external-link",this.toExternalLink).on("click",".maglink.back-to-top",this.backToTopCurrentPage).on("click",".maglink",this.maglink).on("click",".goback-link",this.onGobackLinkClick).on("click",".mailchimp-link",this.onMailchimpLinkClick).on("click",".anchor-link",this.onAnchorLinkClick).on("click",".share-link",this.onShareLinkClick),this.$mag_container=this.$(".mag-pages-container"),this.$mag_container.on("scroll",this.fixFocusScroll),this.$mag_viewport_device=this.$(".mag-pages-viewport-device"),this.$pages_container=this.$(".mag-pages-container .container"),this.$pages_blackout=this.$pages_container.find(".blackout"),this.$aboveWidgetsContainer=this.$(".above-pages-container"),"vertical"==this.viewOpts.viewertype&&(this.$magScrollContainer=(0,n.Z)(window),this.$magScrollSizer=(0,n.Z)("body"),this.isStickyVerticalViewer&&(this.$magScrollSizer=(0,n.Z)("body").add(this.$el)),this.$magScrollHandler=(0,n.Z)(window),this.$magScrollAnimate=(0,n.Z)("body, html")),"vertical"==this.viewOpts.viewertype&&(this.$bottomArrow=this.$(".navigation-arrow.bottom"),this.$bottomArrow.one("click",this.scrollMagALittle)),this.active=!0;var t=this.pages;this.pages=null,this.viewport=null,this.switchToViewport(this.getMagViewport()),this.onResize(),k.Z.isDesktop||setTimeout(this.onResize,1500),this.pages=(0,o.Z)(t).chain().sortBy((function(t){return t.num})).map(o.Z.bind((function(e){var i="";try{i=new v.Z({mag:this,router:this.router,totalPages:t.length,pageData:e,viewerType:this.viewOpts.viewertype,isStickyVerticalViewer:this.isStickyVerticalViewer,$container:this.$pages_container,viewOpts:this.viewOpts}).render()}catch(t){console.log("Error page rendering.",t)}return i}),this)).filter((function(t){return!!t})).value();var e=this.getPage(this.getPagesCount());if(e&&e.markAsLast(),"horizontal"==this.viewOpts.viewertype&&this.setPagesTransitions(),!RM.screenshot){"horizontal"==this.viewOpts.viewertype&&this.viewOpts.arrows&&(this.navigation=new _.Z({mag:this,router:this.router,$container:this.$el,isPreview:this.isPreview,viewerType:this.viewOpts.viewertype}).render());var i=(this.must_show_branding||this.viewOpts.branding)&&!(RM.common.embedMode&&!k.Z.isDesktop),r=i&&k.Z.isDesktop&&!this.viewOpts.controlsontop&&!this.isPreview;this.toolbar=new Z.Z({mag:this,pages:this.pages,router:this.router,$container:this.$el,isPreview:this.isPreview,hasMenu:this.viewOpts.menubutton,hasProjectInfo:this.viewOpts.projectinfo,hasShare:this.viewOpts.sharebutton&&!d.ZP.IS_FILE_PROTOCOL,hasPageCounter:this.viewOpts.pagecounter,controlsOnTop:this.viewOpts.controlsontop,brandingInToolbar:r,viewerType:this.viewOpts.viewertype,publishDate:this.published?P()(new Date(this.published),"mmm dd, yyyy"):"unpublished",isSettingsOpened:this.isSettingsOpened}).render(),i&&(this.branding=new M.Z({mag:this,$container:r?this.toolbar.$el.find(".toolbar-branding"):this.$el}).render())}"vertical"==this.viewOpts.viewertype&&(this.onResize(),k.Z.isDesktop&&this.getPage(1)&&this.getPage(1).$content.focus(),(0,n.Z)("body").on("keydown",this.onVerticalViewKeyDown)),k.Z.isDesktop?((0,n.Z)(window).on("mousedown",this.onMouseDown),(0,n.Z)(window).on("mouseup",this.onMouseUp),(0,n.Z)(window).on("mousewheel",this.onMouseWheel)):((0,n.Z)(window).on("touchstart",this.onDragStart),(0,n.Z)(window).on("touchmove",this.onDragMove),(0,n.Z)(window).on("touchend touchcancel",this.onDragEnd),(0,n.Z)(window).on("pageshow",this.onResize)),l.default.PageVisibilityManager.addEventListener(this.onPageVisibilityChange),this.listenTo(a(),"form:focus",this.onFormFocus),this.listenTo(a(),"form:blur",this.onFormBlur),(0,n.Z)(window).on("resize",this.onResize),this.isPreview&&this.listenTo(this.model,"change:opts",this.onOptsChange),k.Z.isDesktop||(0,n.Z)(window).on("orientationchange",this.onResize),(0,n.Z)(window).on("gesturestart gestureend",this.onGestureChange),"vertical"==this.viewOpts.viewertype&&this.$magScrollHandler.on("scroll",this.onMagScroll),(0,n.Z)("body").on("keyup",this.onKeyup),u.Z.generateCSS("paragraph","viewer",document,this.edit_params&&this.edit_params.paragraph_styles),u.Z.generateCSS("link","viewer",document,this.edit_params&&this.edit_params.link_styles),RM.screenshot&&"true"==l.default.queryUrlGetParam("pdf")||this.isPreview||u.Z.setShortList(u.Z.getVeryShortList(this.edit_params&&this.edit_params.fonts));var s=!this.isPreview&&this.model.get("is_published")?"published":"edit",c=this;return"edit"!=s||window.TypekitPreview?h():n.Z.getScript(this.TYPEKIT_PREVIEW_API_LINK,(function(t,e,i){h()})),this}function h(){u.Z.appendFontsCssToDocument({version:s,fonts:c.edit_params&&c.edit_params.fonts,typekit_url:c.typekit_url})}},destroy:function(){var t=this;return o.Z.each(this.pages,(function(t){t.destroy()})),this.pages=null,(0,n.Z)("body").off("click","a.external-link",this.toExternalLink).off("click",".maglink.back-to-top",this.backToTopCurrentPage).off("click",".maglink",this.maglink).off("click",".goback-link",this.onGobackLinkClick).off("click",".mailchimp-link",this.onMailchimpLinkClick).off("click",".anchor-link",this.onAnchorLinkClick).off("keydown",this.onVerticalViewKeyDown).off("click",".share-link",this.onShareLinkClick),this.toolbar&&this.toolbar.destroy(),this.navigation&&this.navigation.destroy(),this.cartSidebar&&setTimeout((function(){t.cartSidebar.destroy()}),320),k.Z.isDesktop?((0,n.Z)(window).off("mousedown",this.onMouseDown),(0,n.Z)(window).off("mouseup",this.onMouseUp),(0,n.Z)(window).off("mousewheel",this.onMouseWheel)):((0,n.Z)(window).off("touchstart",this.onDragStart),(0,n.Z)(window).off("touchmove",this.onDragMove),(0,n.Z)(window).off("touchend touchcancel",this.onDragEnd),(0,n.Z)(window).off("pageshow")),this.unsetViewerClasses(),l.default.PageVisibilityManager.removeEventListener(this.onPageVisibilityChange),(0,n.Z)(window).off("resize",this.onResize),(0,n.Z)(window).off("orientationchange",this.onResize),(0,n.Z)(window).off("gesturestart gestureend",this.onGestureChange),"vertical"==this.viewOpts.viewertype&&this.$magScrollHandler.off("scroll",this.onMagScroll),(0,n.Z)("body").off("keyup",this.onKeyup),this.active=!1,this.trigger("destroyed"),this.remove()},getUrl:function(){return RM.common.isDomainViewer?window.location.protocol+"//"+window.location.hostname+"/"+(RM.common.customDomainProfile?this.num_id+"/":""):window.location.protocol+"//"+window.location.hostname+"/"+this.num_id+"/"},getPage:function(t){return parseInt(t,10)==t&&(t=parseInt(t,10)),o.Z.isNumber(t)?this.pages[t-1]:(0,o.Z)(this.pages).find((function(e){return e.uri==t}))},getPageByPath:function(t){return"1"===t.toString()?this.pages[0]:this.pages.find((function(e){return e.pagePath===t}))},getPagesCount:function(){return this.pages&&this.pages.length},isFirstPage:function(){return this.currentPage&&!this.getPage(this.currentPage.num-1)},isLastPage:function(){return this.currentPage&&!this.getPage(this.currentPage.num+1)},getPageId:function(t){var e=o.Z.find(this.pages,(function(e){return e.num_id===t}));return e&&e._id},getPageNum:function(t){var e=o.Z.find(this.pages,(function(e){return e._id==t}));return e&&e.num},getPageUri:function(t){var e=o.Z.find(this.pages,(function(e){return e._id==t}));if(!e)return null;var i=e.uri?e.uri+"/":1==e.num?"":e.num+"/";return this.router.getMagUri(this)+i},getPageTransitionTime:function(){var t=Math.min(this.viewOpts.scalewidth,this.getContainerSizeCached().width),e=this.getContainerSizeCached().height;return k.Z.isDesktop?550:k.Z.isTablet?t>e?550:470:t>e?520:370},onPageVisibilityChange:function(){var t=this;if(this.currentPage)if(clearTimeout(this.visibilityHandlerTimeout),l.default.PageVisibilityManager.isPageHidden())this.visibilityHandlerTimeout=setTimeout((function(){t.currentPage.stop({widgetTypes:["video","background","iframe"]});var e=t.getPage(t.currentPage.num+1);e&&e.started&&(e.stop({widgetTypes:["video","background","iframe"]}),t.restartNextPage=!0)}),700);else{this.currentPage.start({widgetTypes:["audio","video","background","iframe"],forceStart:!0});var e=this.getPage(this.currentPage.num+1);e&&this.restartNextPage&&(e.start({widgetTypes:["audio","video","background","iframe"],forceStart:!0}),delete this.restartNextPage)}},updateArrowsColor:function(t){if(t){var e=t.arrows_color||"white";this.$el.removeClass("navigation-white-arrows").removeClass("navigation-black-arrows").addClass("navigation-"+e+"-arrows")}},onFormFocus:function(){if(Modernizr.safari&&!k.Z.isDesktop&&"vertical"===this.viewOpts.viewertype){var t=this.getScroll();o.Z.each(this.pages,(function(e){e.trigger("form:focus",t)})),this.$magScrollContainer&&this.$magScrollContainer.on("scroll",this.onScrollWithFormInFocus)}},onFormBlur:function(){(Modernizr.safari||!k.Z.isDesktop)&&"vertical"===this.viewOpts.viewertype&&(o.Z.each(this.pages,(function(t){t.trigger("form:blur")})),this.$magScrollContainer&&this.$magScrollContainer.off("scroll",this.onScrollWithFormInFocus))},onScrollWithFormInFocus:function(){if((Modernizr.safari||!k.Z.isDesktop)&&"vertical"===this.viewOpts.viewertype){var t=this.getScroll();o.Z.each(this.pages,(function(e){e.trigger("page:scrollWithFormInFocus",t)}))}},onDragStart:function(t){clearTimeout(this.touchInProgressTimeout),this.pauseLoading("touch");var e=t.originalEvent.targetTouches[0];this.globalTouchObject={$target:(0,n.Z)(t.target).closest(".has-horizontal-scroll, .has-vertical-scroll"),x:e.screenX,y:e.screenY,startTime:+new Date}},onDragMove:function(t){var e=this.globalTouchObject;if(!(t.originalEvent.touches.length>1)&&e){if("horizontal"==this.viewOpts.viewertype)this.currentPage&&this.currentPage.hasFixedWidgets&&(0,n.Z)(t.target).closest(this.$mag_container).length&&!e.$target.length&&(e.$target=this.currentPage.$scrollWrapper);else e.$target.length||(e.$target=this.$magScrollContainer);if(e.$target.length){if(!l.default.isPageNativelyScaled()){var i=t.originalEvent.targetTouches[0],r=(i.screenX,e.x,i.screenY-e.y);if(Math.abs(r)>5&&e.$target.hasClass("has-vertical-scroll")){var a=e.$target[0].scrollHeight,o=e.$target.outerHeight();r>0&&e.$target.scrollTop()<=0&&t.preventDefault(),r<0&&e.$target.scrollTop()>=a-o&&t.preventDefault()}e.$target.hasClass("has-horizontal-scroll")}}else t.preventDefault()}},onDragEnd:function(t){this.checkDoubleTap(t),this.touchInProgressTimeout=setTimeout(o.Z.bind((function(){this.continueLoading("touch")}),this),400);var e=this.globalTouchObject;if(e){var i=t.originalEvent.changedTouches[0],r=i.screenX-e.x,a=i.screenY-e.y;this.toolbar&&this.toolbar.isMenuOpened()&&Math.abs(r)<3&&Math.abs(a)<3&&+new Date-e.startTime<500&&!l.default.isPageNativelyScaled()&&(0,n.Z)(t.target).closest(this.$mag_container).length&&this.toolbar.closeMenu()}delete this.globalTouchObject},checkDoubleTap:function(t){if(!(t.originalEvent.touches.length>0)){var e=+new Date,i=e-(this.lastTouchEndTime||e+1);if(this.lastTouchEndTime=e,i<500&&i>0&&l.default.isPageNativelyScaled()){var r=(0,n.Z)('meta[name="viewport"]');if(r.length){var a=r.attr("content"),s=a.replace(/maximum\-scale\=[0-9\.]*/,"maximum-scale=1.0");if(r.attr("content",s),Modernizr.android){var c=(0,n.Z)("<div>").appendTo("body");o.Z.delay((function(){c.remove()}),500),setTimeout(o.Z.bind((function(){r.attr("content",a);var t=(0,n.Z)("<div>").appendTo("body");o.Z.delay((function(){t.remove()}),500)}),this),1e3)}else r.attr("content",a);this.lastTouchEndTime=0,o.Z.delay((function(){(0,n.Z)(window).trigger("gesturechange")}),300),o.Z.delay((function(){(0,n.Z)(window).trigger("gesturechange")}),1e3)}}}},onMouseDown:function(t){this.globalMouseObject={x:t.screenX,y:t.screenY,startTime:+new Date}},onMouseUp:function(t){var e=this.globalMouseObject;if(e){var i=t.screenX-e.x,r=t.screenY-e.y;this.toolbar&&this.toolbar.isMenuOpened()&&Math.abs(i)<3&&Math.abs(r)<3&&+new Date-e.startTime<500&&(0,n.Z)(t.target).closest(this.$mag_container).length&&this.toolbar.closeMenu()}delete this.globalMouseObject},onMouseWheel:function(t){t.originalEvent.deltaX<0&&Math.abs(t.originalEvent.deltaY)<2&&t.cancelable&&t.preventDefault()},onKeyup:function(t){if("input"!=t.target.tagName.toLowerCase()&&("textarea"!=t.target.tagName.toLowerCase()||"copyhack"==t.target.className)&&o.Z.isEmpty(RM.common.disableShortcuts)&&!this.isInPresentationMode){var e=o.Z.chain(y.ZP.viewports).filter((function(t){return"tablet_portrait"!=t.name||(this.currentPage["viewport_"+t.name]||{}).enabled}),this).map((function(t,e){var i=o.Z.clone(t);return i.shortcut=""+(e+1),i})).findWhere({shortcut:String.fromCharCode(t.keyCode)}).value();e&&this.isPreview&&(this.switchToViewport(e.name),this.aboveGlobalWidgetsRendered||"horizontal"!==this.viewOpts.viewertype||this.renderAboveGlobalWidgets(this.currentPage),this.setViewerOptions(e.name),this.setViewerClasses(),this.onResize(),this.loadPages());o.Z.find(n.Z.keycodes,(function(e,i){var r=n.Z.keycodes[i]===t.keyCode;return r&&i,r}))&&this.trigger("keypress-"+t.keyCode,t)}},onKeydown:function(t){if("input"!=t.target.tagName.toLowerCase()&&("textarea"!=t.target.tagName.toLowerCase()||"copyhack"==t.target.className)&&o.Z.isEmpty(RM.common.disableShortcuts)&&this.isInPresentationMode&&!(t.altKey||t.ctrlKey||t.metaKey))switch(t.which){case 8:case 33:case 80:case 37:case 72:case 38:case 75:t.preventDefault(),this.goPrevPage({animation:!0});break;case 13:case 34:case 78:case 39:case 76:case 40:case 74:t.preventDefault(),this.goNextPage({animation:!0});break;case 36:t.preventDefault(),this.goFirstPage();break;case 35:t.preventDefault(),this.goLastPage();break;case 9:case 32:t.preventDefault(),t.shiftKey?this.goPrevPage({animation:!0}):this.goNextPage({animation:!0});break;case 77:t.preventDefault(),this.trigger("keypress-"+t.keyCode,t)}},onVerticalViewKeyDown:function(t){var e;if(!this.isInPresentationMode&&"vertical"===this.viewOpts.viewertype&&(t.which===n.Z.keycodes.down||t.which===n.Z.keycodes.up)){if(t.preventDefault(),this.arrowKeyLastScrollAt&&new Date-this.arrowKeyLastScrollAt<400)return;var i=t.which===n.Z.keycodes.down;this.arrowKeyLastScrollAt=+new Date;var r,a,s=window.innerHeight,c=this.getScroll(),l=this.getScrollPosition(),d=Math.round(s/4),u=function(t){return t&&t<=d},h=o.Z.bind((function(){var t=this.magPagesPos[this.currentPage.num];return Math.abs(c-t.y)}),this),p=this.currentPage.pageHeight,f=0===l&&!this.isFirstPage();if(i)u(r=p-l-s)?a=p-l:a=(e=r)>d&&e<s?r:s,f&&this.viewOpts.slidein&&(a+=h());else{if(f){var g=this.magPagesPos[this.currentPage.num-1];l=g?g.h:0}a=u(r=l-s)||l<s?-l:-s,f&&this.viewOpts.slidein&&(a-=this.SCROLL_SNAP-h())}this.setScrollPosition({delta:a,animate:!0})}},togglePresentationMode:function(t){!!this.isInPresentationMode!=t&&k.Z.isDesktop&&(this.isPreview||(t?((0,n.Z)("body").on("keydown",this.onKeydown),this.trigger("presentationModeOn")):((0,n.Z)("body").off("keydown",this.onKeydown),this.trigger("presentationModeOff")),this.isInPresentationMode=t))},recalcBottomArrowState:function(t){this.currentPage&&t===this.currentPage&&this.navigation&&this.navigation.recalcBottomArrowState(t)},setScrollPosition:function(t){var e;this.currentPage&&("vertical"==this.viewOpts.viewertype?(e=void 0!==t.offset?this.magPagesPos[this.currentPage.num].y+t.offset:this.getScroll()+t.delta,t.animate?this.$magScrollAnimate.animate({scrollTop:e},500):this.setScroll(e)):(e=void 0!==t.offset?t.offset:this.currentPage.$scrollWrapper.scrollTop()+t.delta,t.animate?this.currentPage.$scrollWrapper.animate({scrollTop:e},500):this.currentPage.$scrollWrapper.scrollTop(e)))},getScrollPosition:function(){if(!this.currentPage)return 0;return"vertical"==this.viewOpts.viewertype?Math.max(this.getScroll()-this.magPagesPos[this.currentPage.num].y,0):this.currentPage.$scrollWrapper.scrollTop()},getScroll:function(){return this.$magScrollContainer&&this.$magScrollContainer.scrollTop()},setScroll:function(t){this.$magScrollContainer&&this.$magScrollContainer.scrollTop(t)},onMagScroll:function(){if(document.fullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement||document.mozFullScreenElement||document.msFullscreenElement||this.hadPlayingVideoOnResize)this.hadPlayingVideoOnResize=!1;else{o.Z.isFunction(this._resetUrlStringTimeoutFunc)&&this._resetUrlStringTimeoutFunc(),this.pauseWidgetsLoadingOnScroll();var t=this.findPageOnCurrentMagScroll({pageStartsOnBottom:!(0,C._)("viewer.offPageStartOnBottom")&&this.isStickyVerticalViewer&&!k.Z.isDesktop}),e=this.getScrollParams(t);if(this.lastPageScroll=e.pageScroll,this.lastPageScrollPercent=e.pageScrollPercent,this.showPage(t.page.num,e),this.aboveGlobalAnimations&&this.aboveGlobalAnimations.onScroll({forceApply:!0,scroll:this.getScroll()}),this.trigger("mag scroll",this.getScroll()),this.$bottomArrow&&+this.magOpenTime+2e3<+new Date){this.$bottomArrow.addClass("offscreen");var i=this.$bottomArrow;delete this.$bottomArrow,setTimeout((function(){i.remove()}),400)}}},scrollMagALittle:function(){this.$magScrollAnimate.animate({scrollTop:this.getScroll()+this.getContainerSizeCached().height},500)},findPageOnCurrentMagScroll:function(t){t=t||{};var e,i,n,r,a=this.getScroll(),o=this.getContainerSizeCached(),s=(a=Math.min(Math.max(a,0),this.magHeight-o.height),this.pages.length),c=a+(t.pageStartsOnBottom?o.height-50-16-16:0);for(e=0;e<s;e++){if(i=this.pages[e],n=this.magPagesPos[i.num],c>=(r?r.y+r.h:n.y)&&c<n.y+n.h||e==s-1)return{page:i,scroll:a,pos:n};r=n}},getScrollParams:function(t){var e=Math.max(t.scroll-t.pos.y,0),i={initiator:"scroll",pageScroll:e,pageScrollPercent:e/t.page.pageHeight};if(this.viewOpts.slidein?(i.nextPageScroll=0,i.slideInNextPageScroll=t.pos.h-i.pageScroll):i.nextPageScroll=i.pageScroll-t.pos.h,i.nextPageVisible=t.pos.h-i.pageScroll<this.getContainerSizeCached().height,this.viewOpts.slidein){var n=(t.pos.h-i.pageScroll)/this.getContainerSizeCached().height;i.nextPageBlackout=Math.min(Math.max(n,0),1)}return i},onCurrentPageScroll:function(t,e){this.pauseWidgetsLoadingOnScroll(),this.aboveGlobalAnimations&&this.aboveGlobalAnimations.onScroll({forceApply:!this.isStickyVerticalViewer,scroll:e}),this.lastPageScroll=e,this.lastPageScrollPercent=this.lastPageScroll/t.pageHeight,this.loadPages.__debounced()},scrollCurrentPageALittle:function(){this.currentPage&&this.currentPage.scrollPageALittle()},focusCurrentPage:function(){this.currentPage&&this.currentPage.focusPage()},backToTopCurrentPage:function(){if("vertical"==this.viewOpts.viewertype){var t=this.findPageOnCurrentMagScroll();this.getScroll()!==t.pos.y&&this.$magScrollAnimate.animate({scrollTop:t.pos.y},500)}else this.currentPage&&this.currentPage.backToTop();RM.analytics&&RM.analytics.sendEvent("Scroll Top Link")},scrollPageToPos:function(t,e){var i,n,r=this.getPage(t),a=this.getContainerSizeCached();e=e||0,e*=r.scale,e+=r.contentPosition.top,"vertical"==this.viewOpts.viewertype?(i=this.magPagesPos[r.num],n=Math.max(0,i.y+e),n=Math.min(n,i.y+i.h-a.height),this.$magScrollAnimate.animate({scrollTop:n},500)):(this.currentPage!=r&&this.showPage(r.num),n=Math.max(0,e),r.scrollTo(n))},pauseWidgetsLoadingOnScroll:function(){},toExternalLink:function(t){var e=(0,n.Z)(t.target).closest("a").attr("href");RM.analytics&&RM.analytics.sendEvent("External Link",e)},maglink:function(t){if(2!=t.which&&!t.metaKey&&!t.ctrlKey){var e=(0,n.Z)(t.currentTarget).data("link")||(0,n.Z)(t.currentTarget).attr("href");if(!e)return!1;if(t.preventDefault(),(0,n.Z)(t.currentTarget).hasClass("back-to-top"))return this.backToTopCurrentPage();this.router.navigate(e,{trigger:!0})}},onGobackLinkClick:function(t){this.router.goBack()},onMailchimpLinkClick:function(t){var e,i=(0,n.Z)(t.currentTarget);if(!i.hasClass("disabled")){i.flashClass("disabled",3e3);try{e=JSON.parse(i.attr("data-mailchimp"))}catch(t){e=null}e&&h.Z.initMailchimpAPI((function(t){l.default.deleteCookie("MCEvilPopupClosed"),t.start(e)}))}},onAnchorLinkClick:function(t){var e=(0,n.Z)(t.currentTarget),i=parseInt(e.attr("data-anchor-link-pos"),10)||0,r=e.attr("data-page-id"),a=e.attr("data-page-uri");if(r){var o=this.pages.find((function(t){return t._id===r}));o&&(a=o.num)}i&&a&&(this.scrollPageToPos(a,i),RM.analytics&&RM.analytics.sendEvent("Anchor Link",i))},onShareLinkClick:function(t){p.share({host:(RM.common.embedDomainName||window.location.protocol+"//"+window.location.hostname)+"/",tp:(0,n.Z)(t.currentTarget).attr("data-share-provider"),source:"mag links",page:this.currentPage||this.pages[0],mag:o.Z.extend(this.model.toJSON(),{user:this.user}),forProject:"mag"==(0,n.Z)(t.currentTarget).attr("data-share-type"),customDomain:!(!RM.common.isDomainViewer&&!RM.common.embedDomainName),customDomainProfile:!(!RM.common.customDomainProfile&&"User"!=RM.common.embedDomainType),analytics:this.router.analytics})},showPageCounter:function(t){if(this.toolbar){var e=1;this.currentPage&&(e=this.currentPage.num+(t?"left"==t?1:-1:0),e=Math.max(Math.min(e,this.getPagesCount()),1)),this.toolbar.showPageCounter(this.getPage(e),{showPageCounter:!0})}},showPage:function(t,e){e=e||{},this.active||this.render();var i=this.getPage(t),n=this.currentPage,r=i&&this.getPage(i.num+1),a=this;i&&!this.aboveGlobalWidgetsRendered&&this.renderAboveGlobalWidgets(i),this.isStickyVerticalViewer?this.redrawAboveGlobalWidgets():e.nextPageVisible||"horizontal"===this.viewOpts.viewertype?this.redrawAboveGlobalWidgets(i,r,e.slideInNextPageScroll||e.nextPageScroll,e.animation):i?this.redrawAboveGlobalWidgets(i):n&&this.redrawAboveGlobalWidgets.__debounced(),"vertical"==this.viewOpts.viewertype&&(e.animation=!1,i&&i.scrollOnVerticalMode(e.pageScroll||0),i&&r&&null!=e.nextPageScroll&&(r.scrollOnVerticalMode(e.nextPageScroll),(k.Z.isDesktop||(0,C._)("viewer.offPageStartOnBottom"))&&(e.nextPageVisible?r.start():r.stop())),i&&void 0!==e.nextPageBlackout&&this.$pages_blackout.css({display:r?"block":"none",opacity:e.nextPageBlackout,"z-index":i.getPageZIndex()}));var o=!this.currentPage;if(!o&&t===this.currentPage.num)return!1;if(!i)return 1!==t&&this.router.onError(),!1;if(n)if("horizontal"==this.viewOpts.viewertype||this.isStickyVerticalViewer)n.stop();else{r==n&&e.nextPageVisible||n.stop();var s=n&&this.getPage(n.num+1);s&&!(s==i||s==r&&e.nextPageVisible)&&s.stop()}else e.animation=!1;this.pauseLoading("page-change-animation"),this.currentPage=i,n&&n.resetWaitForAnimationEnd(),clearInterval(this.showPageCompleteInterval),this.$pages_container.toggleClass("disable-transitions",!e.animation),e.animation&&(this.viewOpts.slidein&&n&&n.num>i.num?n.waitForAnimationEnd(h):i.waitForAnimationEnd(h)),this.direction=!n||n.num<i.num?"forward":"backward";var c=i.num-this.getPreloadPageCount(i.num-1,"forward"===this.direction?"backward":"forward"),l=i.num+this.getPreloadPageCount(i.num-1,this.direction);"horizontal"!=this.opts.viewertype||this.opts.arrows||(c=l=i.num);for(var d=0;d<this.pages.length;d++){var u=this.pages[d];u.num<i.num?u.setPosition("prev",u.num+1==i.num):u.num>i.num?u.setPosition("next",u.num-1==i.num):u.setPosition("center",u.num==i.num),u.num>=c&&u.num<=l&&u.show(),"vertical"==this.viewOpts.viewertype&&(u.num<i.num||u.num>i.num+1)&&u.resetScrollOnVerticalMode()}function h(){function t(){for(var t=0;t<a.pages.length;t++){var e=a.pages[t];(e.num<c||e.num>l)&&e.hide()}i.start(),a.loadPages()}e.animation||o||window.requestAnimationFrame((function(){a.$pages_container.removeClass("disable-transitions")})),a.continueLoading("page-change-animation"),"vertical"==a.viewOpts.viewertype&&"scroll"!=e.initiator&&a.setScroll(a.magPagesPos[i.num].y),a.isPreview&&a.$el.scrollTop(0),clearInterval(a.showPageCompleteInterval),a.loadingPaused?a.showPageCompleteInterval=setInterval((function(){a.loadingPaused||(clearInterval(a.showPageCompleteInterval),t())}),17):t()}!e.animation&&h(),this.scheduleSetUrlString({replace:!o,skipInternalHistory:e.skipInternalHistory}),this.router.setTitle(),this.trigger("pageChanged",i,{showPageCounter:e.animation||e.bySwipe||o||"scroll"==e.initiator,initial:o}),i.trigger("changedTo"),"vertical"==this.viewOpts.viewertype&&this.updateArrowsColor(i)},scheduleSetUrlString:function(){if(!Modernizr.chrome)return this.router.setUrlString.apply(this.router,arguments),void(this._resetUrlStringTimeoutFunc=!1);var t=arguments;this._resetUrlStringTimeoutFunc=function(){clearTimeout(this._urlStrigScheduleTimeout),this._urlStrigScheduleTimeout=setTimeout(function(){this._resetUrlStringTimeoutFunc=null,this.router.setUrlString.apply(this.router,t)}.bind(this),100)}.bind(this),this._resetUrlStringTimeoutFunc()},goNextPage:function(t){this.isLastPage()||this.currentPage&&this.router.go(this.currentPage.num+1,j(j({},t),{},{isPageNum:!0}))},goPrevPage:function(t){this.isFirstPage()||this.currentPage&&this.router.go(this.currentPage.num-1,j(j({},t),{},{isPageNum:!0}))},goFirstPage:function(){this.router.go(1,{isPageNum:!0})},goLastPage:function(){this.router.go(this.getPagesCount(),{isPageNum:!0})},pauseLoading:function(t){this.pauseReasons=this.pauseReasons||{},this.pauseReasons[t]=!0,this.loadingPaused=!0},continueLoading:function(t){this.pauseReasons=this.pauseReasons||{},this.pauseReasons[t]=!1,this.loadingPaused=!o.Z.every(o.Z.values(this.pauseReasons),(function(t){return!t}))},loadPages:function(){if(window.RM.timing[d.qK.LoadPagesStart]=Date.now(),this.pages&&this.pages.length){var t=this.getPagesLoadOrder();if(t&&t.length){var e,i,n=[],r=[];for(e=0;e<t.length;e++){var a=(i=this.pages[t[e]]).getWidgetsPacks();a.length&&n.push(a),r=r.concat(i.getImmediatePack())}if(n.length){var o=[];for(e=0;e<n.length;e++){0==e&&c(e,0),c(e+1,0);for(var s=1;s<n[e].length;s++)c(e,s)}o.unshift(r),this.widgetsPacksLoadQueue=o,this.stopPagesLoad(),this.loadNextWidgetsPack()}}}function c(t,e){t<0||t>=n.length||e<0||e>=n[t].length||o.push(n[t][e])}},stopPagesLoad:function(){clearTimeout(this.loadNextWidgetsTimer)},loadNextWidgetsPack:function(){if(!this.widgetsPacksLoadQueue.length)return window.RM.timing[d.qK.LoadPagesEnd]=Date.now(),void a().trigger("widgetsQueue:empty",this.num_id);if(this.loadingPaused)this.loadNextWidgetsTimer=setTimeout(this.loadNextWidgetsPack,50);else{var t=this.widgetsPacksLoadQueue.shift();if(t.length){var e=o.Z.uniq(o.Z.map(t,"page")),i=e[0];if(1!==e.length||i.shown&&!i.loaded){this.widgetPackCount;i.loadWidgetsPack(t,o.Z.bind((function(){this.widgetPackCount++,this.loadNextWidgetsTimer=setTimeout(this.loadNextWidgetsPack,17)}),this))}else this.loadNextWidgetsTimer=setTimeout(this.loadNextWidgetsPack,17)}else this.loadNextWidgetsTimer=setTimeout(this.loadNextWidgetsPack,17)}},getPreloadPageCount:function(t,e){if("horizontal"==this.viewOpts.viewertype)return this.PRELOAD_COUNT[e];for(var i=1,n=0,r="forward"==e?1:-1;n<this.PRELOAD_COUNT[e]&&i*r+t<this.pages.length&&i*r+t>=0;)n+=this.pages[i*r+t].height,i++;return i},getPagesLoadOrder:function(){var t=this.currentPage;if(t){var e,i=t.num-1,n=this.pages.length,r=[],a=this,o=t.num-this.getPreloadPageCount(i,"forward"==this.direction?"backward":"forward"),s=t.num+this.getPreloadPageCount(i,this.direction);if(c(i),"backward"==this.direction){for(c(i-1),c(i+1),e=i-2;e>=o;e--)c(e);for(e=i+2;e<=s;e++)c(e)}else{for(c(i+1),c(i-1),e=i+2;e<=s;e++)c(e);for(e=i-2;e>=o;e--)c(e)}return r}function c(t){t<0||t>=n||!a.pages[t].shown||a.pages[t].loaded||r.push(t)}},onGestureChange:function(){this.onResize.__debounced()},checkFullscreen:function(){this.fullscreenCheckCounter=5,clearInterval(this.fullscreenCheckTimer),this.fullscreenCheckTimer=setInterval(o.Z.bind((function(){var t=window.fullScreen||window.innerWidth==screen.width&&window.innerHeight>=screen.height-1;this.togglePresentationMode(t),this.fullscreenCheckCounter--,this.fullscreenCheckCounter||clearInterval(this.fullscreenCheckTimer)}),this),500)},onResize:function(t){var e=this;if(this.checkFullscreen(),!k.Z.isDesktop&&"horizontal"==this.viewOpts.viewertype||"vertical"==this.viewOpts.viewertype&&!this.isStickyVerticalViewer){var i="horizontal"==this.viewOpts.viewertype?(0,n.Z)("html, body").add(this.$el):this.$el,r=l.default.isPageNativelyScaled(),a=window.innerHeight;337==a&&414==(0,n.Z)(window).height()&&a++,i.height(r?"100%":a),!r&&i.scrollTop(0)}var s=this.getContainerSize(),c=this.isPortrait()?"portrait":"landscape",d=!1;if(!k.Z.isDesktop&&this.prevOrientation&&this.prevOrientation!==c){var u=this.getPage(this.currentPage.num-1),h=v.Z.findPlayingVideo(this.currentPage.widgets)||v.Z.findPlayingVideo(null==u?void 0:u.widgets),p=!!h&&D.Z.doBoundingBoxesIntersect(h.$el[0].getBoundingClientRect(),{top:0,left:0,bottom:window.innerHeight,right:window.innerWidth});h&&p?(this.hadPlayingVideoOnResize=!0,setTimeout((function(){h.page.num===e.currentPage.num&&e.setScrollPosition({offset:h.y*e.getScale(e.currentPage.pageViewport)})}),500)):(this.hadPlayingVideoOnResize=!1,this.switchToViewport(this.getMagViewport()),this.setPagesTransitions(),this.stopPagesLoad(),setTimeout(this.onResize,300),setTimeout(this.onResize,1500)),d=!0}if(this.prevOrientation=c,this.isPreview&&"default"!=this.viewport){var f=Math.round((this.$el.width()-s.width)/2),g=Math.round((this.$el.height()-s.height)/2);this.$mag_container.add(this.$mag_viewport_device).css({top:Math.max(g,0),left:Math.max(f,0),width:s.width,height:s.height})}else this.$mag_container.add(this.$mag_viewport_device).css({top:"",left:"",width:"",height:""});this.$mag_viewport_device.attr("data-viewport",this.viewport),this.setNewPagesWidths(s.width,s.height),this.magHeight=0,this.magPagesPos=[];var m=this.pages&&this.pages.length;if(o.Z.each(this.pages,o.Z.bind((function(t,e){var i=t.onResize({absolutePosition:this.magHeight}),n=0;e<m-1&&this.viewOpts.slidein&&(n=this.SCROLL_SNAP),this.magPagesPos[t.num]={y:this.magHeight,h:i,dh:n},this.magHeight+=i+n}),this)),"vertical"===this.viewOpts.viewertype&&this.magHeight){var y=this.$magScrollSizer.width(),b=0;if(this.isPreview&&"default"!==this.viewport&&(b=Math.max(this.$el.height()-this.getViewportSetting("min_height"),0)),this.$magScrollSizer.css("height",this.magHeight+b),y!=this.$magScrollSizer.width()&&k.Z.isDesktop&&this.onResize(),this.currentPage)if(this.isStickyVerticalViewer||this.hadPlayingVideoOnResize){if(d&&!this.hadPlayingVideoOnResize){var w=this.getScrollPosForNewSize();setTimeout(o.Z.bind((function(){this.setScroll(w)}),this),0)}}else this.setScroll(this.getScrollPosForNewSize()),this.onMagScroll();this.$bottomArrow&&this.$bottomArrow.toggleClass("offscreen",this.getScroll()+s.height+this.SCROLLABLE_TRESHOLD>this.magHeight)}if("horizontal"==this.viewOpts.viewertype&&this.currentPage&&d&&!this.hadPlayingVideoOnResize){w=this.getScrollPosForNewSize();setTimeout(o.Z.bind((function(){this.currentPage.$scrollWrapper.scrollTop(w)}),this),0),this.aboveGlobalWidgetsRendered||setTimeout(o.Z.bind((function(){this.aboveGlobalWidgetsRendered||this.renderAboveGlobalWidgets(this.currentPage)}),this),40)}this.currentPage&&this.loadPages.__debounced()},onOptsChange:function(){window.dispatchEvent(new Event("resize"))},getScrollPosForNewSize:function(){return this.currentPage?"vertical"==this.viewOpts.viewertype?this.magPagesPos[this.currentPage.num].y+(this.lastPageScrollPercent||0)*this.currentPage.pageHeight:(this.lastPageScrollPercent||0)*this.currentPage.pageHeight:0},setNewPagesWidths:function(t,e){var i=this.$el.find("#page-position-style"),r=k.Z.isDesktop?"":" translateZ(0)",a="        .mag .mag-pages-container .container {\n          left: 0px;\n          width: "+t+"px;\n        }\n        .mag .mag-pages-container .container .page {\n          left: 0px;\n          width: "+t+"px;\n        }\n",o="";if("horizontal"==this.viewOpts.viewertype)o="          .mag .mag-pages-container .container .page.prev-page {\n            -webkit-transform: translateX("+(this.viewOpts.slidein?0:-t)+"px) "+r+";\n            transform: translateX("+(this.viewOpts.slidein?0:-t)+"px) "+r+";\n          }\n          .mag .mag-pages-container .container .page.center-page {\n            -webkit-transform: translateX(0) "+r+";\n            transform: translateX(0) "+r+";\n          }\n          .mag .mag-pages-container .container .page.next-page {\n            -webkit-transform: translateX("+t+"px) "+r+";\n            transform: translateX("+t+"px) "+r+";\n          }";else if(this.isStickyVerticalViewer){var s=this.getContainerSizeCached().height;o="            .mag .mag-pages-container .container .page .page-fixed-bg-container,            .mag .mag-pages-container .container .page .fixed-position-container,            .mag .mag-pages-container .container .page .fixed-position-container-top {              height: "+s+"px;            }\n            .mag .mag-pages-container .container .page .fixed-position-container,            .mag .mag-pages-container .container .page .fixed-position-container-top,            .mag .mag-pages-container .container .page:not(.hide-sticky) .content-scroll-wrapper {              margin-top: "+-s+"px;            }\n"}else o="            .mag .mag-pages-container .container .page.prev-page {\n              top: "+(-e-1)+"px;            }\n            .mag .mag-pages-container .container .page.next-page {\n              top: "+(e+1)+"px;            }\n";i.length||(i=(0,n.Z)('<style id="page-position-style" type="text/css">')).appendTo(this.$el),"horizontal"==this.viewOpts.viewertype?(this.$pages_container.addClass("disable-transitions-on-resize"),i.text(a+o),this.$pages_container.height(),this.$pages_container.removeClass("disable-transitions-on-resize")):i.text(a+o)},setPagesTransitions:function(){var t=this.$el.find("#page-transition-style"),e=this.getPageTransitionTime(),i="cubic-bezier(0.40, 0.24, 0.40, 1)",r="        .mag .mag-pages-container .container .page {\n          -webkit-transition:\tall "+e+"ms "+i+";          transition: all "+e+"ms "+i+";        }\n        .mag .mag-pages-container .container .page.center-page {\n          -webkit-transition:\tall "+(e-5)+"ms "+i+";          transition: all "+(e-5)+"ms "+i+";        }\n        ";t.length||(t=(0,n.Z)('<style id="page-transition-style" type="text/css">')).appendTo(this.$el),t.text(r)},switchToViewport:function(t){if(this.viewport!=t){var e=this.viewport;this.containerSize=null,this.viewport=t,this.trigger("change:viewport",{viewport:this.viewport,oldViewport:e}),this.aboveGlobalWidgetsRendered=!1,this.aboveGlobalWidgets&&this.aboveGlobalWidgets.forEach((function(t){t.destroy(),t.off()})),this.aboveGlobalAnimations&&this.aboveGlobalAnimations.destroy(),this.aboveGlobalWidgets=[],o.Z.each(this.pages,(function(t){t.updateViewport()}))}},getContainerSize:function(){var t,e,i=this;return this.isPreview&&"default"!=this.viewport?(t=this.getViewportWidth(this.viewport),e=Math.min(this.getViewportSetting("min_height"),this.$el.height())):(t=RM.screenshot?(0,n.Z)(window).width():this.$el.width(),e=RM.screenshot?window.innerHeight:this.isStickyVerticalViewer&&Modernizr.safari&&!k.Z.isDesktop?i.isPortrait()?Math.max(window.innerHeight,screen.height-20-20+1):Math.min(screen.width,screen.height):this.isStickyVerticalViewer?window.innerHeight:this.$el.height()||window.innerHeight),this.containerSize={width:t,height:e},this.containerSize},getContainerSizeCached:function(){return this.containerSize||this.getContainerSize()},getViewportWidth:function(t){return t&&t!==y.sJ.Default?t===y.sJ.PhonePortrait?this.phoneWidth||y.ZP.dictionary[y.sJ.PhonePortrait].width:y.ZP.dictionary[t].width:this.desktopWidth||y.ZP.dictionary[y.sJ.Default].width},isPortrait:function(){return window.screen?window.screen.orientation&&window.screen.orientation.type?!!window.screen.orientation.type.match(/portrait/i):0===window.orientation||90!==window.orientation&&-90!==window.orientation&&window.innerWidth<window.innerHeight:window.innerWidth<window.innerHeight},getMagViewport:function(){var t=this.isPortrait();if(this.isPreview)return this.constructorViewport||"default";var e=y.sJ.Default,i=window.innerWidth;if(Modernizr.retina||!k.Z.isDesktop||Modernizr.ismobile){if(screen&&screen.width&&(i=t?Math.min(screen.width,screen.height):Math.max(screen.width,screen.height)),t)return i<600?y.sJ.PhonePortrait:i>=600&&i<=1024?y.sJ.TabletPortrait:y.sJ.Default;if(i>980)return y.sJ.Default}if(Modernizr.isipad)return t?y.sJ.TabletPortrait:y.sJ.Default;if(!k.Z.isDesktop){var n=i,r=o.Z.reduce(y.ZP.viewports,(function(t,e,i){return Math.abs(e.width-n)<=Math.abs(y.ZP.viewports[t].width-n)?i:t}),0);e=y.ZP.viewports[r].name}return e},getViewportSetting:function(t,e){return(y.ZP.dictionary[e||this.viewport]||{})[t]},log:function(){for(var t="",e=0;e<arguments.length;e++)t+=arguments[e]+" ";var i=(0,n.Z)("#log");i.length||(i=(0,n.Z)('<div id="log">').css({position:"fixed",background:"rgba(0, 0, 0, 0.7)",color:"#fff",width:200,height:300,left:10,top:10,"z-index":999999,overflow:"auto"}).appendTo("body"));var r=i.html(),a=r.split("<br>");i.html(a.slice(-17).join("<br/>")+"<br/>"+t),i.scrollTop(999999)},fixFocusScroll:function(){this.$mag_container.scrollTop(0),this.$mag_container.scrollLeft(0)},matchSameDomainLink:function(t){var e=t.match(new RegExp("//"+l.default.escapeSpecial(window.location.hostname)+"/(.*)")),i=e&&e[1];if(i){var n=this.getPageByPath(i);if(n)return n._id}return t},getScale:function(t){if(RM.screenshot)return 1;var e=Math.min(this.viewOpts.scalewidth,this.getContainerSizeCached().width),i=this.getViewportWidth(t),n=e/i;return m.Z.normalize(n,void 0,this.viewport,i,this.opts)},getWidgetById:function(t,e){var i,n,r=e&&e.getWidgetDataById(t)?e:o.Z.find(this.pages,(function(e){return e.getWidgetDataById&&e.getWidgetDataById(t)}));return r?(n=r.getWidgetById(t))?i=window.Promise.resolve(n):r.loaded||(i=new window.Promise(function(e,i){this.listenToOnce(r,"loaded"+t,(function(){var n=r.getWidgetById(t);n?e(n):i()}))}.bind(this))):o.Z.find(this.aboveGlobalWidgetsData,{_id:t})&&((n=o.Z.find(this.aboveGlobalWidgets,{_id:t}))?i=window.Promise.resolve(n):this.aboveGlobalWidgetsRendered||(i=new window.Promise(function(e,i){this.listenToOnce(this,"aboveGlobalWidgetsRendered",(function(){var n=o.Z.find(this.aboveGlobalWidgets,{_id:t});n?e(n):i()}))}.bind(this)))),i||window.Promise.reject()},renderAboveGlobalWidgets:function(t){var e=[],i=t.pageViewport;o.Z.each(this.aboveGlobalWidgetsData,function(n){var r,a=o.Z.find(this.aboveGlobalWidgets,{_id:n._id});if(a&&(a.destroy(),a.off()),n){var s=t.getWidgetViewportData(n,i),c=!this.isPreview&&g.Z.hasExpired(s);b.Widgets[s.type]&&!c&&((r=new b.Widgets[s.type](s,t)).$fixedContainer=this.$aboveWidgetsContainer,r.isValid()&&e.push(r))}}.bind(this)),this.aboveGlobalAnimations=this.initializeAboveGlobalAnimation(e,t),o.Z.each(e,(function(e){e.render(),e.hidden||t.isPasswordProtected()?f.Z.hide(e,!0):f.Z.show(e,!0)})),this.aboveGlobalWidgets=o.Z.sortBy(e,"y"),this.aboveGlobalWidgetsRendered=!0,this.trigger("aboveGlobalWidgetsRendered")},initializeAboveGlobalAnimation:function(t,e){t=o.Z.isArray(t)?t:[t],e.scale=this.getScale(e.pageViewport);var i=new w.Z({page:e,widgets:t}),n=[];return o.Z.each(t,(function(t){var e=new window.Promise((function(e){t.loaded?e(t):t.on("loaded",e.bind(null,t))}));n.push(e)})),window.Promise.all(n).then(function(){this.aboveAnimationsReady=!0,this.trigger("aboveAnimationsReady")}.bind(this)),this.listenTo(e,"resize",(function(t){o.Z.isUndefined(t.prevScale)||t.prevScale===t.scale||i.updateTimelines(),i.onResize({updateAll:!0})})),i},updateAboveGlobalViewport:function(t,e){var i=o.Z.find(this.aboveGlobalWidgetsData,{_id:t._id}),n=e.getWidgetViewportData(i,e.pageViewport);if(t.animationObj&&this.aboveGlobalAnimations.removeAnimation(t.animationObj),t.destroy(),t.initialize(n,e),t.hasAnimation()){var r=this.aboveGlobalAnimations.addAnimation(t);r&&r.start()}t.render(),f.Z.hide(t,!0)},getAboveGlobalBox:function(t,e,i){var n=o.Z.find(this.aboveGlobalWidgetsData,{_id:t}),r=e.getWidgetViewportData(n,e.pageViewport);return l.default.getFixedPositionBox(r.fixed_position,o.Z.pick(r,["x","y","w","h"]),e.scale,i)},redrawAboveGlobalWidgets:function(t,e,i,n){if(!t){var r=o.Z.isUndefined(this.getScroll())?void 0:this.findPageOnCurrentMagScroll(),a=r&&r.page.num,s=r&&this.getScrollParams(r);t=a&&this.getPage(a),e=t&&this.getPage(t.num+1),i=s&&(s.slideInNextPageScroll||s.nextPageScroll),n=s&&s.animation}i=o.Z.isUndefined(i)?void 0:Math.abs(i);var c={width:Math.min(this.viewOpts.scalewidth,this.getContainerSizeCached().width),height:this.getContainerSizeCached().height},d=function(t,e){return!t.page||e&&t.page.pageViewport!==e.pageViewport};if(o.Z.isUndefined(i)){var u=this.getPageTransitionTime();o.Z.each(this.aboveGlobalWidgets,function(e){var i=t._id&&!f.Z.isHidden(e,t._id,this.isPreview)&&!t.isPasswordProtected(),r=t._id&&d(e,t);t._id&&e.updatePage(t),r&&this.updateAboveGlobalViewport(e,t),i?n?e.wasHidden&&l.default.waitForTransitionEnd(t.$el,u,"transform",f.Z.show.bind(null,e)):e.wasHidden&&f.Z.show(e):!e.wasHidden&&f.Z.hide(e)}.bind(this))}else{var h=Math.abs(i);o.Z.each(this.aboveGlobalWidgets,function(i){var n=!f.Z.isHidden(i,t._id,this.isPreview)&&!t.isPasswordProtected(),r=e&&!f.Z.isHidden(i,e._id,this.isPreview)&&!e.isPasswordProtected(),a=n&&r&&t.pageViewport===e.pageViewport,o=this.getAboveGlobalBoxMemoized(i._id,t,c),s=this.getAboveGlobalBoxMemoized(i._id,e||t,c),l=n&&h>o.top+o.height,u=e&&r&&s.top>h;if(l||u||a||!e&&n){var p=l?t:u?e:i.page,g=d(i,p);i.updatePage(p),g?(i.rendered=!1,f.Z.hide(i).then(function(){this.updateAboveGlobalViewport(i,p),f.Z.show(i)}.bind(this))):i.wasHidden&&f.Z.show(i)}else!i.wasHidden&&f.Z.hide(i)}.bind(this))}},getUsedFonts:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u.Z.getUsedFontsFromWidgetsModels(j(j({},t),{},{models:this.pages.reduce((function(t,e){return e.widgets.reduce((function(t,e){return t.push(e)&&t}),t)}),[]),customList:t.includeCustom?o.Z.filter(this.edit_params&&this.edit_params.fonts,{provider:"custom"}):[]}))},hasCodeInjection:function(){var t=this;if(o.Z.any(["ci_head","ci_body_top","ci_body_bottom","ci_css"],(function(e){return!!t[e]})))return!0;var e=!1;return o.Z.each(this.pages,(function(t){o.Z.each(t.widgetsData,(function(t){var i=!("iframe"!==t.type||!t.code);if(i&&!t.use_iframe){var n="codeinjection"===E()(t.code,t);if(n){var r=!(!o.Z.all(y.ZP.viewport_listall,(function(e){var i=t[e];return i&&i.hidden||!i}))||!t.hidden);i&&n&&!r&&(e=!0)}}}))})),e},setupEcommerceSidebar:function(){"ecwid"===this.eCommerceManager.getConnectedProvider()?this.cartSidebar=new T.Z(this):this.cartSidebar=new O.Z(this)}});e.Z=R},1076:function(t,e,i){"use strict";var n=i(312),r=i(336),a=i.n(r),o=i(321),s=i(340),c=i(1077),l=i(323),d=i(347),u=i(710),h=a().View.extend({ARROWS_SHOW_DELAY:1e3,BOTTOM_SHOW_DELAY:1e3,BOTTOM_HIDE_DELAY:0,template:c.Z["template-viewer-navigation"],events:{"click .navigation-arrow.left":"goPrevPage","click .navigation-arrow.right":"goNextPage","click .navigation-arrow.bottom":"scrollCurrentPage"},initialize:function(t){return o.Z.bindAll(this),o.Z.extend(this,t),this.updateScaleState.__debounced=o.Z.debounce(this.updateScaleState,100),this},render:function(){return this.setElement(this.template({icons:{sprite:(0,d.findImagePath)("./common/navigation/sprite".concat(d.is2X?"@2x":"",".png"))}})),this.$el.appendTo(this.$container),this.$prev=this.$(".navigation-arrow.left"),this.$next=this.$(".navigation-arrow.right"),this.$bottom=this.$(".navigation-arrow.bottom"),o.Z.delay(o.Z.bind((function(){this.$prev.removeClass("offscreen"),this.$next.removeClass("offscreen")}),this),this.ARROWS_SHOW_DELAY),this.listenTo(this.mag,"pageChanged",this.onPageChange),this.listenTo(this.mag,"keypress-"+n.Z.keycodes.left,this.goPrevPage),this.listenTo(this.mag,"keypress-"+n.Z.keycodes.right,this.goNextPage),l.Z.isDesktop&&(0,n.Z)(window).bind("mousewheel",this.onMouseWheel),l.Z.isDesktop||((0,n.Z)(window).bind("gesturechange",this.updateScaleState.__debounced),this.updateScaleState(),this.mag.getPagesCount()>1&&this.setSwipeAction()),this},destroy:function(){return l.Z.isDesktop&&(0,n.Z)(window).unbind("mousewheel",this.onMouseWheel),l.Z.isDesktop||((0,n.Z)(window).unbind("gesturechange",this.updateScaleState.__debounced),this.pagesSwipe&&this.pagesSwipe.destroy()),this.remove()},onMouseWheel:function(t,e,i,n){this.preventTrackpadSwipeTill&&+new Date<this.preventTrackpadSwipeTill||Math.abs(i)>40&&Math.abs(i)>Math.abs(n)&&(i>0&&this.goPrevPage(),i<0&&this.goNextPage(),this.preventTrackpadSwipeTill=+new Date+1e3)},setSwipeAction:function(){this.pagesSwipe=this.mag.$mag_container.RMSwipe({$scrollElements:this.mag.$mag_container,getMaxTransitionSpeed:o.Z.bind((function(){return this.mag.getPageTransitionTime()}),this),customMoveCheck:o.Z.bind((function(t,e){return!(t.hasClass("prev-page")&&e<0)&&!(t.hasClass("next-page")&&e>0)}),this),beforeAutoAnimation:o.Z.bind((function(t,e){return this.mag.showPageCounter(t),{autoAnimate:!0,immediateCallback:!1}}),this),onSwipeStart:o.Z.bind((function(){this.mag.showPageCounter()}),this),getCurrentConstraints:o.Z.bind((function(t){var e={},i=this.mag.$mag_container.width(),n=t.closest(".page, .final-page");return n.length||(n=this.mag.currentPage.$el),e.$moveItems=n.add(n.prev()).add(n.next()),e.$referenceItem=e.$moveItems.filter(":not(.center-page)").first(),this.mag.isLastPage()?e.left={max:0,noTrigger:!0}:e.left={max:i},this.mag.isFirstPage()?e.right={max:0,noTrigger:!0}:e.right={max:i},e}),this),callback:o.Z.bind((function(t){"right"===t&&this.mag.goPrevPage({animation:!1,bySwipe:!0}),"left"===t&&this.mag.goNextPage({animation:!1,bySwipe:!0})}),this)}).data("swipe")},onPageChange:function(t,e){this.$next.toggleClass("hidden",!!this.mag.isLastPage()),this.recalcBottomArrowState(t),this.$prev.toggleClass("hidden",this.mag.isFirstPage()),this.mag.updateArrowsColor(t)},recalcBottomArrowState:function(t){clearTimeout(this.bottomArrowTimeout);var e=t.isBottomArrowVisible();"horizontal"===this.viewerType&&u.Z.isScaleLayout(this.mag.viewOpts)&&(e=!1),this.isPreview&&"default"!==this.mag.viewport&&(e=!1),this.bottomArrowTimeout=setTimeout(o.Z.bind((function(){this.$bottom.toggleClass("offscreen",!e)}),this),e?this.BOTTOM_SHOW_DELAY:this.BOTTOM_HIDE_DELAY)},goPrevPage:function(t){this.mag.goPrevPage({animation:!0})},goNextPage:function(t){this.mag.goNextPage({animation:!0})},scrollCurrentPage:function(t){this.mag.scrollCurrentPageALittle()},updateScaleState:function(){Modernizr.android||this.$prev.add(this.$next).add(this.$bottom).toggleClass("scaled-offscreen",s.default.isPageNativelyScaled())}});e.Z=h},1065:function(t,e,i){"use strict";var n=i(312),r=i(336),a=i.n(r),o=i(321),s=i(1066),c=i(1019),l=i(340),d=i(935),u=i(710),h=i(736),p=i(1067),f=i(348),g=i(944),m=i(343),v=i(735),y=i(1008),b=i(1068),w=i(323),S=i(350);function P(t,e,i,n,r,a,o){try{var s=t[a](o),c=s.value}catch(t){return void i(t)}s.done?e(c):Promise.resolve(c).then(n,r)}function k(t){return function(){var e=this,i=arguments;return new Promise((function(n,r){var a=t.apply(e,i);function o(t){P(a,n,r,o,s,"next",t)}function s(t){P(a,n,r,o,s,"throw",t)}o(void 0)}))}}function C(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function x(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?C(Object(i),!0).forEach((function(e){O(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):C(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function O(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var T,_=x(x({},s.Z),c.Z),Z=a().View.extend({template:_["template-viewer-page"],initialize:function(t){return o.Z.bindAll(this),this.mag=t.mag,this.router=t.router,this.$container=t.$container,this.viewerType=t.viewerType,this.totalPages=t.totalPages,this.isStickyVerticalViewer=t.isStickyVerticalViewer,this.widgetsData=t.pageData.wids,this.viewOpts=t.viewOpts,o.Z.defaults(t.pageData,{title:"",width:this.mag.getViewportWidth(t.mag.viewport),height:this.mag.getViewportSetting("min_height")}),o.Z.extend(this,o.Z.omit(t.pageData,["wids","widgets"])),this.contentPosition={left:0,top:0},this},render:function(){return this.setElement(this.template({isStickyVerticalViewer:this.isStickyVerticalViewer,pageNum:this.num})),this.$el.appendTo(this.$container),RM.screenshot||Modernizr.csspositionsticky||(0,n.Z)(".polyfill-sticky").Stickyfill(),this.zIndex=this.totalPages-this.num+2,"vertical"===this.viewerType&&this.$el.css("z-index",this.zIndex),this.$content=this.$(".page-content-container"),this.$scrollWrapper=this.$(".content-scroll-wrapper"),this.$scrollWrapper.one("scroll",this.fixSafariScroll),this.$fixedBgContainer=this.$(".page-fixed-bg-container"),this.$fixedPositionContainer=this.$(".fixed-position-container"),this.$fixedPositionContainerTop=this.$(".fixed-position-container-top"),this.$contentBounds=this.$(".content-bounds"),this.$pagePasswordContainer=this.$(".page-password-container"),this.pageViewport=this.getPageViewport(),"horizontal"===this.viewerType&&this.$scrollWrapper.bind("scroll",this.onScroll),this.createLQBackground(),RM.screenshot===this._id&&(this.$el.css({overflow:"hidden",height:Math.max(this.height,672),width:this.mag.getViewportWidth(m.sJ.Default),position:"relative"}),"true"===l.default.queryUrlGetParam("pdf")&&(this.$fixedPositionContainer.css({height:"100%"}),this.$fixedPositionContainerTop.css({height:"100%"})),this.onResize(),this.on("pageLoaded",(function(){this.mag.router.sendReadyEvent({page:this})}),this)),this},show:function(){if(!this.shown){if(this.$el.removeClass("hidden"),this.shown=!0,this.isPasswordProtected()&&!this.passwordFormShown)return this.showPagePasswordForm(),this.passwordFormShown=!0,this;"horizontal"===this.viewerType&&this.onResize(),this.widgets&&this.lastViewportUsedForWidgetsCreation===this.pageViewport||this.createWidgetsForCurrentViewport()}return this},start:function(t){if(!this.started||t&&t.forceStart)return this.started=!0,this.trigger("started"),t=t||{},o.Z.each(this.widgets,(function(e){(!t||!t.widgetTypes||o.Z.indexOf(t.widgetTypes,e.type)>=0)&&e.start()})),this.focusPage(),this.$scrollWrapper.addClass("accelerated-scroll"),this.animations&&this.animations.start(),this.mag.aboveGlobalAnimations&&this.mag.aboveGlobalAnimations.start(),this},stop:function(t){if(this.started)return t=t||{},this.started=!1,this.trigger("stopped"),this.$scrollWrapper.removeClass("accelerated-scroll"),o.Z.each(this.widgets,(function(e){(!t||!t.widgetTypes||o.Z.indexOf(t.widgetTypes,e.type)>=0)&&e.stop()})),this.animations&&this.animations.stop(),this.mag.aboveGlobalAnimations&&this.mag.aboveGlobalAnimations.stop(),this},getUrl:function(){return window.location.protocol+"//"+window.location.hostname+"/p"+this.num_id+"/"},setPosition:function(t,e){this.lastPosition==t&&this.lastNeighbour==e||(this.$el.removeClass("center-page prev-page next-page neighbour").addClass(t+"-page "+(e?"neighbour":"")),this.lastPosition=t,this.lastNeighbour=e)},getScroll:function(){return this.visibleWidgetsCoords.scrollTop},scrollOnVerticalMode:function(t){this.hasScrollOnVerticalMode=!0;var e,i,n=this.pageHeight-this.pageBgHeight;t<0?(e=-t,i=0):n>=t?(e=0,i=-t):(e=n-t,i=-n),this.visibleWidgetsCoords=this.visibleWidgetsCoords||{},this.visibleWidgetsCoords.scrollTop=-i,this.animations&&this.animations.onScroll({forceApply:!this.isStickyVerticalViewer}),this.trigger("page scroll",this.getScroll()),this.isStickyVerticalViewer||(this.$el.css("top",0),l.default.applyTransform(this.$el,e?"translateY("+e+"px) translateZ(0)":""),this.hasFixedWidgets?this.$contentBounds.css("top",i):l.default.applyTransform(this.$contentBounds,i?"translateY("+i+"px)":""))},resetScrollOnVerticalMode:function(t){this.hasScrollOnVerticalMode&&(this.hasScrollOnVerticalMode=!1,this.visibleWidgetsCoords=this.visibleWidgetsCoords||{},this.visibleWidgetsCoords.scrollTop=0,this.animations&&this.animations.onScroll({forceApply:!this.isStickyVerticalViewer}),this.isStickyVerticalViewer||(this.$el.css("top",""),l.default.applyTransform(this.$el,""),this.hasFixedWidgets?this.$contentBounds.css("top",0):l.default.applyTransform(this.$contentBounds,"")))},hide:function(){return this.shown&&(this.$el.addClass("hidden"),this.shown=!1),this},destroyAllWidgets:function(t){this.loaded=!1,this.videoBGStarted=!1,o.Z.each(this.widgets,function(e,i){var n=this.widgetsData.some((function(t){var i=h.Z.normalizeAnimations(t.animation),n=t._id===e._id&&Boolean(i.find((function(t){return!h.Z.isEmpty(t)}))),r=t._id===e._id&&(t.viewport_default&&t.viewport_default.hidden||t.viewport_tablet_portrait&&t.viewport_tablet_portrait.hidden||t.viewport_phone_portrait&&t.viewport_phone_portrait.hidden||t.hidden);return n||r}));t&&t.includes(e.type)&&!n||(e.destroy(),e.off(),delete this.widgets[i])}.bind(this)),this.animations&&this.animations.destroy(),delete this.animations,clearTimeout(this.fireReadyTimeout)},destroy:function(){return this.retargetScroll&&this.retargetScroll.restore&&this.retargetScroll.restore(),this.resetWaitForAnimationEnd(),this.destroyLQBackground({animate:!1}),this.destroyAllWidgets(),this.remove()},onFormFocus:function(t){!Modernizr.safari&&w.Z.isDesktop||(t=o.Z.isUndefined(t)?this.$scrollWrapper&&this.$scrollWrapper.scrollTop():t,this.$fixedBgContainer.css({top:t}))},onFormBlur:function(){!Modernizr.safari&&w.Z.isDesktop||this.$fixedBgContainer.css({top:0})},onScrollWithFormInFocus:function(t){!Modernizr.safari&&w.Z.isDesktop||(t=o.Z.isUndefined(t)?this.$scrollWrapper&&this.$scrollWrapper.scrollTop():t,this.$fixedBgContainer.css({top:t}))},isSwipeInProgress:function(){return this.$el.hasClass("swiping")},getPageZIndex:function(){return this.zIndex||1},getImmediatePack:function(){return o.Z.filter(this.widgets,(function(t){return t.canRenderImmediately()&&!t.rendered}))},getWidgetsPacks:function(){if(!this.widgets)return[];var t,e,i,n=this.visibleWidgetsCoords,r=(n.top+(n.scrollTop||0))/n.scale,a=(n.bottom+(n.scrollTop||0))/n.scale-r,o=[],s=[];if(!this.BGWidget||this.BGWidget.rendered||this.BGWidget.loaded||s.push(this.BGWidget),this.fixedWidgets&&this.fixedWidgets.length)for(t=0;t<this.fixedWidgets.length;t++)(i=this.fixedWidgets[t]).rendered||i.loaded||i.canRenderImmediately()||s.push(i);var c,l,d=[],u=99999,h=-99999,p=!1;for(t=0;t<this.widgets.length;t++)(e=this.widgets[t]).rendered||e.loaded||"background"==e.type||e.fixed_position||(c=(l=Z.getScreenIndex(e,r,a,!0)).index,u=Math.min(l.start,u),h=Math.max(l.end,h),e.screenIndex=c,c!==1/0&&(d[c]=d[c]||[],d[c].push(e)),p=!0);if(p){for(d[0]&&o.push(d[0]),d[1]&&o.push(d[1]),d[-1]&&o.push(d[-1]),t=2;t<=h;t++)d[t]&&o.push(d[t]);for(t=-2;t>=u;t--)d[t]&&o.push(d[t])}return s.length&&(o.length?o[0]=s.concat(o[0]):o=[s]),o},loadWidgetsPack:function(t,e){var i,n=0,r=0,a=0;for(i=0;i<t.length;i++){var o=t[i];o.rendered||o.loaded||o.destroyed||(o.canRenderImmediately()||(n++,o.on("loaded destroyed",s,o)),a++,o.render())}function s(){r++,n==r&&e()}a||e(),n==r&&e()},loadForScreenshotMode:function(){o.Z.each(this.widgets,function(){var t=k(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.render();case 2:t.sent.start();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},createWidgetsForCurrentViewport:function(){this.destroyAllWidgets(["video"]),this.BGWidget=null,this.fixedWidgets=[];var t=this.pageViewport,e=[],i=[],n=99999,r=this,a=this;o.Z.each(this.widgetsData,function(e){var r=a.getWidgetViewportData(e,t),o=!this.mag.isPreview&&h.Z.hasExpired(r);!b.Widgets[r.type]||r.hidden||o||(!r.fixed_position&&r.z&&"background"!=r.type&&(n=Math.min(n,r.z)),i.push(r))}.bind(this)),99999==n&&(n=0),o.Z.each(i,function(i){var o=u.Z.isOn(t,this.mag.getViewportWidth(t),this.mag.viewOpts)&&u.Z.isCSSTransform();i.fixed_position&&(i.z<n||w.Z.isDesktop&&!this.mag.isStickyVerticalViewer&&!o)?i.$fixedContainer=a.$fixedPositionContainer:i.$fixedContainer=a.$fixedPositionContainerTop;var s=null;this.widgets&&this.widgets.length&&(s=this.widgets.find((function(t){return!!t&&t._id===i._id})));var c=s||new b.Widgets[i.type](i,r);"video"===c.type&&(c.updateWidgetData(i,r),c.applyBoxStyle(),c.updateVideoFrameSize(i.w,i.h)),"background"===c.type&&(a.BGWidget=c,a.hasVideoBG=c.hasVideoBG()),c.isValid()&&(c.fixed_position&&a.fixedWidgets.push(c),e.push(c))}.bind(this)),this.animations=new p.Z({page:this,widgets:e}),this.widgets=o.Z.sortBy(e,"y"),this.signalOnLoading(),this._onFontsLoad=[],this._widgetsWithFontsToLoad=[],this._fontLoaderCalled=0,this._widgetsWithFontsCount=o.Z.reduce(this.widgets,(function(t,e){return t+(e.hasFontsToLoad()?1:0)}),0),this._widgetsWithLoadAnimation=o.Z.reduce(this.widgets,(function(t,e){return t+(e.hasLoadAnimation()?1:0)}),0),this.hasFixedWidgets=!!this.fixedWidgets.length;var s=u.Z.isOn(t,this.mag.getViewportWidth(t),this.mag.viewOpts)&&u.Z.isCSSTransform();this.$el.removeClass("page-with-fixeds-desktop page-with-fixeds-sticky-or-mobile").toggleClass("page-with-fixeds-desktop",this.hasFixedWidgets&&w.Z.isDesktop).toggleClass("page-with-fixeds-sticky-or-mobile",!(!this.hasFixedWidgets||!this.isStickyVerticalViewer&&w.Z.isDesktop&&!s)),this.hasFixedWidgets&&!this.retargetScroll&&"horizontal"==this.viewerType&&w.Z.isDesktop&&(this.retargetScroll=y.Z&&(0,y.Z)(this.$fixedPositionContainerTop.get(0),this.$scrollWrapper.get(0)),y.Z&&(0,y.Z)(this.$fixedPositionContainer.get(0),this.$scrollWrapper.get(0))),this.lastViewportUsedForWidgetsCreation=t},getWidgetViewportData:function(t,e){var i=o.Z.clone(t),n={},r=["text_w","text_h","em_w","anchor_link_pos","font-size","font-style","font-weight","font-family","color","color-opacity","letter-spacing","hover-color","hover-color-opacity","current-font-size","current-font-style","current-font-weight","current-font-family","current-color","current-color-opacity","current-letter-spacing","background-color","background-color-opacity","hover-background-color","hover-background-color-opacity","current-background-color","current-background-color-opacity","border-radius","border-width","border-color","border-color-opacity","hover-border-width","hover-border-color","hover-border-color-opacity","current-border-radius","current-border-width","current-border-color","current-border-color-opacity"];return"default"!=e&&t["viewport_"+e]&&(o.Z.each(m.ZP.viewport_fields[t.type]||m.ZP.viewport_fields_common,(function(i){if(("shape"!=t.type||"borders"!=i&&"weight"!=i&&"bg_color"!=i)&&!("background"==t.type&&"picture"==i||"text"===t.type&&3===t.version&&"blocks"===i)){if((0,S._)("constructor.viewportMinimal")||(n[i]=void 0),v.Z.isGlobalKey(i)){var a=v.Z.getGlobalPrefixedKey(i);n[a]=void 0}(0,S._)("constructor.viewportMinimal")||(n[i]="button"===t.type&&!o.Z.has(t["viewport_"+e],i)&&r.includes(i)?t[i]:void 0)}})),o.Z.extend(i,n,o.Z.omit(t["viewport_"+e],["_id","modelType"]))),t.is_global&&v.Z.fillUniqueValues(i,this._id,{}),i},getWidgetById:function(t){return o.Z.findWhere(this.widgets,{_id:t})},getWidgetDataById:function(t){return o.Z.findWhere(this.widgetsData,{_id:t})},signalOnLoading:function(){var t=this.widgets.length,e=this,i={};function n(){t--,clearTimeout(i[this._id]),"background"==this.type&&e.destroyLQBackground({animate:!0}),this.hasLoadAnimation()&&(e._widgetsWithLoadAnimation--,e._widgetsWithLoadAnimation||(e.loadAnimationsReady=!0,e.trigger("loadAnimationsReady"))),t||(e.fireReadyTimeout=setTimeout(r,200)),e.trigger("loaded"+this._id)}function r(){e.loaded=!0,e.trigger("pageLoaded")}o.Z.each(this.widgets,(function(t){RM.screenshot&&(i[t._id]=setTimeout((function(){t.widgetIsLoaded()}),2e4)),t.on("loaded",n,t)}),this),this.BGWidget&&this.hasVideoBG&&this.BGWidget.on("videoBGStarted",(function(){e.videoBGStarted=!0,o.Z.delay((function(){e.trigger("videoBGStarted")}),1300)}),this.BGWidget),0==t&&(this.fireReadyTimeout=setTimeout(r,200))},getFontsVariations:function(t,e){var i=f.Z.getUsedFontsFromWidgetsModels({includeCustom:!0,customList:o.Z.filter(this.mag.edit_params.fonts,{provider:"custom"}),models:t,excludeUnusedDefault:e,activeViewports:[this.getPageViewport()]}),n=[];return o.Z.each(i,(function(t){for(var e=0;e<t.used_variations.length;e++)n.push({fontFamily:t.css_name,fontWeight:100*(t.used_variations[e].substr(1,1)-0),fontStyle:"n"==t.used_variations[e].substr(0,1)?"normal":"italic"})})),n},addFontsToLoad:function(t,e){if(this._widgetsWithFontsToLoad.push(t),this._onFontsLoad.push(e),this._fontLoaderCalled++,this._fontLoaderCalled==this._widgetsWithFontsCount){var i=this.getFontsVariations(this._widgetsWithFontsToLoad);if(o.Z.isEmpty(i))return void this.onAllFontsLoad();this._fontsToLoadLeft=i.length,o.Z.each(i,o.Z.bind((function(t){f.Z.exactWaitForFontLoad(t.fontFamily,t.fontWeight,t.fontStyle,this.onOneFontLoad)}),this))}},onOneFontLoad:function(t,e,i,n){this._fontsToLoadLeft--,0==this._fontsToLoadLeft&&o.Z.delay(this.onAllFontsLoad,500)},onAllFontsLoad:function(){o.Z.each(this._onFontsLoad,(function(t){t&&t()}))},updateViewport:function(){var t=this.getPageViewport();t!==this.pageViewport&&(this.pageViewport=t,this.createLQBackground(),this.shown&&(this.loadAnimationsReady=!1,this.createWidgetsForCurrentViewport(),this.started&&(this.started=!1,this.start())))},waitForAnimationEnd:function(t){this.resetWaitHook=l.default.waitForTransitionEnd(this.$el,this.mag.getPageTransitionTime()+1e3,"transform",t)},resetWaitForAnimationEnd:function(){this.resetWaitHook&&this.resetWaitHook()},backToTop:function(){this.scrollTo(0)},scrollTo:function(t){this.$scrollWrapper.finish(),this.$scrollWrapper&&this.$scrollWrapper.animate({scrollTop:t},500)},focusPage:function(){w.Z.isDesktop&&"vertical"!==this.viewerType&&0===this.$el[0].getBoundingClientRect().left&&(this.$content.focus(),this.mag.$el.scrollTop(0))},markAsLast:function(){this.lastPage=!0,this.$el.addClass("last")},isLastPage:function(){return!!this.lastPage},isBottomArrowVisible:function(){return!this.wasScrolled&&this.scrollable},isPasswordProtected:function(){return this.unauthorized},scrollPageALittle:function(){this.$scrollWrapper.animate({scrollTop:(0,n.Z)(window).height()/2},500)},getPageViewport:function(){var t=this.mag.viewport,e=this;if("default"===t||RM.screenshot)return"default";if(this["viewport_"+t]&&this["viewport_"+t].enabled)return t;var i=o.Z.findWhere(m.ZP.viewports,{name:t}).width,n=o.Z.reduce(m.ZP.viewports,(function(t,n,r){return("default"==n.name||e["viewport_"+n.name]&&e["viewport_"+n.name].enabled)&&Math.abs(n.width-i)<=Math.abs(m.ZP.viewports[t].width-i)?r:t}),0);return m.ZP.viewports[n].name},onResize:function(t){if(t=t||{},this.shown||"horizontal"!==this.viewerType){var e=this.mag.getContainerSizeCached(),i=this.mag.getViewportWidth(this.pageViewport),n=m.ZP.dictionary[this.pageViewport].width,r=this.mag.getScale(this.pageViewport),a=this["viewport_"+this.pageViewport]&&this["viewport_"+this.pageViewport].height||this.height,o={width:n,height:a,scaledWidth:Math.round(i*r),scaledHeight:Math.round(a*r),scale:r},s=RM.screenshot&&"true"===l.default.queryUrlGetParam("pdf"),c=Math.min(o.scaledWidth,e.width),d=o.scaledHeight,h=s?0:Math.max(((RM.screenshot?672:e.height)-d)/2,0),p=Math.max(((RM.screenshot?1024:e.width)-c)/2,0)+(i-n)/2,f={width:o.width,height:o.height,top:(0,S._)("constructor.enhancedMobileFrame")&&this.pageViewport===m.sJ.PhonePortrait&&"top"===this.mag.viewOpts.phoneVerticalAlign?0:h/(u.Z.isCSSZoom()&&u.Z.isDesktopDefault(this.pageViewport)?r:1),left:p};if(u.Z.isOn(this.pageViewport,i,this.mag.opts)&&u.Z.isCSSZoom()&&(f.zoom=r,f.left=e.width>this.mag.opts.scalewidth?(e.width/r-n)/2:(i-n)/2),this.$content.removeAttr("style"),this.$content.css(f),this.contentPosition={left:p,top:h},1===u.Z.normalize(r,"transform",this.pageViewport,i,this.mag.viewOpts)?l.default.applyTransform(this.$content,""):(l.default.applyTransform(this.$content,"scale("+o.scale+")"),u.Z.isDesktopDefault(this.pageViewport)?this.$content.css({left:Math.max((e.width-c)/2,0)+(i-n)/2*o.scale}):this.$content.css({left:(i-n)/2*o.scale})),this.contentHeight=a,this.pageHeight=this.isPasswordProtected()?e.height:Math.max(e.height,Math.round(a*r)),this.pageBgHeight=e.height,this.pageWidth=i,"vertical"===this.viewerType&&this.isStickyVerticalViewer&&this.$el.css({height:this.pageHeight,top:t.absolutePosition}),this.scale=r,this.$contentBounds.css({width:e.width,height:this.pageHeight}),void 0!==this.prevScale&&this.prevScale!==this.scale&&this.animations){var g,v=null===(g=this.animations.animations)||void 0===g?void 0:g.filter((function(t){return Z.findPlayingVideo(t.widgets)}));this.animations.updateTimelines(v.map((function(t){return t.animation.UUID}))),this.animations.resetStarted(),this.animations.start.__debounced()}return this.animations&&this.animations.onResize(),this.trigger("resize",{containerSize:e,contentPosition:this.contentPosition}),this.scrollable=Math.round(a*r)-this.mag.SCROLLABLE_TRESHOLD>e.height,this.mag.recalcBottomArrowState(this),this.visibleWidgetsCoords=this.visibleWidgetsCoords||{},this.visibleWidgetsCoords.top=-h,this.visibleWidgetsCoords.bottom=-h+e.height,this.visibleWidgetsCoords.scale=r,this.resizeLQBackground(),this.prevScale=this.scale,this.pageHeight}},onScroll:function(){this.wasScrolled=!0,this.mag.recalcBottomArrowState(this),this.visibleWidgetsCoords=this.visibleWidgetsCoords||{},this.visibleWidgetsCoords.scrollTop=this.$scrollWrapper.scrollTop(),this.mag.onCurrentPageScroll(this,this.visibleWidgetsCoords.scrollTop),this.animations&&this.animations.onScroll(),this.trigger("page scroll",this.visibleWidgetsCoords.scrollTop)},isCurrent:function(){return this.num===this.mag.currentPage.num},showPagePasswordForm:(T=k(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.e(44).then(i.bind(i,1145));case 2:e=t.sent,r=e.default,this.pagePasswordView=new r({router:this.router,mag:this.mag,page:this,$parent:(0,n.Z)("#page-".concat(this.num,"-password-container"))}),this.pagePasswordView.render();case 6:case"end":return t.stop()}}),t,this)}))),function(){return T.apply(this,arguments)}),createLQBackground:function(){if(!RM.screenshot&&!this.isPasswordProtected()){var t=this.getWidgetViewportData(o.Z.findWhere(this.widgetsData,{type:"background"}),this.pageViewport);if(this.LQBG){if("picture"===t.selectedType&&"picture"===this.LQBG.selectedType&&t.picture&&this.LQBG.picture&&t.picture.poorUrl===this.LQBG.picture.poorUrl||"video"===t.selectedType&&"video"===this.LQBG.selectedType&&t.video&&this.LQBG.video&&t.video.thumbnail_url===this.LQBG.video.thumbnail_url)return void this.resizeLQBackground();this.destroyLQBackground({animate:!1})}if(this.$fixedBgContainer.css("background-color","#"+t.color),t.picture&&"picture"===t.selectedType&&(t.picture.poorUrl||d.Z.useLambdaUrl(t.picture))||t.video&&"video"===t.selectedType&&t.video.thumbnail_url){this.LQBG=o.Z.extend({},t);var e=_["template-viewer-widget-background"];if(this.LQBG.$el=(0,n.Z)(e({data:t})),this.LQBG.$el.addClass("low-quality").appendTo(this.$fixedBgContainer),"picture"===this.LQBG.selectedType){var i=this.LQBG.picture.poorUrl;d.Z.useLqipUrl(t.picture)&&(i=d.Z.getLqipUrl(this.LQBG.picture),this.LQBG.$el.addClass("lqip").appendTo(this.$fixedBgContainer)),(0,n.Z)("<img/>").on("load",o.Z.bind((function(){this.LQBG&&this.LQBG.$el.find(".picture-background").css({"background-image":"url(".concat(i,")")})}),this)).attr("src",i)}if("video"===this.LQBG.selectedType){var r=this.LQBG.video.thumbnail_url.replace("http://","https://"),a=(0,n.Z)("<img/>").addClass("poster").css("opacity",0).appendTo(this.LQBG.$el.find(".video-background .video-container"));a.on("load",o.Z.bind((function(){a.css({width:"",height:""}).css("opacity",1);var t=a[0].width,e=a[0].height;this.LQBG&&!this.LQBG.video.aspect_poster&&(this.LQBG.video.aspect_poster=t/e),this.resizeLQBackground()}),this)).attr("src",r)}}}},resizeLQBackground:function(){RM.screenshot||this.isPasswordProtected()||!this.LQBG||"video"===this.LQBG.selectedType&&g.Z.setVideoPosition({mag:this.mag,$container:this.LQBG.$el.find(".video-background .video-container"),$media:this.LQBG.$el.find(".video-background .video-container .poster"),provider:this.LQBG.video.provider_name,aspect_poster:this.LQBG.video.aspect_poster,aspect_real:this.LQBG.video.aspect_real,controls_remove:!0})},destroyLQBackground:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!RM.screenshot&&!this.isPasswordProtected()&&this.LQBG){t.animate=t.animate&&"picture"===this.LQBG.selectedType&&this.started;var e=this.LQBG.$el;this.LQBG=null,t.animate?(e.css("opacity",0),setTimeout((function(){e.remove()}),400)):e.remove()}},fixSafariScroll:function(t){Modernizr.safari&&w.Z.isDesktop&&(0!==this.$scrollWrapper.scrollTop()&&this.$scrollWrapper.scrollTop(0))}},{getScreenIndex:function(t,e,i,n){var r,a=Math.floor((t.y-e)/i),o=Math.ceil((t.y+t.h-e)/i)-1;return n&&t.canRenderImmediately()?r=1/0:t.hasLoadAnimation()||a<=0&&o>=0?r=0:a>0?r=a:o<0&&(r=o),{start:a,end:o!==1/0?o:0,index:r}},findPlayingVideo:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.find((function(t){return"video"===t.type&&t.isPlaying}))}});e.Z=Z},1062:function(t,e,i){"use strict";i.r(e);var n=i(312),r=i(336),a=i.n(r),o=i(321),s=i(867),c=i(1063),l=i(340),d=i(308),u=i(976),h=i(351),p=i(636),f=i(323),g=i(1068);function m(t,e,i,n,r,a,o){try{var s=t[a](o),c=s.value}catch(t){return void i(t)}s.done?e(c):Promise.resolve(c).then(n,r)}function v(t){return function(){var e=this,i=arguments;return new Promise((function(n,r){var a=t.apply(e,i);function o(t){m(a,n,r,o,s,"next",t)}function s(t){m(a,n,r,o,s,"throw",t)}o(void 0)}))}}var y,b,w,S,P,k=a().Router.extend({routes:{":user/:mag/num/:pageNum/":"startByPageNum",":user(/)(:mag)(/)(*pageUri)(/)":"start"},mags:{},initialize:function(){var t=this;if(window.RM.timing[d.qK.DomLoaded]=window.performance.timing.domLoading,window.RM.timing[d.qK.ScriptsLoaded]=window.performance.timing.domContentLoadedEventEnd,window.RM.timing[d.qK.RouterInit]=Date.now(),Modernizr.addTest("chrome",(function(){return o.Z.isObject(window.navigator)&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),RM.common.isDomainViewer&&(RM.common.customDomainProfile?this.route(":mag(/)(*pageUri)(/)","start"):this.route("(*pageUri)(/)","start")),RM.common.isDownloadedSource&&(this.route("(*pageUri)(/)","start"),/msie [6-9]/i.test(navigator.userAgent)&&(location.href="sorry.html")),(0,n.Z)("html").toggleClass("viewer-embed-mode",!!RM.common.embedMode),o.Z.bindAll(this),this.environment=d.ZP.environment.viewer,this.started=!1,!RM.common.isDownloadedSource&&window.RM.data.usersLoader.me&&(this.me=window.RM.data.usersLoader.me),this.$mags_container=(0,n.Z)("#mags"),this.magsData=window.ServerData&&window.ServerData.mags,this.userPermissions=window.ServerData&&window.ServerData.userPermissions,this.internalHistory=[],this.magsData){if(this.cachedMag=o.Z.clone(this.magsData.mag),!this.cachedMag||!this.cachedMag.user||!this.cachedMag.user._id)return;RM.common.isDownloadedSource||(this.cachedMag.user.isMe=this.me&&this.me.get("_id")==this.cachedMag.user._id),RM.common.isDomainViewer&&(this.magUri=this.cachedMag.uri,this.userUri=this.cachedMag.user&&this.cachedMag.user.uri)}RM.screenshot||i.e(19).then(i.bind(i,725)).then((function(e){var n,r,a=e.default;RM.analytics=RM.analytics||new a({router:t}),t.analytics=RM.analytics,RM.common.isDomainViewer||l.default.processCustomTrackingEventCookies();var o=d.ZP.stripe_live,s=!0===(null===(n=window.RM)||void 0===n||null===(r=n.common)||void 0===r?void 0:r.isDomainViewer);o&&!s&&i.e(42).then(i.bind(i,1142)).then((function(t){(0,t.getWebVitals)()}))})),this.isPreview||Modernizr.sessionstorage&&window.sessionStorage.removeItem("constructorViewport")},startByPageNum:function(t,e,i){this.start(t,e,null,i)},getPageUrlFromCodeExportLink:function(t){var e;if(!t)return t;if(null!==(e=window.RM.config)&&void 0!==e&&e.root){var i=window.RM.config.root;return"/"===i[0]&&(i=i.substr(1)),t.replace(i,"")}return t},start:function(t,e,r,s){var l=this;if(RM.common.isDomainViewer&&(this.magsData.magNotFound||this.magsData.domainNotFound||this.magsData.magNotPublished||this.magsData.subscriptionExpired))i.e(40).then(i.bind(i,1061)).then((function(t){new(0,t.default)({type:"domain-error",$container:(0,n.Z)("#service-pages"),templateData:{state:l.magsData}}).render()}));else if(isNaN(parseInt(s))&&(s=void 0),Modernizr.msie||Modernizr.msie11)i.e(17).then(i.bind(i,723)).then((function(t){new(0,t.default)({$parent:(0,n.Z)("body > .popups"),router:l,opts:{type:"type-browsers-viewer"}}).render()}));else{if(!s)if(RM.common.isDomainViewer&&!RM.common.customDomainProfile)parseInt(t,10)!=t&&t&&/^p\d+\/?$/i.test(t)?(r=null,e=t,t=null):(r=t,t=this.userUri,e=this.magUri),RM.common.isDownloadedSource&&(r=this.getPageUrlFromCodeExportLink(r));else if(RM.common.isDownloadedSource)r=this.getPageUrlFromCodeExportLink(t),t=null,e=null;else if(parseInt(t,10)==t||/^p\d+\/?$/i.test(t)){var d=e;e=t,r=d,t=null}else if(RM.common.customDomainProfile){d=e;e=t,r=d,t=this.userUri}else if(!e)return this.notFound();this.latestFragment=a().history.getFragment(),r=r||1,s&&(r=s);var u=t+"_"+e;if(this.username=t,this.started!=u||this.loaded==u)if(this.started=u,this.loaded!=this.started){if(this.cachedMag&&!o.Z.isEmpty(this.cachedMag))return this.cachedMag instanceof c.Z||this.cachedMag.forbidden||this.cachedMag.is_suspended||(this.cachedMag=new c.Z(this.cachedMag,this)),this.mag=this.cachedMag,void this.onPreloadMag(r,!!s);this._loadingMagDataXHR&&this._loadingMagDataXHR.abort(),this._loadingMagDataXHR=this.fetchData(this.username,e,{success:o.Z.bind((function(t){this.mag&&this.mag.num_id&&t&&t.num_id!=this.mag.num_id&&window.location.reload(),this.mag=new c.Z(t,this),this.cachedMag=this.mag,this.onPreloadMag(r,!!s)}),this),error:this.notFound})}else this.go(r,{animation:!1,isPageNum:!!s})}},restartMag:(P=v(regeneratorRuntime.mark((function t(e){var i,n,r,a,s,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.currentPage,n=e.refetchOnlyPrivate,a=(r=void 0!==n&&n)?this.mag.pages.filter((function(t){return t.isPasswordProtected()})).map((function(t){return t.num_id})):void 0,t.next=4,this.fetchMagPages(a);case 4:(s=t.sent)&&(l=o.Z.clone(this.mag.aboveGlobalWidgetsData),this.mag.destroy(),this.mag=o.Z.clone(this.magsData.mag),this.mag.pages=r?this.mag.pages.map((function(t){var e=s.findIndex((function(e){return t._id===e._id}));return e<0?t:s[e]})):s,this.mag=new c.Z(this.mag,this),this.mag.aboveGlobalWidgetsData=(l||[]).concat(this.mag.aboveGlobalWidgetsData),this.cachedMag=this.mag),this.onPreloadMag(i,!0);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return P.apply(this,arguments)}),fetchMagPages:(S=v(regeneratorRuntime.mark((function t(e){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=Array.isArray(e)&&e.length?e.join(","):void 0,this._loadingPagesDataXHR&&this._loadingPagesDataXHR.abort(),this._loadingPagesDataXHR=n.Z.ajax({url:"/api/magpages/".concat(this.mag.num_id),method:"GET",data:i?{pages:i}:void 0,success:function(t){return t},error:function(t){return null},context:this}),t.abrupt("return",this._loadingPagesDataXHR);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return S.apply(this,arguments)}),onPreloadMag:function(t,e){var i=this;(0,g.preloadWidgets)(l.default.usedWidgets(this.mag.pages||[],this.mag.aboveGlobalWidgetsData)).finally((function(){i.onLoadMag(t,e)}))},onLoadMag:function(t,e){var i,r=this;if(window.RM.timing[d.qK.MagLoaded]=Date.now(),this.loaded=this.started||!0,this.mag.forbidden)return this.requestMagPassword(this.latestFragment,o.Z.clone(this.mag)),delete this.cachedMag,delete this.loaded,void delete this.started;if(this.mag.is_suspended)this.showSuspended();else{var a=new Event(d.q7.ProjectInitialized,{bubbles:!0});document.dispatchEvent(a),!this.isPreview&&(h.Z.hasNewTextWidgets(window.ServerData&&window.ServerData.mags&&window.ServerData.mags.mag)||h.Z.hasNewTextWidgets(this.mag&&this.mag.model&&this.mag.model.attributes)||h.Z.someTextWidgets(this.mag.aboveGlobalWidgetsData))&&(0,u.IB)("viewer"),RM.common.isDownloadedSource||(n.Z.post("/api/countview/"+this.mag.num_id),RM.analytics&&(RM.analytics._triggerProjectView=!0)),this.mag._requested_page&&!e?(i=this.mag._requested_page,delete this.mag._requested_page):i=t,Modernizr.addTest("screenshot-mode",(function(){return RM.screenshot})),this.mag.render(),this.go(i,{animation:!1,isPageNum:e});var s=new Event(d.q7.ProjectRendered,{bubbles:!0});if(document.dispatchEvent(s),RM.common.mode="mag",!this.isPreview){window.RM.timing[d.qK.MagRendered]=Date.now();var c=RM.viewerRouter.mag.currentPage.num;setTimeout((function(){window.RM.timing[d.qK.DomComplete]=window.performance.timing.domComplete;var t={};Object.keys(window.RM.timing).forEach((function(e){t[e]=RM.timing[e]-window.performance.timing.navigationStart}));var e=window.innerWidth,i=!f.Z.isDesktop||Modernizr.ismobile?Modernizr.isipad||e>=600?"tablet":"phone":"desktop";(0,p.bF)("frontend-rendering",{mag_num_id:r.mag.num_id,viewport:r.mag.viewport,start_page:c,widgets_count:o.Z.reduce(RM.viewerRouter.mag.pages,(function(t,e){return t+(e.widgets?e.widgets.length:0)}),0)+r.mag.aboveGlobalWidgets.length,device:i,timing:t})}),1e4)}}},getAnalyticsDimensions:function(){return{magId:this.mag&&this.mag.model&&this.mag.model.get("num_id")||this.mag&&this.mag.num_id,magCreatorId:this.mag&&this.mag.model&&this.mag.model.user.get("_id")||this.mag&&this.mag.user._id,pageType:"viewer",userId:this.me&&this.me.get("_id")}},fetchData:function(t,e,i){return(i=i||{}).url=t?"/api/readymag/"+t+"/"+e:"/api/readymag/"+e,n.Z.ajax(i)},sendReadyEvent:function(t){t=t||{},t=o.Z.defaults(t,{page:{}});var e=document.createElement("MyExtensionDataElement");e.setAttribute("width",t.page.width),e.setAttribute("height",t.page.height),e.setAttribute("_id",t.page._id),document.documentElement.appendChild(e);var i=document.createEvent("Events");if(t&&t.error?i.initEvent("MyErrorEvent",!0,!1):i.initEvent("MyExtensionEvent",!0,!1),e.dispatchEvent(i),window.loadNotifier){if(t.error)return window.loadNotifier({error:t.error});window.loadNotifier({width:t.page.width,height:t.page.height})}},setTitle:function(){if(this.mag&&this.mag.currentPage){var t=o.Z.extend({},this.mag.model.toJSON());t.user=this.mag.user,document.title=s.getFinalSEO(this.mag.currentPage,t,{customDomain:!!RM.common.isDomainViewer}).title}},trackPage:function(){RM.screenshot||o.Z.defer(o.Z.bind((function(){this.analytics&&this.analytics.trackPage()}),this))},go:function(t,e){if(t=t||1,e.isPageNum)return this.mag.showPage(t,e);var i=this.mag.getPageByPath(t)||{};this.mag.showPage(i.num||t,e)},goBack:function(){var t=this.internalHistory[this.internalHistory.length-2];t&&(t&&this.go(t,{skipInternalHistory:!0}),this.internalHistory.pop())},setUrlString:function(t){if(!this.noUrlRewrite&&(t=t||{},!RM.screenshot)){var e,i=this.mag.currentPage;if(e=RM.common.isDomainViewer&&!RM.common.customDomainProfile||RM.common.isDownloadedSource?"":RM.common.customDomainProfile?this.getMagUri(this.mag):this.username?this.mag.user.uri+"/"+(this.mag.uri||this.mag.num_id)+"/":this.isPreview?this.mag.num_id+"/":this.getMagUri(this.mag),this.isPreview&&(e+="preview/"),i&&"1"!=i.num&&(e+=(i.pagePath||i.uri||i.num.toString())+"/"),t.skipInternalHistory?RM.analytics&&RM.analytics.sendEvent("Back Link",e):this.internalHistory.push(i.num.toString()),e!==a().history.getFragment()){var n=(parseInt(o.Z.last(a().history.getFragment(),"/"))||1)==i.num||t.replace;RM.common.isDownloadedSource&&"/"!==o.Z.last(e)&&(e+="/"),RM.common.homepageRewrite||this.navigate(e,{replace:n})}}},getPreviousFragment:function(){return this.internalHistory[this.internalHistory.length-2]},getMagUri:function(t){return RM.common.customDomainProfile?(t.uri||t.num_id)+"/":RM.common.isDomainViewer?"":o.Z.isEmpty(t.user)?t.num_id+"/":t.user.uri+"/"+(t.uri||t.num_id)+"/"},getUserPermissions:function(){return this.userPermissions||[]},onError:function(){this.mag&&this.go(1,{animation:!1})},createLoginViewForIframe:function(t,e,r){var a=this;i.e(18).then(i.bind(i,1105)).then((function(i){new(0,i.default)({useNavigate:!1,$node:(0,n.Z)(t),router:a,joinCallback:e,errorMessages:r}).render()}))},createMagFromTemplate:(w=v(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.e(18).then(i.bind(i,1107));case 2:new(0,t.sent.default)({router:this,me:this.me,tp:e,templateID:n});case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return w.apply(this,arguments)}),destroy:function(){this.cachedMag&&this.cachedMag.destroy(),this.magPasswordView&&this.magPasswordView.remove(),this.magSuspendedView&&this.magSuspendedView.remove()},requestMagPassword:(b=v(regeneratorRuntime.mark((function t(e,r){var a,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.magPasswordView){t.next=6;break}return t.next=3,i.e(43).then(i.bind(i,1143));case 3:a=t.sent,o=a.default,this.magPasswordView=new o({router:this,$parent:(0,n.Z)("#mags")});case 6:this.magPasswordView.render({mag:r,mag_url:e});case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return b.apply(this,arguments)}),showSuspended:(y=v(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.e(40).then(i.bind(i,1061));case 2:e=t.sent,new(0,e.default)({type:"mag-suspended",$container:(0,n.Z)("#service-pages")}).render();case 6:case"end":return t.stop()}}),t)}))),function(){return y.apply(this,arguments)}),notFound:function(){o.Z.defer(v(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.e(40).then(i.bind(i,1061));case 2:e=t.sent,r=e.default,new r({type:"404",$container:(0,n.Z)("#service-pages")}).render();case 6:case"end":return t.stop()}}),t)}))))}});e.default=k},1080:function(t,e,i){"use strict";var n=i(312),r=i(336),a=i.n(r),o=i(321),s=i(1081),c=i(867),l=i(308),d=i(323),u=i(347),h=a().View.extend({template:s.Z["template-viewer-share"],events:{"click .buttons-wrapper .button":"share","click .send-report":"share","click .open-embed":"openEmbed","click .close":"hide","click .embed-wrapper .back":"closeEmbed","click .embed-wrapper .embed-code":"selectEmbedCode","keyup .embed-wrapper .embed-code":"onKeyUp","click .type-selector":"onTypeSelectorClick","click .size-selector":"onSizeSelectorClick",click:"onClick"},initialize:function(t){return o.Z.bindAll(this),o.Z.extend(this,t),this},render:function(){return this.setElement(this.template({hasOverlay:d.Z.isPhone,common:RM.common,icons:{sprite:(0,u.findImagePath)("./viewer/share/sprite".concat(u.is2X?"@2x":"",".png")),thumbArrows:(0,u.findImagePath)("./viewer/share/thumb-arrows".concat(u.is2X?"@2x":"",".png")),thumbOpen:(0,u.findImagePath)("./viewer/share/thumb-open".concat(u.is2X?"@2x":"",".png"))}})),this.$el.appendTo(this.$container),this.selectFullMode(),d.Z.isPhone&&(this.shareSwipe=this.$el.RMSwipe({minTransitionSpeed:200,maxTransitionSpeed:400,rubberBand:!1,beforeAutoAnimation:o.Z.bind((function(t,e){return{autoAnimate:!0,immediateCallback:!0}}),this),getCurrentConstraints:o.Z.bind((function(t){var e={},i=this.$el.filter(".share-popup");return e.$referenceItem=i,e.$moveItems=i,e.up={max:0,noTrigger:!0},e.down={max:i.height()},e}),this),callback:o.Z.bind((function(t){this.hide()}),this)}).data("swipe")),this.listenTo(this.mag,"pageChanged",this.onPageChange),this.listenTo(this.mag,"keypress-"+n.Z.keycodes.esc,this.hide),(0,n.Z)("body").on("click",this.hideOnBodyClick),this},show:function(){return this.shown||(clearTimeout(this.hideTimeout),this.$el.removeClass("hidden"),this.$el.height(),this.$el.addClass("show-popup"),this.$container.addClass("no-hover"),this.shown=!0,this.updateEmbed()),this},toggle:function(){return this.shown?this.hide():this.show()},hide:function(){return this.shown&&(this.$el.removeClass("show-popup"),this.$container.removeClass("no-hover"),this.hideTimeout=setTimeout(o.Z.bind((function(){this.closeEmbed(),this.$el.addClass("hidden")}),this),400),this.shown=!1),this},destroy:function(){return clearTimeout(this.hideTimeout),(0,n.Z)("body").off("click",this.hideOnBodyClick),this.shareSwipe&&this.shareSwipe.destroy(),this.remove()},hideOnBodyClick:function(t){d.Z.isPhone||(0,n.Z)(t.target).closest(this.$container).length||this.hide()},onPageChange:function(t,e){this.hide()},onClick:function(t){d.Z.isPhone&&(0,n.Z)(t.currentTarget).hasClass("share-popup-overlay")&&this.hide()},onKeyUp:function(t){t.stopPropagation()},openEmbed:function(t){this.router.analytics&&this.router.analytics.sendEvent("Embed","contents ("+this.shareMode+")"),this.selectEmbedCode(),this.$el.addClass("show-embed")},updateEmbed:function(){var t,e=this.mag.currentPage||this.mag.pages[0],i=this.$(".size-selector").attr("data-selected");e&&e.unauthorized||(this.$(".embed-wrapper .embed-code").val(h.getEmbedCode({shareMode:this.shareMode,cur_page_num_id:e.num_id,mag_num_id:this.mag.num_id,size:{responsive:"responsive",big:512,small:288}[i]})),t=this.mag.model.getPageScreenshot(256,{_id:"page"===this.shareMode?e._id:this.mag.coverPid}),this.currentEmbedSrc!==t&&(this.$(".thumb-pic").attr("src",t),this.currentEmbedSrc=t))},closeEmbed:function(){this.$el.removeClass("show-embed")},share:function(t){c.share({host:(RM.common.embedDomainName||window.location.protocol+"//"+window.location.hostname)+"/",tp:(0,n.Z)(t.currentTarget).attr("data-tp"),source:"share panel",page:this.mag.currentPage||this.mag.pages[0],mag:o.Z.extend(this.mag.model.toJSON(),{user:this.mag.user}),forProject:"full"===this.shareMode,customDomain:!(!RM.common.isDomainViewer&&!RM.common.embedDomainName),customDomainProfile:!(!RM.common.customDomainProfile&&"User"!==RM.common.embedDomainType),analytics:this.router.analytics,exportBasePath:window.RM.common.isDownloadedSource?window.RM.config&&window.RM.config.root:void 0})},onTypeSelectorClick:function(t){if(d.Z.isPhone){var e=(0,n.Z)(t.target);e.closest(".type-full").length&&this.selectFullMode(),e.closest(".type-page").length&&this.selectPageMode()}else{"page"===(this.$(".type-selector").attr("data-tp")||"page")?this.selectFullMode():this.selectPageMode()}},onSizeSelectorClick:function(t){var e,i,r=(0,n.Z)(t.currentTarget),a=r.attr("data-selected");i=(i=(e=o.Z.map(r.find(".size"),(function(t){return(0,n.Z)(t).attr("data-size")}))).indexOf(a)+1)>=e.length?0:i,r.attr("data-selected",e[i]),this.updateEmbed()},selectPageMode:function(){this.$(".type-selector").attr("data-tp","page"),this.shareMode="page",this.updateEmbed()},selectFullMode:function(){this.$(".type-selector").attr("data-tp","full"),this.shareMode="full",this.updateEmbed()},selectEmbedCode:function(){d.Z.isDesktop&&this.$(".embed-wrapper .embed-code").get(0).setSelectionRange(0,9999)}},{getEmbedCode:function(t){var e,i,n,r,a='<script async src="'+l.ZP.EMBED_SCRIPT_INIT+'" id="readymag-embed-init"><\/script>';return e=RM.common.embedDomainName||window.location.protocol+"//"+window.location.hostname,r=' data-uri="'+(i="full"===t.shareMode?t.mag_num_id:"p"+t.cur_page_num_id)+'" ',r+=' data-width="'+t.size+'" ',(RM.common.isDomainViewer||RM.common.embedDomainName)&&(r+=' data-domain="'+e+'" ',RM.common.customDomainProfile||"User"===RM.common.embedDomainType||(i="full"===t.shareMode?"":"p"+t.cur_page_num_id)),l.ZP.IS_LIVE||(r+=' data-origin="'+l.ZP.readymag_embed_host+'" '),'<a class="rm-mag-embed" href="'+(n=e+"/"+i)+'"'+r+' target="_blank">'+n+"</a>\n"+a}});e.Z=h},1078:function(t,e,i){"use strict";var n=i(312),r=i(336),a=i.n(r),o=i(321),s=i(1079),c=i(1080),l=i(1082),d=i(323),u=i(347),h=a().View.extend({PAGE_COUNTER_TIMEOUT:2800,PAGE_COUNTER_TIMEOUT_INITIAL:4e3,brandingInToolbar:!1,template:s.Z["template-viewer-toolbar"],events:{"click .menu-button":"toggleMenu","click .share-button":"toggleShare","click .embed-close-button":"onEmbedCloseClick"},initialize:function(t){return o.Z.bindAll(this),o.Z.extend(this,t),this},render:function(){if(this.setElement(this.template({mag:this.mag,isPreview:this.isPreview,hasMenu:this.hasMenu,hasShare:this.hasShare,hasPageCounter:this.hasPageCounter,pageCounterInsideMenu:this.hasMenu&&d.Z.isPhone,totalPages:this.mag.getPagesCount(),common:RM.common,controlsOnTop:this.controlsOnTop,brandingInToolbar:this.brandingInToolbar,icons:{sprite:(0,u.findImagePath)("./common/toolbar/sprite".concat(u.is2X?"@2x":"",".png"))}})),this.$el.appendTo(this.$container),this.$menuButton=this.$el.find(".menu-button"),this.$shareButton=this.$el.find(".share-button"),this.$pageCounter=this.$el.find(".page-counter"),this.$pageCounterWrapper=this.$pageCounter.parent(),this.hasShare&&(this.share=new c.Z({mag:this.mag,router:this.router,$container:d.Z.isPhone?this.$container:this.$shareButton}).render(),this.hasMenu||this.$shareButton.addClass("without-menu-button")),this.hasMenu&&(this.magMenu=new l.Z({mag:this.mag,pages:this.pages,router:this.router,isPreview:this.isPreview,hasProjectInfo:this.hasProjectInfo,publishDate:this.publishDate,$container:this.$container,$toolbar:this.$el,viewerType:this.viewerType,showInitially:this.isSettingsOpened}).render()),this.listenTo(this.mag,"pageChanged",this.onPageChange),this.listenTo(this.mag,"menuShown",this.onMenuShow),this.listenTo(this.mag,"menuHidden",this.onMenuHide),this.listenTo(this.mag,"presentationModeOn",this.onPresentationModeOn),this.listenTo(this.mag,"presentationModeOff",this.onPresentationModeOff),!this.isPreview){var t=this.$(".offscreen-initially:visible"),e=150*t.length+800;t.each((function(t,i){setTimeout((function(){(0,n.Z)(i).removeClass("offscreen-initially")}),e),e-=150}))}return this.$("div[data-alt]:not(.rmalttext), a[data-alt]:not(.rmalttext)").RMAltText(),this},destroy:function(){return this.share&&this.share.destroy(),this.magMenu&&this.magMenu.destroy(),this.remove()},isMenuOpened:function(){return!!this.menuShown},closeMenu:function(){this.magMenu&&this.magMenu.hide()},onPageChange:function(t,e){this.showPageCounter(t,e),this.$menuButton.removeClass("waiting-video-bg-start preloading"),this.prevPage&&this.stopListening(this.prevPage),t&&(t.loaded||(this.$menuButton.addClass("preloading"),this.listenTo(t,"pageLoaded",this.onPageLoaded)),t.hasVideoBG&&!t.videoBGStarted&&(this.$menuButton.addClass("waiting-video-bg-start"),this.listenTo(t,"videoBGStarted",this.onVideoBGStarted)),this.prevPage=t)},onPageLoaded:function(){this.$menuButton.removeClass("preloading")},onVideoBGStarted:function(){this.$menuButton.removeClass("waiting-video-bg-start")},onPresentationModeOn:function(){this.isPresentationMode=!0,this.updateVisibilityState()},onPresentationModeOff:function(){this.isPresentationMode=!1,this.updateVisibilityState()},updateVisibilityState:function(){this.isPresentationMode?this.$el.stop().fadeOut(200):this.$el.stop().fadeIn(200)},onMenuShow:function(){this.menuShown=!0,this.hidePageCounter()},onMenuHide:function(){this.menuShown=!1},getPageCounterSize:function(t){if(!this.cachedPageCounterData){this.$pageCounter.find(".cur").text("0");var e=this.$pageCounter.outerWidth();this.$pageCounter.find(".cur").text("00");var i=this.$pageCounter.outerWidth()-e,n=e-i;this.cachedPageCounterData={baseSize:n,digitSize:i},this.$pageCounter.find(".cur").text(t)}var r=this.cachedPageCounterData;return r.baseSize+(t+"").length*r.digitSize},updatePageCounterSize:function(t){this.$pageCounter.length&&this.$pageCounterWrapper.length&&(!this.menuShown&&this.pageCounterShown?this.$pageCounterWrapper.css("width",this.getPageCounterSize(t)):this.$pageCounterWrapper.css("width",""))},showPageCounter:function(t,e){this.hasPageCounter&&(this.$pageCounter.find(".cur").text(t.num),e.showPageCounter&&(clearTimeout(this.pageCounterTimeout),this.$el.addClass("show-page-counter"),this.pageCounterShown=!0,Modernizr.android?setTimeout(o.Z.bind((function(){this.updatePageCounterSize(t.num)}),this),17):this.updatePageCounterSize(t.num),this.pageCounterTimeout=setTimeout(this.hidePageCounter,e.initial?this.PAGE_COUNTER_TIMEOUT_INITIAL:this.PAGE_COUNTER_TIMEOUT)))},hidePageCounter:function(){this.hasPageCounter&&(clearTimeout(this.pageCounterTimeout),this.$el.removeClass("show-page-counter"),this.pageCounterShown=!1,this.updatePageCounterSize())},toggleMenu:function(t){this.magMenu&&this.magMenu.toggle()},toggleShare:function(t){(0,n.Z)(t.target).is(this.$shareButton)&&this.share&&this.share.toggle()},postMessageToParent:function(t,e){var i={type:t,data:e},n=window.parent;n&&n.postMessage(JSON.stringify(i),"*")},onEmbedCloseClick:function(t){this.postMessageToParent("close-fullscreen")}});e.Z=h},1012:function(t,e,i){"use strict";i.d(e,{Z:function(){return S}});var n,r=i(312),a=i(336),o=i.n(a),s=i(321),c=i(349);var l,d,u,h,p,f=(l={},d="template-viewer-widget",u=(0,c.f)(n||(h=['\n\t<div class="rmwidget" data-id="<%-id%>"></div>\n'],p||(p=h.slice(0)),n=Object.freeze(Object.defineProperties(h,{raw:{value:Object.freeze(p)}})))),d in l?Object.defineProperty(l,d,{value:u,enumerable:!0,configurable:!0,writable:!0}):l[d]=u,l),g=i(348),m=i(710),v=i(736),y=i(741),b=i(340),w=1,S=o().View.extend({template:f["template-viewer-widget"],initialize:function(t,e,i){return s.Z.bindAll(this),this.updateWidgetData(t,e,i),"default"!==e.getPageViewport()&&"bottom"!==this.sticked&&(this.sticked=void 0),this.destroyed=!1,this.$document=(0,r.Z)(document),this._id=this._id||w++,this},render:function(){return this.makeBox("some-widget-class"),this.rendered=!0,this.checkLink(),this},redraw:function(){return this.checkLink(),this},updatePage:function(t){var e=this.page;(!e||t&&e.num!==t.num)&&(this.page=t,this.redraw())},canRenderImmediately:function(){return Boolean(this.DO_NOT_WAIT_FOR_PRELOAD)},widgetIsLoaded:function(){this.loaded||this.destroyed||(this.loaded=!0,this.started&&this.start(),this.trigger("loaded"))},isValid:function(){return!0},hasFontsToLoad:function(){return!1},seamlessFontsShow:function(t,e){this._id;if(g.Z.isFastFontLoadCheckAvailable()&&!RM.screenshot&&!this.insideHotspot&&this.hasFontsToLoad()){e();this.makeSureFontsLoaded().then((function(e){window.requestAnimationFrame(t)})).catch((function(e){t()}))}},makeSureFontsLoaded:function(){var t=this.page.getFontsVariations([this],!0),e=[];return s.Z.each(t,(function(t){var i=g.Z.fastWaitForFontLoad(t.fontFamily,t.fontWeight,t.fontStyle);e.push(i)})),window.Promise.all(e)},hasAnimation:function(){return Boolean(this.getAnimations().find((function(t){return!v.Z.isEmpty(t)})))},hasLoadAnimation:function(){return Boolean(this.getAnimations().find((function(t){return"load"===t.type})))},start:function(){return this.started=!0,this},stop:function(){return this.started=!1,this},hide:function(){return this.stop(),this.$el.hide(),this.wasHidden=!0,this.trigger("hidden"),this},show:function(){return this.$el.show(),this.start(),this.wasHidden=!1,this.trigger("shown"),this},destroy:function(){return this.stop(),this.destroyed=!0,this.trigger("destroyed"),delete this.animationObj,this.$el.off(),this.remove()},BringToTopZ:function(){if(this.animationObj){var t=this.animationObj.getAnimationContainer();this.animationObj.resetTimeout&&clearTimeout(this.animationObj.resetTimeout),this.animationObj.savedAnimationContainerZIndex||(this.animationObj.savedAnimationContainerZIndex=t.css("z-index")),t.css("z-index",99999+this.z)}this.$el.css("z-index",99999+this.z)},BackToNormalZ:function(){var t=function(){this.animationObj&&this.animationObj.savedAnimationContainerZIndex&&(this.animationObj.getAnimationContainer().css("z-index",this.animationObj.savedAnimationContainerZIndex||this.z),delete this.animationObj.savedAnimationContainerZIndex);delete this.animationObj.resetTimeout}.bind(this);this.animationObj&&this.animationObj.savedAnimationContainerZIndex&&(this.animationObj.resetTimeout&&clearTimeout(this.animationObj.resetTimeout),this.animationObj.resetTimeout=setTimeout(t,200)),this.$el.css("z-index",this.z)},makeBox:function(t){this.setElement(this.template({id:this._id}));var e=this.fixed_position?this.$fixedContainer:this.$pageContainer;this.animationObj&&(e=this.animationObj.getAnimationContainer()),this.$el.appendTo(e).addClass(t).toggleClass("full-width",!!this.is_full_width).toggleClass("full-height",!!this.is_full_height).toggleClass("inside-hotspot",!!this.insideHotspot),this.applyBoxStyle(),(this.is_full_width||this.is_full_height||this.fixed_position||this.sticked)&&this.listenTo(this.page,"resize",this.onPageResize),this.trigger("rendered")},onPageResize:function(){this.applyBoxStyle()},calcBoxStyle:function(t){t=t||{};var e,i={left:this.x,top:this.y,width:this.w,height:this.h,right:"",bottom:"","margin-left":"","margin-top":"","z-index":this.z||1},n=parseInt(this.full_width_margin,10)||0,a=parseInt(this.full_height_margin,10)||0,o=parseInt(this.sticked_margin,10)||0,c=this.ignoreScale?1:this.page.scale,l=this.page.mag.getContainerSizeCached().width,d=l-(0,r.Z)(window).width(),u=this.fixed_position;if(this.angle&&(i.width=Math.round(this.w),i.height=Math.round(this.h),this.angle%90==0&&i.width%2!=i.height%2&&(i.width+=1)),this.is_full_height&&(i.top=-this.page.contentPosition.top+a,u?(i.top=a/c,i.height=(0,r.Z)(window).height()/c-2*a,["nw","w","sw"].indexOf(u)>-1&&(u="nw"),["n","c","s"].indexOf(u)>-1&&(u="n"),["ne","e","se"].indexOf(u)>-1&&(u="ne")):i.height=this.page.pageHeight/c-2*a),this.is_full_width){var h=this.page.mag.getViewportWidth(this.page.pageViewport);if(i.left=-this.page.contentPosition.left+n,i.width=this.page.mag.getContainerSizeCached().width/c-2*n,e=-((i.width-this.page.$content[0].clientWidth)/2).toFixed(3),m.Z.isOn(this.page.pageViewport,h,this.mag.viewOpts)&&this.page.mag.getContainerSizeCached().width>this.mag.viewOpts.scalewidth&&(Modernizr.msie11?(e=-(l-this.page.$content[0].clientWidth)/2-d/2,i.left=e/c):Modernizr.firefox?(i.width=i.width+1,i.left=e-1):i.left=e),u){if(i.left=n,"horizontal"==this.page.viewerType){var p=this.page.$scrollWrapper,f=p.width()-p[0].clientWidth;i.width-=f/c}["nw","n","ne"].indexOf(u)>-1&&(u="nw"),["w","c","e"].indexOf(u)>-1&&(u="w"),["sw","s","se"].indexOf(u)>-1&&(u="sw")}}if(this.sticked){f=0;"horizontal"==this.page.viewerType&&(f=this.page.$scrollWrapper.width()-this.page.$scrollWrapper[0].clientWidth),"left"==this.sticked&&(i.left=-this.page.contentPosition.left/c+o),"right"==this.sticked&&(i.left=this.page.mag.getContainerSizeCached().width/c-o-this.w-this.page.contentPosition.left/c-f/c),"top"==this.sticked&&(i.top=-this.page.contentPosition.top/c+o),"bottom"==this.sticked&&(i.top=this.$pageContainer.height()-o-this.h+this.page.contentPosition.top/c)}if(t.calcBBox){u&&(i.left*=c,i.top*=c,i.width*=c,i.height*=c),i.sinAngle=Math.sin(-(this.angle||0)*Math.PI/180),i.cosAngle=Math.cos(-(this.angle||0)*Math.PI/180);var g=y.Z.calcBoundingBox(i,u);return i.width=g.bb_width,i.height=g.bb_height,i.left=g.bb_left,i.top=g.bb_top,u&&s.Z.extend(i,b.default.getFixedPositionCSS(u,i,1)),{dimensions:i}}if(u){var v=this.page.mag.getViewportWidth(this.page.pageViewport);s.Z.extend(i,b.default.getFixedPositionCSS(u,i,m.Z.normalize(c,"transform",this.page.pageViewport,v,this.mag.viewOpts))),m.Z.isOn(this.page.pageViewport,v,this.mag.viewOpts)&&m.Z.isCSSZoom()&&(i.zoom=c)}var w={rotate:this.angle?this.angle+"deg":"",scaleX:this.flip_h?-1:1,scaleY:this.flip_v?-1:1};if(u){var S=this.page.mag.getViewportWidth(this.page.pageViewport),P=m.Z.normalize(c,"transform",this.page.pageViewport,S,this.mag.viewOpts);w.scaleX*=P,w.scaleY*=P}return Math.abs(w.scaleX-1)<1e-6&&(w.scaleX=""),Math.abs(w.scaleY-1)<1e-6&&(w.scaleY=""),{dimensions:i,transform:w}},applyBoxStyle:function(){var t=this.calcBoxStyle();this.animationObj&&(t=this.animationObj.modifyWidgetPosition(t)),this.$el.css(t.dimensions);var e=s.Z.map(t.transform,(function(t,e){return t?e+"("+t+")":""})).join(" ");b.default.applyTransform(this.$el,r.Z.trim(e))},calcDistsToPageVisibleBounds:function(){var t,e=this.page.mag.getContainerSizeCached(),i=m.Z.isOnForRatio(this.page.pageViewport,this.page.scale,this.mag.viewOpts)&&m.Z.isCSSZoom()?m.Z.getBox(this.$el[0],this.page.scale):this.$el[0].getBoundingClientRect(),n=this.page.mag.isPreview?this.page.mag.$mag_container[0].getBoundingClientRect():{top:0,left:0},r=(i.top+i.height/2-n.top)/this.page.scale,a=(e.height-(i.top+i.height/2-n.top))/this.page.scale,o=(i.left+i.width/2-n.left)/this.page.scale,s=(e.width-(i.left+i.width/2-n.left))/this.page.scale;if(this.fixed_position){var c=this.page.$el[0].getBoundingClientRect(),l=(i.top+i.height/2-c.top)/this.page.scale,d=(c.height-(i.top+i.height/2-c.top))/this.page.scale;t={left:Math.max(0,o),right:Math.max(0,s),top:Math.max(0,Math.min(r,l)),bottom:Math.max(0,Math.min(a,d))}}else{var u=this.page.contentPosition.left/this.page.scale,h=this.page.contentPosition.top/this.page.scale,p=this.x+this.w/2,f=this.y+this.h/2;l=f+h,d=this.page.contentHeight-f+h;t={left:Math.max(0,p+u),right:Math.max(0,this.page.pageWidth-p+u),top:Math.max(0,Math.min(r,l)),bottom:Math.max(0,Math.min(a,d))}}return t},checkLink:function(){var t={};if(this.clickLink){this.clickLink=this.page.mag.matchSameDomainLink(this.clickLink);var e=/^(.*):\/\/[^\s$.?#].[^\s]*$/i.test(this.clickLink)||/^mailto\:/i.test(this.clickLink)||/^tel\:/i.test(this.clickLink),i=/^__rm_goback$/i.test(this.clickLink),n=this.mailchimpMatcher.test(this.clickLink),a=this.anchorRegexp.test(this.clickLink),o=this.shareRegexp.test(this.clickLink),c=this.clickLink,l=this.clickTarget||"_blank",d=e?"external-link":i?"goback-link":"maglink";if(n&&(d="mailchimp-link"),a&&(d="anchor-link"),o&&(d="share-link"),!e){var u=c;/^back\sto\stop$/i.test(c)&&(u=this.page._id);var h=this.page.mag.getPageNum(u);c=h&&this.page.mag.getPageUri?"/"+this.page.mag.getPageUri(u):"javascript:void(0)";h?l="":c="",u==this.page._id&&(d+=" back-to-top",this.is_global&&(d+=" current"))}if(i&&(c="javascript:void(0)"),n){c="javascript:void(0)";var p=this.clickLink.match(this.mailchimpMatcher)[1];t["data-mailchimp"]=p}if(a){c="javascript:void(0)",t["data-anchor-link-pos"]=this.anchor_link_pos;var f=s.Z.findWhere(this.mag.pages,{_id:this.clickPage})||this.page;t["data-page-uri"]=f.uri||f.num}if(o){c="javascript:void(0)";var g=this.clickLink.match(this.shareRegexp);t["data-share-provider"]=g[1],t["data-share-type"]=g[2]}if(0!=c.indexOf("mailto")&&0!=c.indexOf("tel")&&"maglink"!=d||(l=""),c){s.Z.extend(t,{class:d,href:c,target:l});var m=this.$el.parent("a");m.length?m.attr(t):(m=(0,r.Z)("<a>").attr(t),this.$el.wrap(m)),!e&&RM.screenshot&&(m=this.$el.parent("a")).removeAttr("href")}}},updateWidgetData:function(t,e,i){s.Z.extend(this,t,t.params),this.page=e,this.mag=this.page.mag,this.$pageContainer=i||this.page.$content,this.x=this.x||0,this.y=this.y||0},getAnimations:function(){return v.Z.normalizeAnimations(this.animation)},getAnimationTriggers:function(t){var e=this.getAnimations().find((function(e){return e.UUID===t}));return v.Z.normalizeAnimationTriggers(e&&e.trigger)},isGlobal:function(){return!!this.is_global},isAbove:function(){return!!this.is_above}})},1018:function(t,e,i){"use strict";i.r(e);var n=i(312),r=i(321),a=i(944),o=i(1012),s=i(1019),c=i(1020),l=i(935),d=i(1021),u=o.Z.extend({render:function(){return this.rendered=!0,this.page.on("resize",this.onResize,this),this.template=s.Z["template-viewer-widget-background"],this.setElement(this.template({data:this})),this.$el.prependTo(this.page.$fixedBgContainer),this.$picture=this.$(".picture-background"),this.$video=this.$(".video-background"),this.$videoContainer=this.$(".video-container"),this.$slideshow=this.$(".slideshow-container"),this.$slideshowPreload=this.$(".slideshow-preload"),this.picture&&"picture"===this.selectedType?this.renderPicture():r.Z.isEmpty(this.video)||"video"!==this.selectedType?this.slideshow&&"slideshow"===this.selectedType?this.renderSlideshow():this.widgetIsLoaded():this.renderVideo(),this},start:function(){return this.started=!0,"video"===this.selectedType&&!RM.screenshot&&this.rendered&&this.videoWidget&&!this.destroyed&&(this.videoWidget.start(),this.onResize()),"slideshow"!==this.selectedType||RM.screenshot||!this.rendered||this.destroyed||!this.slideshowWidget||this.slideshowWidget.isAnimationRunning||this.slideshowWidget.startAnimationLoop(),this},stop:function(){return this.started=!1,"video"===this.selectedType&&!RM.screenshot&&this.rendered&&this.videoWidget&&!this.destroyed&&this.videoWidget.stop(),"slideshow"===this.selectedType&&!RM.screenshot&&this.rendered&&!this.destroyed&&this.slideshowWidget&&this.slideshowWidget.isAnimationRunning&&this.slideshowWidget.stopAnimationLoop(),this},destroy:function(){return this.page.off("resize",this.onResize,this),"video"===this.selectedType&&(this.videoWidget&&this.videoWidget.destroy(),this.videoWidget=null),"slideshow"===this.selectedType&&(this.slideshowWidget&&this.slideshowWidget.destroy(),this.slideshowWidget=null),o.Z.prototype.destroy.apply(this,arguments)},hasVideoBG:function(){return!(RM.screenshot||"video"!==this.selectedType||!this.video||!this.video.url)},onResize:function(){!this.destroyed&&this.$videoContainer&&this.video&&a.Z.setVideoPosition({mag:this.page.mag,$container:this.$videoContainer,$media:this.$videoContainer.children(),provider:this.video.provider_name,aspect_poster:this.video.aspect_poster||this.videoWidget&&this.videoWidget.aspect_poster,aspect_real:this.video.aspect_real,controls_remove:!0})},renderPicture:function(){if(this.picture){var t=l.Z.useLambdaUrl(this.picture)||l.Z.useLambdaUrlOldProjects(this.picture,"background")?l.Z.getLambdaUrl(this.picture):this.picture.finalUrl||this.picture.effectUrl||this.picture.unscaledOptimizedUrl||this.picture.url;(0,n.Z)("<img/>").on("load",r.Z.bind((function(){this.$picture.css({"background-image":"url("+t+")"}),RM.screenshot?setTimeout(this.widgetIsLoaded,200):this.widgetIsLoaded()}),this)).on("error",this.widgetIsLoaded).attr("src",t)}else this.widgetIsLoaded()},renderSlideshow:function(){this.slideshowWidget=new c.Z({data:this.slideshow,container:this.$slideshow,preloadContainer:this.$slideshowPreload,name:this.page.cid}),RM.screenshot?(this.slideshowWidget.render(),this.slideshowWidget.on("loaded",function(){this.widgetIsLoaded()}.bind(this))):(this.slideshowWidget.render(!this.page.isCurrent()),this.widgetIsLoaded())},renderVideo:function(){this.video.id=this.id,this.video.mute=this.mute,this.video.loop=this.loop,this.video.controls=!1,this.videoWidget=new d.default(this.video,this.page,this.$videoContainer),this.videoWidget.on("loaded",r.Z.bind((function(){this.widgetIsLoaded(),this.onResize()}),this)),this.videoWidget.on("playStarted",r.Z.bind((function(){this.trigger("videoBGStarted")}),this)),this.videoWidget.render()}});e.default=u},1023:function(t,e,i){"use strict";i.r(e);var n=i(312),r=i(1012),a=i(1024),o=i(323);function s(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?s(Object(i),!0).forEach((function(e){l(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var d=r.Z.extend({DO_NOT_WAIT_FOR_PRELOAD:!0,antialiasRotation:!0,mailchimpMatcher:/__rm_mailchimp_(.+)/i,anchorRegexp:/__rm_anchor/i,shareRegexp:/^share\.(facebook|twitter|pinterest|gplus|linkedin|email)\.(mag|page)$/i,render:function(){var t;return this.preloadIconImage({default:!0}),this.makeBox("widget-button"),this.hasHoverAnimation&&this.$el.addClass("has-onhover-animation"),this.rendered=!0,this.seamlessFontsShow(function(){this.$el.removeClass("fonts-pending")}.bind(this),function(){this.$el.addClass("fonts-pending")}.bind(this)),t={model:this,$container:this.$el,environment:"viewer",mag:this.page&&this.page.mag,block:null},this.buttonWidget=new a.Z(t),this.preloadIconImage({hover:!0}),this.$el.on(o.Z.isDesktop?"mouseenter":"touchstart",this.onButtonHover),this.$el.on(o.Z.isDesktop?"mouseleave":"touchend",this.onButtonHoverOut),this.$el.on("click",this.onButtonClick),this.checkLink(),RM.screenshot?(this.waitForIconImageLoad(),this.waitForUsedFontsLoad()):this.widgetIsLoaded(),this},renderButtonText:function(t){this.buttonWidget.renderButtonText(t)},renderButtonTextWithSizes:function(t,e){this.buttonWidget.renderButtonTextWithSizes(t,c(c({},this),e))},hasFontsToLoad:function(){return"text"===this.tp||"text_and_icon"===this.tp},onButtonHover:function(){this.$(".common-button").addClass("hovered")},onButtonHoverOut:function(){this.$(".common-button").removeClass("hovered")},onButtonClick:function(t){if(2!==t.which&&!t.metaKey&&!t.ctrlKey){var e=this.$el.closest("a"),i=n.Z.trim(e.attr("href")).match(/\/start-with-template\/(\d+)$/i),r=i&&i[1];r&&RM.viewerRouter&&RM.viewerRouter.createMagFromTemplate&&(t.preventDefault(),RM.viewerRouter.createMagFromTemplate("template-link",r));var a=this.text?this.text:"icon"===this.tp?"icon":"empty";RM.analytics&&RM.analytics.sendEvent("Button Click",a)}},preloadIconImage:function(t){t=t||{};var e=this.tp;if("icon"===e||"text_and_icon"===e){if(t.default)(new Image).src=Modernizr.retina&&this.icon_raster2xUrl||this.icon_rasterUrl;if(t.hover)(new Image).src=Modernizr.retina&&this["hover-icon_raster2xUrl"]||this["hover-icon_rasterUrl"]}},_widgetIsLoaded:function(){this.loaded||this.destroyed||(RM.screenshot?this.iconImageLoaded&&this.fontLoaded&&this.widgetIsLoaded():this.widgetIsLoaded())},waitForIconImageLoad:function(){this.iconImageLoaded=!1,"icon"!==this.tp&&"text_and_icon"!==this.tp||!this.icon_rasterUrl?this.onIconImageLoaded():(0,n.Z)("<img>").on("load",this.onIconImageLoaded).on("error",this.onIconImageLoaded).attr("src",Modernizr.retina?this.icon_raster2xUrl||this.icon_rasterUrl||"":this.icon_rasterUrl||"")},onIconImageLoaded:function(){this.iconImageLoaded=!0,this._widgetIsLoaded()},waitForUsedFontsLoad:function(){this.fontLoaded=!1,this.hasFontsToLoad()?this.page.addFontsToLoad(this,this.onFontLoaded):this.onFontLoaded()},onFontLoaded:function(){this.fontLoaded=!0,this._widgetIsLoaded()},destroy:function(){return this.buttonWidget&&this.buttonWidget.destroy(),this.buttonWidget=null,this.$el.off(o.Z.isDesktop?"mouseenter":"touchstart",this.onButtonHover),this.$el.off(o.Z.isDesktop?"mouseleave":"touchend",this.onButtonHoverOut),this.$el.off("click",this.onButtonClick),r.Z.prototype.destroy.apply(this,arguments)}});e.default=d},1031:function(t,e,i){"use strict";i.r(e);var n=i(312),r=i(321),a=i(1012),o=i(340),s=i(308),c=i(710),l=i(958),d=i(935),u=i(736);function h(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function p(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var f=a.Z.extend({antialiasRotation:!0,mailchimpMatcher:/__rm_mailchimp_(.+)/i,anchorRegexp:/__rm_anchor/i,shareRegexp:/^share\.(facebook|twitter|pinterest|gplus|linkedin|email)\.(mag|page)$/i,render:function(){this.makeBox("widget-picture"),this.canShowPreview()&&this.initPreview(),this.hasHoverAnimation&&this.$el.addClass("has-onhover-animation"),this.rendered=!0,this.$lqipImg=null,this.useLqip=this.mag&&this.mag.opts&&this.mag.opts.lqip&&(d.Z.useLambdaUrl(this.picture)||d.Z.useLambdaUrlOldProjects(this.picture));var t=this.getPictureUrl();if(/\.gif/.test(t)&&(this.isGIF=!0),this.$el.html(""),this.isVector(t)&&!s.ZP.IS_FILE_PROTOCOL)this.loadVector(t);else{var e=!!(this.border_size>0||this.border_radius>0||this.border_radius_max||this.border_radius_independent&&(this.border_radius_tl>0||this.border_radius_tr>0||this.border_radius_bl>0||this.border_radius_br>0)||this.is_full_width||this.is_full_height),i=void 0===this.opacity?1:this.opacity;if(this.insideHotspot&&this.isGIF){var a=this.scale;(0,n.Z)("<div/>").appendTo(this.$el).css({position:"absolute","background-image":"url("+t+")","background-position":"50% 50%",width:Math.max(Math.round(this.originalW*a),this.w),height:Math.max(Math.round(this.originalH*a),this.h),top:-Math.round(this.cropY*a),left:-Math.round(this.cropX*a)}).attr("url",t)}else e&&(0,n.Z)("<div/>").appendTo(this.$el).addClass("bgpic").css({"background-image":this.useLqip?"":"url(".concat(t,")"),"background-position":(this.fhpos?this.fhpos:50)+"% "+(this.fwpos?this.fwpos:50)+"%","box-shadow":this.border_size>0?"inset 0 0 0 "+this.border_size+"px #"+(this.border_color||"000000"):"none","border-radius":this.getBorderRadius(),opacity:this.useLqip?0:i}).attr("url",this.useLqip?"":t);if(d.Z.useLambdaUrl(this.picture)||d.Z.useLambdaUrlOldProjects(this.picture)){var o=d.Z.getSrcset(this.picture,function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(Object(i),!0).forEach((function(e){p(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},this.getPictureOptions()));(0,n.Z)("<img/>").attr("srcset",o).attr("alt",this.getAltText()).attr("src",t).addClass("viewable").toggleClass("saveable",!!(e||this.insideHotspot&&this.isGIF)).css("opacity",0).load(r.Z.bind((function(){var e=this.$el.find(".viewable"),n=e&&e.get(0)&&e.get(0).currentSrc||t,a=this.$el.find(".bgpic");a&&a.css({opacity:i,"background-image":"url(".concat(n,")")}).attr("url",n),e&&e.css("opacity",i),this.$lqipImg&&this.$lqipImg.css("opacity",0),r.Z.delay(r.Z.bind((function(){this.$el.css({overflow:"","border-radius":""}),this.$lqipImg&&this.$lqipImg.remove(),this.$lqipImg=null,this.widgetIsLoaded()}),this),200)}),this)).on("error",r.Z.bind((function(){this.$lqipImg&&this.$lqipImg.remove(),this.$lqipImg=null,this.widgetIsLoaded()}),this)).appendTo(this.$el),this.useLqip&&(this.$el.css("overflow","hidden"),(this.border_radius||this.border_radius_max||this.border_radius_independent)&&this.$el.css("border-radius",this.getBorderRadius()),this.$lqipImg=(0,n.Z)("<div/>").addClass("lqip").css({"background-image":"url(".concat(d.Z.getLqipUrl(this.picture,{cropX:this.cropX,cropY:this.cropY,cropW:this.cropW,cropH:this.cropH,originalW:this.originalW,originalH:this.originalH}),")"),"background-position":"50% 50%",opacity:i}).appendTo(this.$el))}else(0,n.Z)("<img/>").appendTo(this.$el).toggleClass("saveable",!!(e||this.insideHotspot&&this.isGIF)).css("opacity",void 0===this.opacity?1:this.opacity).addClass("viewable").load(r.Z.bind((function(){this.$el.find("img").attr("url",t),this.widgetIsLoaded()}),this)).on("error",this.widgetIsLoaded).attr("srcset",this.getSrcset()).attr("alt",this.getAltText()).attr("src",t)}return this.checkLink(),this},getBorderRadius:function(){return this.border_radius_independent?"".concat(this.border_radius_tl||0,"px ").concat(this.border_radius_tr||0,"px ").concat(this.border_radius_bl||0,"px ").concat(this.border_radius_br||0,"px"):"".concat(this.border_radius_max?"9999":this.border_radius||0,"px")},canShowPreview:function(){var t=Boolean(this.getAnimations().find((function(t){return"click"===t.type&&t.steps&&t.steps.length}))),e=!!this.clickLink;return this.preview_enabled&&!t&&!e},isValid:function(){return Boolean(this.picture&&(this.picture.type||this.picture.unscaledUrl||this.picture.finalUrl||this.picture.editedVectorUrl||this.picture.url))},isVector:function(t,e){var i=t||this.picture&&this.picture.url;return"svg"===(e||this.picture&&this.picture.type)||i&&0===r.Z.last(i.split(".")).indexOf("svg")},start:function(){return this.started=!0,Modernizr.safari&&this.isGIF&&this.$el.flashClass("fix-safari-gif",100),this},getPictureOptions:function(){var t=this.getAnimations().reduce((function(t,e){return Math.max(t,u.Z.maxScaleAnimation(e))}),0);return{width:this.w,height:this.h,cropX:this.cropX,cropY:this.cropY,cropW:this.cropW,cropH:this.cropH,originalW:this.originalW,originalH:this.originalH,scale:c.Z.isOnForRatio(this.page.pageViewport,this.page.scale,this.mag.opts)?this.page.scale:1,animationScale:t&&t/100,isStretched:this.is_full_width||this.is_full_height}},getPictureUrl:function(){return this.picture?d.Z.useLambdaUrl(this.picture)||d.Z.useLambdaUrlOldProjects(this.picture)?d.Z.getLambdaUrl(this.picture,this.getPictureOptions()):this.picture.finalUrl&&0===r.Z.last(this.picture.finalUrl.split(".")).indexOf("svg")?this.picture.finalUrl:(t=c.Z.isOnForRatio(this.page.pageViewport,this.page.scale,this.mag.opts)?this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl||this.picture.final2xUrl||this.picture.finalUrl:Modernizr.retina&&(window.devicePixelRatio>=3&&(this.picture.final3xUrl||this.picture.unscaledOptimizedUrl)||this.picture.final2xUrl||this.picture.unscaledOptimizedUrl)||this.picture.finalUrl,(this.is_full_width||this.is_full_height)&&(t=this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl||this.picture.final2xUrl||this.picture.finalUrl),t||this.picture.effectUrl||this.picture.editedVectorUrl||this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl||this.picture.url):"";var t},getAltText:function(){return this.picture&&this.alt?r.Z.escape(this.alt):void 0},getSrcset:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.picture)return[];if(!this.originalW)return[];if(this.isGIF)return[];if(c.Z.isOn(this.page.pageViewport,this.mag.getViewportWidth(this.page.pageViewport),this.mag.viewOpts))return[];if(this.getAnimations().length)return[];if(RM.screenshot)return[];if(this.picture.finalUrl&&0===r.Z.last(this.picture.finalUrl.split(".")).indexOf("svg"))return[];var e=Math.floor(this.w),i=[{url:this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl,size:this.originalW},{url:this.picture.final2xUrl&&(this.picture.unscaledOptimizedUrl||this.picture.final3xUrl),size:3*e},{url:this.picture.final2xUrl,size:2*e},{url:this.picture.finalUrl,size:e}];if(i=i.filter(function(t){return!!t.url&&this.originalW>=t.size}.bind(this)).map((function(t){return"".concat(t.url," ").concat(t.size,"w")})),!t)return i;var n=["".concat(this.picture.finalUrl||this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl," 1x")];return this.picture.final2xUrl&&n.push("".concat(this.picture.final2xUrl," 2x")),this.picture.final2xUrl&&(this.picture.unscaledOptimizedUrl||this.picture.final3xUrl)&&n.push("".concat(this.picture.final2xUrl&&(this.picture.unscaledOptimizedUrl||this.picture.final3xUrl)," 3x")),n.concat(i)},loadVector:function(t){this.$el.addClass("svg"),this.svgAjax=n.Z.get(t+"?c",r.Z.bind((function(e){var i=(0,n.Z)(o.default.cleanupSVG((0,n.Z)(e).find("svg").get(0).cloneNode(!0)));i.get(0).removeAttribute("width"),i.get(0).removeAttribute("height"),this.$svg=i;var a=i.get(0).cloneNode(!0);this.$svg.find("title").remove();var s=new Image;(0,n.Z)(s).on("load error",r.Z.bind((function(){(0,n.Z)(s).appendTo(window.document.body).css({width:"100%",height:"100%"});var t=(0,n.Z)(a);t.get(0).setAttribute("viewBox","0 0 "+(0,n.Z)(s).width()+" "+(0,n.Z)(s).height()),t.appendTo(window.document.body);var e=t.get(0).getBBox();this.$svg.get(0).setAttribute("viewBox",e.x+" "+e.y+" "+e.width+" "+e.height),this.$svg.get(0).setAttribute("preserveAspectRatio","xMidYMid meet"),(0,n.Z)(s).remove(),t.remove();var i=(0,n.Z)('<div class="svg-scale-wrapper"></div>');this.$svg.appendTo(i),i.appendTo(this.$el),this.widgetIsLoaded()}),this)),s.src=t}),this)).fail(this.widgetIsLoaded)},initPreview:function(){this.preview=new l.Z({$container:(0,n.Z)("body"),$el:this.$el,picture:this.picture,overlayColor:this.preview_overlay_color,originalW:this.originalW,width:this.w,viewportWidth:this.mag.getViewportWidth(this.page.pageViewport),viewport:this.page.pageViewport,viewerOptions:this.mag.viewOpts}),this.$el.addClass("preview-enabled"),this.$el.on("click",function(){this.preview.render(),this.preview.bindClick()}.bind(this))}});e.default=f},1043:function(t,e,i){"use strict";i.r(e);var n=i(312),r=i(321),a=i(1012),o=i(1035),s=i(710),c=i(340),l=i(323),d=a.Z.extend(o.Z.prototype).extend({mailchimpMatcher:/__rm_mailchimp_(.+)/i,anchorRegexp:/__rm_anchor/i,shareRegexp:/^share\.(facebook|twitter|pinterest|gplus|linkedin|email)\.(mag|page)$/i,render:function(){if(this.makeBox("widget-shape"),this.hasHoverAnimation&&this.$el.addClass("has-onhover-animation"),this.rendered=!0,this.requiresImageLoad()){if(!this.rasterUrl)return this.widgetIsLoaded(),this;this.$el.addClass("icon"),this.antialiasRotation=!0;var t=(0,n.Z)("<img>");t.on("load",r.Z.bind((function(){this.$el.html(t),this.widgetIsLoaded()}),this)).on("error",this.widgetIsLoaded),t.attr("src",Modernizr.retina||s.Z.isOnForRatio(this.page.pageViewport,this.page.scale,this.mag.opts)?this.raster3xUrl||this.raster2xUrl||this.rasterUrl||"":this.rasterUrl||"")}else this.redrawSVG(),this.widgetIsLoaded();return this.checkLink(),this},start:function(){Modernizr.firefox&&!this.requiresImageLoad()&&this.borders>0&&this.redrawSVG()},redrawSVG:function(){var t=this,e={id:t._id,get:function(e){return t[e]}};if("rectangle"!==this.tp||1!==this.opacity||this.radius_rect_independent||l.Z.isDesktop&&0!==this.borders){var i=this.generateShapeSVG("viewer-"+c.default.generateUUID(),e,this.$el.width(),this.$el.height());this.$el.html(i)}else{var n=c.default.hex2rgb(this.bg_color),r=c.default.hex2rgb(this.color);n&&n.push(this.bg_opacity),this.$el.css({"background-color":n?"rgba("+n.join(",")+")":"transparent","border-color":r?"rgb("+r.join(",")+")":"transparent","border-radius":this.radius||0,"border-style":"solid","border-width":this.borders,"box-sizing":"border-box"}),this.$el.addClass("div-instead-of-svg")}},requiresImageLoad:function(){return"icon"===this.tp},canRenderImmediately:function(){return!this.requiresImageLoad()},onPageResize:function(t){a.Z.prototype.onPageResize.apply(this,arguments),this.requiresImageLoad()||this.redrawSVG()}});e.default=d},1037:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return b}});var n,r=i(312),a=i(321),o=i(1012),s=i(308),c=i(341),l=i(979),d=i(349);var u,h,p,f,g,m=(u={},h="template-viewer-widget-text",p=(0,d.f)(n||(f=["\n\t<%var cc = column_count == 1 ? 'auto' : column_count;%>\n\t<div style=\" -webkit-nbsp-mode:normal; -webkit-line-break:after-white-space; white-space:<%=isNotChrome ? 'normal' : 'pre-wrap'%>; column-count:<%=cc%>;-webkit-column-count:<%=cc%> !important;-moz-column-count:<%=cc%>;column-gap:<%=column_gap%>px;-webkit-column-gap:<%=column_gap%>px !important;-moz-column-gap:<%=column_gap%>px;background:<%-bg%>\"><%=text%></div>\n"],g||(g=f.slice(0)),n=Object.freeze(Object.defineProperties(f,{raw:{value:Object.freeze(g)}})))),h in u?Object.defineProperty(u,h,{value:p,enumerable:!0,configurable:!0,writable:!0}):u[h]=p,u),v=i(323),y=i(710),b=o.Z.extend({DO_NOT_WAIT_FOR_PRELOAD:!0,antialiasRotation:!0,mailchimpMatcher:/__rm_mailchimp_(.+)/i,anchorRegexp:/__rm_anchor/i,shareRegexp:/^share\.(facebook|twitter|pinterest|gplus|linkedin|email)\.(mag|page)$/i,render:function(){this.makeBox("text"),this.hasHoverAnimation&&this.$el.addClass("has-onhover-animation"),this.rendered=!0,this.bg_color=null==this.bg_color?"ffffff":this.bg_color,this.bg_opacity=null==this.bg_opacity?0:this.bg_opacity,this.column_count=null==this.column_count?1:this.column_count,this.column_gap=null==this.column_gap?16:this.column_gap;var t=[parseInt(this.bg_color.substring(0,2),16),parseInt(this.bg_color.substring(2,4),16),parseInt(this.bg_color.substring(4,6),16)];this.bg_opacity>.99?this.bg="rgb("+t[0]+","+t[1]+","+t[2]+")":this.bg="rgba("+t[0]+","+t[1]+","+t[2]+", "+this.bg_opacity+")",this.text=this.switchTextToViewport(this.text,this.insideHotspot?"default":this.page.pageViewport);var e=this.mag.model.attributes&&this.mag.model.attributes.edit_params&&this.mag.model.attributes.edit_params.paragraph_styles||[],n=r.Z.parseHTML(this.text);n=n.map((function(t){var i=(0,r.Z)(t),n=i.attr("class");if(n){var a=e.find((function(t){return t._name.toLowerCase()===n.toLowerCase()}));if(a&&a.tag&&"p"!==a.tag&&s.ZP.AVAILABLE_TEXT_TAGS.includes(a.tag))return(0,r.Z)("<"+a.tag+' class="'+n+'" style="'+(i.attr("style")||"")+'" />').append(i.contents())[0].outerHTML}return t.outerHTML})).filter((function(t){return t})),this.text=n.join(""),this.isNotChrome=!(Modernizr.webkit&&!Modernizr.safari&&!Modernizr.safari5)&&this.text.includes("justify");var o=m["template-viewer-widget-text"],l=(0,r.Z)(o(this));this.seamlessFontsShow(function(){this.$el.removeClass("fonts-pending")}.bind(this),function(){this.$el.addClass("fonts-pending")}.bind(this)),y.Z.isOn(this.mag.getViewportWidth(this.page.pageViewport))&&y.Z.isCSSZoom()&&this.transformInsteadOfZoom(l),this.$el.append(l),this.$content=l,this.$el.on(v.Z.isDesktop?"mouseenter":"touchstart","a",this.onLinkMouseEnter),this.$el.on(v.Z.isDesktop?"mouseleave":"touchend","a",this.onLinkMouseLeave),this.$el.on("click","a",this.onLinkClick),l.addClass("v"+(this.version||1));var d=this;return this.$el.find("a").each((function(){var t=(0,r.Z)(this),e=t.attr("data-pid"),i=t.attr("href"),n=decodeURIComponent(i),o=/^back\sto\stop$/i,s=e,l=!1;(o.test(i)||o.test(n))&&(s=d.page._id);var u=i&&d.page.mag.matchSameDomainLink(i);if((u==t.attr("href")||s)&&(u=void 0),s=s||u){var h=d.page.mag.getPageNum(s),p=h&&d.page.mag.getPageUri?"/".concat(d.page.mag.getPageUri(s)):"javascript:void(0)";if(h){t.addClass("maglink").attr("target","");var f=document.querySelector("base");if(RM.common.isDownloadedSource&&f){var g=f.getAttribute("href");"/"!==g&&t.attr("href","".concat(g).concat(p.substring(1))).data("link",p)}else t.attr("href",p)}else t.removeAttr("href");s==d.page._id&&(t.addClass("back-to-top"),e&&(d.is_global||d.hasGlobalParent)&&t.addClass("current"))}else if(/^__rm_goback$/i.test(t.attr("href")))t.attr("href","javascript:void(0)").addClass("goback-link");else if(d.mailchimpMatcher.test(t.attr("href"))){var m=t.attr("href").match(d.mailchimpMatcher)[1];t.attr("href","javascript:void(0)").attr("data-mailchimp",m).addClass("mailchimp-link"),c.Z.initMailchimpAPI()}else if(d.shareRegexp.test(t.attr("href"))){var v=t.attr("href").match(d.shareRegexp);t.attr("href","javascript:void(0)").attr("data-share-provider",v[1]).attr("data-share-type",v[2]).addClass("share-link")}else if(d.anchorRegexp.test(t.attr("href"))){t.attr("href","javascript:void(0)").addClass("anchor-link");var y=t.attr("data-page-uri"),b=a.Z.findWhere(d.mag.pages,{_id:y})||d.page;t.attr("data-page-uri",b.uri||b.num)}else l=!0,t.addClass("external-link");!t.attr("href")||0!=t.attr("href").indexOf("mailto")&&0!=t.attr("href").indexOf("tel")||t.attr("target",""),!l&&RM.screenshot&&t.removeAttr("href")})),RM.screenshot&&!this.insideHotspot?this.waitForUsedFontsLoad():this.widgetIsLoaded(),this.$el.find("span.soundcite").each((function(t,e){RM.screenshot||i.e(41).then(i.bind(i,1125)).then((function(t){t.default.createPlayer(e)}))})),y.Z.isDesktopDefault(this.mag.viewport)&&y.Z.isScaleLayout(this.mag.viewOpts)&&y.Z.isCSSZoom()&&this.listenTo(this.page,"resize",this.onScaleChange),this},onScaleChange:function(){this.transformInsteadOfZoom(this.$content)},transformInsteadOfZoom:function(t){var e=this.page.scale;y.Z.isOnForRatio(this.page.pageViewport,e,this.mag.opts)&&y.Z.isCSSZoom()&&t.css({zoom:1/e,transform:"scale(".concat(e,")"),width:"".concat(1/e*100,"%"),height:"".concat(1/e*100,"%"),"transform-origin":"left top"})},isValid:function(){var t=(0,r.Z)("<div>").html(this.text).text();return""!=r.Z.trim(t)},hasFontsToLoad:function(){return!0},start:function(){return this.started=!0,Modernizr.chrome&&this.$el.addClass("force-repaint-content"),this},stop:function(){return this.started=!1,this.$el.removeClass("force-repaint-content"),RM.screenshot||this.destroyed||!this.rendered||this.$el&&this.$el.find("span.soundcite").each((function(t,e){i.e(41).then(i.bind(i,1125)).then((function(t){t.default.pausePlayer(e)}))})),this},destroy:function(){return this.$el&&this.$el.find("span.soundcite").each((function(t,e){i.e(41).then(i.bind(i,1125)).then((function(t){t.default.destroyPlayer(e)}))})),o.Z.prototype.destroy.apply(this,arguments)},waitForUsedFontsLoad:function(){this.hasFontsToLoad()?this.page.addFontsToLoad(this,this.widgetIsLoaded):this.widgetIsLoaded()},checkLink:function(){if(this.is_global||this.hasGlobalParent){var t=this.$el.find("a[data-pid]");t.removeClass("current back-to-top"),this.page&&t.filter('[data-pid="'+this.page._id+'"]').addClass("current back-to-top").removeClass("hovered")}o.Z.prototype.checkLink.apply(this,arguments)},onLinkMouseEnter:function(t){var e=(0,r.Z)(t.currentTarget).attr("data-uuid");this.$el.find("a[data-uuid='"+e+"']").addClass("hovered")},onLinkMouseLeave:function(t){var e=(0,r.Z)(t.currentTarget).attr("data-uuid");this.$el.find("a[data-uuid='"+e+"']").removeClass("hovered")},onLinkClick:function(t){if(2!=t.which&&!t.metaKey&&!t.ctrlKey){var e=(0,r.Z)(t.currentTarget),i=r.Z.trim(e.attr("href")).match(/\/start\-with\-template\/(\d+)$/i),n=i&&i[1];n&&RM.viewerRouter&&RM.viewerRouter.createMagFromTemplate&&(t.preventDefault(),RM.viewerRouter.createMagFromTemplate("template-link",n))}}}).extend(l.Z.prototype)},1021:function(t,e,i){"use strict";i.r(e);var n=i(312),r=i(321),a=i(1022),o=i(1012),s=i(944),c=i(340),l=i(323),d=i(935),u=i(736),h=i(710),p=i(347),f=function(t,e){this.playerIsReady=!1,this.queue=[],function(t,e){var i=r.Z.bind(t,e);if(window.youTubeApiIsReady)return i();window.ytQueue.push({cb:i,context:e})}((function(){this.yt=new window.YT.Player(t.id,{events:{onReady:r.Z.bind((function(){this.destroyed||(this.playerIsReady=!0,r.Z.each(this.queue,(function(t){r.Z.isFunction(t.cb)&&t.cb()})))}),this)}})}),this),this.start_time=e&&e.start_time};f.prototype={addToQueue:function(t,e){var i=r.Z.bind(t,e);if(this.playerIsReady)return i();this.queue.push({cb:i,context:e})},on:function(t,e,i){var n=r.Z.bind(e,i||window),a={finish:0,play:1,pause:2};"ready"!==t?this.addToQueue((function(){this.yt.addEventListener("onStateChange",(function(e){a[t]===Number(e.data)&&n()}))}),this):this.addToQueue(n,this)},mute:function(){this.addToQueue((function(){this.yt.mute()}),this)},unMute:function(){this.addToQueue((function(){this.yt.unMute()}),this)},pause:function(){this.addToQueue((function(){this.yt&&this.yt.pauseVideo&&this.yt.pauseVideo()}),this)},play:function(){this.addToQueue((function(){this.yt.playVideo()}),this)},rewind:function(t){this.addToQueue((function(){this.yt.seekTo(t||0)}),this)},loop:function(){this.rewind(this.start_time||.01)},getDuration:function(){return this.duration||(this.duration=this.yt.getDuration()),this.duration},getCurrentTime:function(){return this.yt.getCurrentTime&&this.yt.getCurrentTime()||0},checkLoop:function(){if(this.getDuration()-this.yt.getCurrentTime()<.5)return this.loop(),!0},destroy:function(){window.ytQueue=r.Z.reject(window.ytQueue,(function(t){return t.context===this})),delete this.yt,delete this.queue,this.destroyed=!0}};var g=function(t,e){r.Z.bindAll(this),this.id=t.id,this.start_time=e&&e.start_time};g.prototype={on:function(t,e){(0,a.Z)(this.id).addEvent(t,e)},mute:function(){(0,a.Z)(this.id).api("setVolume",0)},unMute:function(){return!1},pause:function(){(0,a.Z)(this.id).api("pause")},play:function(){(0,a.Z)(this.id).api("play")},rewind:function(t){(0,a.Z)(this.id).api("seekTo",t||0)},loop:function(){this.start_time&&this.rewind(this.start_time)},getCurrentTime:function(t){(0,a.Z)(this.id).api("getCurrentTime",t)},setColor:function(t){(0,a.Z)(this.id).api("setColor",t)},destroy:function(){var t=(0,a.Z)(this.id);t&&(t.removeEvent("ready"),t.removeEvent("play"),t.removeEvent("finish"),t.removeEvent("pause"))}};var m={Vimeo:r.Z.template('<iframe src="https://player.vimeo.com/video/<%=video_id%>?wmode=opaque&api=1&loop=<%=(loop)?1:0%>&muted=<%=(mute)?1:0%>&player_id=video_<%=id%><%=(!real)?"_c":""%>&title=<%=info?1:0%>&byline=<%=info?1:0%>&portrait=<%=info?1:0%>&color=<%=color%>" id="video_<%=id%><%=(!real)?"_c":""%>" width="<%=w%>" height="<%=h%>" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen allow="autoplay; fullscreen; encrypted-media"></iframe>'),YouTube:r.Z.template('<iframe <% if (real) {%>id="yt_<%=video_id%>"<%}%> src="https://www.youtube.com/embed/<%=video_id%>?&wmode=opaque&enablejsapi=1&playlist=&autohide=1&loop=<%=(loop)?1:0%>&showinfo=<%=info?1:0%>&theme=<%=theme%>&controls=<%=controls? 1: 0%><%=html5 ? "&html5=1" : ""%>&rel=0&vq=hd1080&playsinline=<%=(autoplay)?1:0%>" width="<%=w%>" height="<%=h%>" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen allow="autoplay; fullscreen; encrypted-media"></iframe>')},v=o.Z.extend({RESTART_TIMEOUT:5e3,isPlaying:!1,initialize:function(t,e,i){return o.Z.prototype.initialize.apply(this,arguments),this.$container=i,delete this.real,this},render:function(){return this.$container?this.setElement(this.$container):this.makeBox("video"),this.rendered=!0,this.setPosterInsteadOfVideo(),this},isValid:function(){return this.video_id&&this.provider_name},_needAutoStart:function(){return this.autoplay&&!c.default.PageVisibilityManager.isPageHidden()},start:function(){return this.started=!0,this.onPlayFired=!1,RM.screenshot||!this.rendered||this.destroyed||(this.playerInitialized||(this.$el.append(this.getEmbed()),this.$iframe=this.$el.find("iframe"),this.$iframe.attr("id","video_"+this.id),this.player=this.createPlayer(this.provider_name,this.$iframe,{start_time:this.start_time,autoplay:this._needAutoStart()}),this.player&&this.player.on("ready",this.onPlayerReady),this.playerInitialized=!0),this.player&&this._needAutoStart()&&this.player.play()),this},stop:function(){return this.started=!1,clearInterval(this.loopInterval),!RM.screenshot&&!this.destroyed&&this.player&&this.rendered&&("youtube"===this.provider_name.toLowerCase()?(this._needAutoStart()&&this.player.pause(),!this._needAutoStart()&&this.onPlayFired&&this.player.pause()):this.player.pause()),this},destroy:function(){return clearInterval(this.loopInterval),this.player&&this.player.destroy(),this.player=null,o.Z.prototype.destroy.apply(this,arguments)},setPosterInsteadOfVideo:function(){if(this.custom_thumbnail||this.thumbnail_url){var t=this.getCustomThumbnail(this);this.custom_thumbnail&&t.url?this.setCustomPosterInsteadOfVideo():this.setEmbeddedPosterInsteadOfVideo()}else this.widgetIsLoaded()},setEmbeddedPosterInsteadOfVideo:function(){this.$poster&&this.$poster.remove(),this.$poster&&this.$poster.off(),this.$poster=(0,n.Z)("<img/>").addClass("poster").css("opacity",0).appendTo(this.$el),this.$poster.on("load",r.Z.bind((function(){this.$poster.css({width:"",height:""}).css("opacity",1);var t=this.$poster[0].width,e=this.$poster[0].height;this.aspect_poster||(this.aspect_poster=t/e),s.Z.setVideoPosition({mag:this.page.mag,$container:this.$el,$media:this.$poster,provider:this.provider_name,aspect_poster:this.aspect_poster,aspect_real:this.aspect_real,controls_remove:!!this.$container}),setTimeout(this.widgetIsLoaded,100)}),this)).on("error",r.Z.bind((function(){this.oldUrl=this.thumbnail_url,this.thumbnail_url=this.thumbnail_url.replace("https://","http://"),this.oldUrl!==this.thumbnail_url?this.setEmbeddedPosterInsteadOfVideo():this.widgetIsLoaded()}),this)).attr("src",this.thumbnail_url)},setCustomPosterInsteadOfVideo:function(){this.$poster&&this.$poster.remove(),this.$poster&&this.$poster.off(),this.$poster=this.getCustomVideoPoster(this),this.$poster.css({visibility:"hidden",cursor:"pointer"}),this.$poster.on("click",r.Z.bind((function(){this.onPosterClicked()}),this)),this.$poster.appendTo(this.$el),setTimeout(this.widgetIsLoaded,100)},getCustomVideoPoster:function(t){var e=(0,p.findImagePath)("./common/video-player/play.svg"),i=(0,n.Z)("<div/>").addClass("poster poster-custom"),r=this.getCustomThumbnail(t),a=r.unscaledOptimizedUrl||r.url;if(d.Z.useLambdaUrl(r)||d.Z.useLambdaUrlOldProjects(r,"video")){var o={width:t.w};r.originalW&&(o.originalW=r.originalW),r.originalH&&(o.originalH=r.originalH);var s=u.Z.normalizeAnimations(t.animation).reduce((function(t,e){return Math.max(t,u.Z.maxScaleAnimation(e))}),0);o.animationScale=s&&s/100,this.page?o.scale=h.Z.isOnForRatio(this.page.pageViewport,this.page.scale,this.mag.opts)?this.page.scale:1:o.scale=RM.constructorRouter.zoom.getZoom(),a=d.Z.getLambdaUrl(r,o)}i.css({width:t.w,height:t.h}),this.mag&&this.mag.opts&&this.mag.opts.lqip&&(this.$lqipImg=(0,n.Z)("<div/>").addClass("lqip").css({"background-image":"url(".concat(d.Z.getLqipUrl(r),")"),width:this.w,height:this.h}).appendTo(this.$el));var c=new Image;return c.onload=function(){var t=this;this.$poster&&this.$poster.css({"background-image":"url(".concat(e,"), url(").concat(a,")"),visibility:""}),this.$iframe&&this.$iframe.addClass("fade-out"),this.$lqipImg&&this.$lqipImg.css("opacity",0),setTimeout((function(){t.$lqipImg&&t.$lqipImg.remove()}),200)}.bind(this),c.src=a,i},getCustomThumbnail:function(t){var e=t.custom_thumbnail_url||"";return t.picture||{url:e,type:r.Z.last(e.split("."))}},onPosterClicked:function(){this.player.play(),r.Z.delay(r.Z.bind((function(){this.$poster&&(this.$poster.off(),this.$poster.remove())}),this),200)},createPlayer:function(t,e,i){return"vimeo"===t.toLowerCase()?new g(e[0],i):"youtube"===t.toLowerCase()?new f(e[0],i):null},getEmbed:function(t){if(t=t||this,r.Z.defaults(t,{real:!0,w:640,h:320,theme:"dark",color:"3ab9ff",info:!1,controls:!0,id:r.Z.uniqueId("video_"),origin:encodeURIComponent(window.location.protocol+"//"+window.location.hostname)}),Modernizr.safari&&(t.html5=!0),!t.video_id)return null;var e=m[t.provider_name](t),i=this.getCustomThumbnail(t);if(!t.real&&t.custom_thumbnail&&i.url){var a=(0,n.Z)(e).css("visibility","hidden");return this.getCustomVideoPoster(t).add(a)}return m[t.provider_name](t)},onPlayerReady:function(){if(!this.destroyed&&this.player){if(this.$container&&(this.mute=!0),this.mute?this.player.mute():this.player.unMute(),!this.$container){var t=this.getCustomThumbnail(this);this.custom_thumbnail&&t.url||(this.$iframe&&this.$iframe.addClass("fade-out"),r.Z.delay(r.Z.bind((function(){this.$poster&&this.$poster.css("opacity",0)}),this),125),r.Z.delay(r.Z.bind((function(){this.$poster&&(this.$poster.off(),this.$poster.remove())}),this),250))}this.player.on("pause",this.onPause),this.player.on("play",this.onPlay),this.player.on("finish",this.onFinish),this.start_time&&(this.player.rewind(this.start_time),this.player.pause()),l.Z.isDesktop&&"vimeo"===this.provider_name.toLowerCase()&&this.player.on("playProgress",this.onProgress),this.started&&this._needAutoStart()&&this.player.play(),this.player.setColor&&this.player.setColor(this.color)}},onPlay:function(){this.isPlaying=!0,!this.$container&&RM.analytics&&RM.analytics.sendEvent("Video Play",this.title+" / "+this.url),this.$iframe&&!this.$iframe.hasClass("fade-out")&&(this.$iframe.addClass("fade-out"),this.trigger("playStarted")),clearInterval(this.loopInterval),this.loop&&this.player.checkLoop&&(this.loopInterval=setInterval(r.Z.bind((function(){this.player.checkLoop()&&(clearInterval(this.loopInterval),Modernizr.safari&&r.Z.delay(function(){this.onPlay()}.bind(this),200))}),this),100)),this.onPlayFired=!0},onPause:function(){if(this.isPlaying=!1,"Vimeo"===this.provider_name)this.player.getCurrentTime(r.Z.bind((function(t){t=Math.round(t),!this.$container&&RM.analytics&&RM.analytics.sendEvent("Video Pause",this.title+" / "+this.url+" / "+t+" sec.",t)}),this));else if("YouTube"===this.provider_name){var t=Math.round(this.player.getCurrentTime());!this.$container&&RM.analytics&&RM.analytics.sendEvent("Video Pause",this.title+" / "+this.url+" / "+t+" sec.",t)}},onFinish:function(){this.isPlaying=!1},onProgress:function(t){this.onPlayFired||this.onPlay(),1===t.percent&&this.loop&&this.player.loop&&this.player.loop(),0===parseFloat(t.seconds)?this.restartTimeout||(this.restartTimeout=setTimeout(r.Z.bind((function(){clearInterval(this.loopInterval),this.playerInitialized=!1,this.player&&this.player.destroy(),this.player=null,this.$iframe&&this.$iframe.remove(),!this.destroyed&&this.started&&this.start(),delete this.restartTimeout}),this),this.RESTART_TIMEOUT)):(clearTimeout(this.restartTimeout),delete this.restartTimeout)},updateVideoFrameSize:function(t,e){this.$iframe&&this.$iframe.attr("width",t).attr("height",e),this.$poster&&this.$poster.css({width:t,height:e})}});e.default=v},1042:function(t){var e="codeinjection",i={instagram:[/^\s*<blockquote\s+class=.instagram-media.*<\/blockquote>\s*<script.*src=.*instagram.+>.*<\/script>\s*$/gi],pinterest:[/^\s*<a.*data-pin-do=.*<\/a>([\s\S]*<script.*src=.*pinterest.+>.*<\/script>)?\s*$/i],facebookvideo:[/^\s*<div\s+id=.fb-root.*<\/div>[\s\S]*<script>.*src.*facebook.*sdk.*<\/script>[\s\S]*<div\s+class=.fb-video.*<\/div>\s*$/i],readymag:[/^\s*<a\s+class=.rm-mag-embed.*<\/a>[\s\S]*<script.+id=.readymag-embed-init.+><\/script>\s*$/i],ecommerce:[/^\s*<form\s+action=.*method=.*POST.+>[\s\S]*<script.*src=.*stripe.+>.*<\/script>[\s\S]*<\/form>\s*$/gim,/^\s*(<!--.*-->)?[\s\S]*<script.*src=.*stripe.+>[\s\S]*<\/script>[\s\S]*(<!--.*-->)?[\s\S]*<button .*>.*<\/button>[\s\S]*<div .*>.*<\/div>[\s\S]*<script>.*stripe.*<\/script>\s*$/gim,/^\s*<div\s+id=.+>[\s\S]*<\/div>[\s\S]*<script[\s\S]*scriptUrl[\s\S]*shopifycdn[\s\S]*>*<\/script>.*$/gim,/^\s*<script\s+src=.*gumroad.+><\/script>[\s\S]*<div\s+class=.gumroad-product-embed.+>[\s\S]*<\/div>\s*$/gim,/^\s*<script\s+src=.*gumroad.+><\/script>[\s\S]*<a\s+class=.gumroad-button.+>[\s\S]*<\/a>\s*$/gim,/^\s*<div\s+class=.*ecwid.+><\/div>[\s\S]*<script.+ecwid.+>.*<\/script>[\s\S]*<script.*>.*xProduct.*<\/script>\s*$/gim,/^\s*<div\s+class=.*ecsp.+><\/div>[\s\S]*<script.+ecwid.+>.*<\/script>[\s\S]*<script.*>.*xProduct.*<\/script>\s*$/gim,/^\s*<div\s+class=.*ec-cart-widget.+><\/div>[\s\S]*<div>[\s\S]*<script.+ecwid.+>.*<\/script>[\s\S]*<script.*>.*Ecwid.*<\/script>[\s\S]*<\/div>\s*$/gim,/^\s*<div\s+id=.*.+><\/div>[\s\S]*<script.+ecwid.+>.*<\/script>[\s\S]*<script.*>.*xProduct.*<\/script>[\s\S]*<\/div>\s*$/gim],gdpr:[/^\s*<a\s+href="https:\/\/www\.iubenda\.com\/privacy-policy\/\d+"[\w\d\s/:;.,'"=-]*>[\w\d\s/:;.,'"=-]*<\/a>\s*<script[\w\d\s/:;.,'"=-]*>\(function\s*\(w,d\)\s*{[\s\S]*s\.src="https:\/\/cdn\.iubenda\.com\/iubenda\.js";[\s\S]*}\)\([\w\s,]*\);<\/script\s*>\s*$/gim,/^\s*<script[\w\d\s/:;.,'="-]*src="https:\/\/consent\.cookiebot\.com\/[\w\d-]+\/cd\.js"[\w\d\s/:;.,'="-]*><\/script\s*>\s*$/gim,/^\s*<script\s*(type="text\/javascript"){0,1}\s*>\s*var\s+cpm\s*=\s*{};\s*\(function\(h,u,b\){[\w\d\s()[\]{}/.,:;="'-]+e\.src='https:\/\/cookiehub\.net(\/dev){0,1}\/c2\/[\w\d-]+\.js';[\w\d\s()[\]{}/.,:;="'-]+}\)\([\w\d\s,]+\);\s*<\/script\s*>\s*$/gim],video:[/^\s*<video[\s\S]*>[\s\S]*<\/video>\s*$/gim],iframe:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=t.replace(/<!--[\s\S]*-->/gi,"");return/^\s*<iframe[\s\S]*>[\s\S]*<\/iframe>\s*$/i.test(e)}};t.exports=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,r=t.trim();for(var a in i){var o=i[a];if("function"==typeof o)return o(r,n)?a:e;for(var s in o)if("function"==typeof(s=o[s])){if(s(r,n))return a}else{var c=new RegExp(s.source,s.flags);if(c.test(r.replace(/\n/g,"")))return a}}return e}},867:function(t,e,i){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t=i.nmd(t);var r=i(322),a=void 0!==n(t)&&t.exports,o="support@readymag.com";function s(t,e){var i=t.split(".");return i.length>1?(i[i.length-2]+="_"+e,i.join(".")):t+"_"+e}var c="Built with Readymag—a tool to design anything on the web.",l=116;function d(t,e){return t?e&&-1===t.indexOf("://")?e+t:t:""}function u(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=a?e.host:window.location.protocol+"//"+window.location.host,n=t&&t.screenshot;return n?d(s(n,1024),i):""}function h(t){var e=t.prefix+t.val+t.suffix;if(t.minLength=t.minLength||1,e.length>l){var i=Math.max(t.val.length-(e.length-l+1),t.minLength);e=t.prefix+t.val.substring(0,i)+"…"+t.suffix}return e}function p(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(r.isEmpty(e)||!r.isObject(e))return{};var n=e.emptyTitle?"":e.title,a=t?t.seo&&t.seo.title?t.seo.title:t.title?t.title:"":"",o="",s=e.description||(i.customDomain?"":c),d="";i.customDomain?o=i.forProject?n||"Project":(n?n+" — ":"")+(a||"Page "+t.num):(i.forProject||(o=(a?"‘"+a+"’":"Page "+t.num)+" from "),o+=(n?"‘"+n+"’":"Project")+" by "+e.user.name,i.forProject&&e.description&&(o+=" | Readymag")),d=i.forProject?u(r.findWhere(e.pages,{num:1}),i):u(t,i);var p="";return i.customDomain?i.forProject?p=n?h({prefix:"",val:n,suffix:""}):"Project":n||a?!n&&a?p=h({prefix:"",val:a,suffix:""}):n&&!a?p=h({prefix:"",val:n,suffix:" — Page "+t.num}):n&&a&&(p=h({prefix:"",val:n,suffix:" — "+a,minLength:20})).length>l&&(p=a).length>l&&(p=h({prefix:"",val:a,suffix:""})):p="Page "+t.num:i.forProject?p=n?h({prefix:"‘",val:n,suffix:"’ by "+e.user.name}):"Project by "+e.user.name:n||a?!n&&a?p=h({prefix:"‘",val:a,suffix:"’ from Project by "+e.user.name}):n&&!a?p=h({prefix:"Page "+t.num+" from ‘",val:n,suffix:"’ by "+e.user.name}):n&&a&&(p=h({prefix:"‘"+a+"’ from ‘",val:n,suffix:"’ by "+e.user.name,minLength:20})).length>l&&(p="‘"+a+"’ by "+e.user.name).length>l&&(p=h({prefix:"‘",val:a,suffix:"’ by "+e.user.name})):p="Page "+t.num+" from Project by "+e.user.name,{image:d,title:o||"",description:s||"",tweet:p}}function f(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(r.isEmpty(e)||!r.isObject(e))return{};var n=p(t,e,i),a=e.master_share_pid&&r.find(e.pages,(function(t){return t._id.toString()===e.master_share_pid.toString()})),o=i.forProject?r.findWhere(e.pages,{num:1}):t,s=a||o,c=s.custom_shares;return r.isEmpty(c)||(n.title=c.title||"",n.description=c.description||"",n.tweet=c.tweet||"",c.image?n.image=c.image:s.screenshot?n.image=u(s,i):n.image=""),n}function g(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(r.isEmpty(e)||!r.isObject(e))return{};var n=e.emptyTitle?"":e.title,a="",o="";return i.customDomain?t&&t.num>1?a=(n?n+" — ":"")+(t.title||"Page "+t.num):(a=n||"Project",o=e.description||""):(t&&t.num>1?a=(t.title?"‘"+t.title+"’":"Page "+t.num)+" from ":o=e.description||c,a=n||"Project"),{title:a||"",description:o||"",keywords:""}}function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:626,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:436;window.open(t,"sharer","width="+e+",height="+i+",toolbar=0,status=0")}t.exports={SUPPORT_MAIL:o,addFilenameComponent:s,defaultDescription:c,maxTweetLen:l,addOrigin:d,removeFilenameComponent:function(t){var e=t.split(".");if(e.length>1){var i=e[e.length-2].split("_");if(i.length>1&&!isNaN(Number(i[i.length-1]))){i.pop();var n=i.join("_");return e[e.length-2]=n,e.join(".")}}return t},getPageScreenshot:u,getDefaultShare:p,getDefaultSEO:g,getFinalShare:f,getFinalSEO:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(r.isEmpty(e)||!r.isObject(e))return{};var n=g(t,e,i);return n.title=t.seo&&t.seo.title||n.title,n.description=t.seo&&t.seo.description||n.description,n.keywords=t.seo&&t.seo.keywords||n.keywords,n},share:function(t){var e,i=f(t.page,t.mag,{forProject:t.forProject,customDomain:t.customDomain}),n=t.mag.emptyTitle?"":t.mag.title;if(/^https?:\/\//i.test(t.host)||(t.host="http://"+t.host),t.exportBasePath&&(t.host+=t.exportBasePath),/\/$/i.test(t.host)||(t.host+="/"),e=t.forProject?"".concat(t.host).concat(t.customDomain&&!t.customDomainProfile?"":"".concat(t.mag.num_id,"/")):t.exportBasePath?"".concat(t.host).concat(t.page.uri||t.page.num,"/"):"".concat(t.host,"p").concat(t.page.num_id,"/"),t.publishedVersion){var r;if("facebook"===t.tp&&m("http://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(e)),"twitter"===t.tp)r=n?h({prefix:"I’ve just published a project ‘",val:n,suffix:"’"}):"I’ve just published a Project",m("https://twitter.com/share?url="+encodeURIComponent(e)+"&text="+encodeURIComponent(r));if("email"===t.tp){var a=encodeURIComponent((t.mag.is_private?"private ":"")+(n?"project ‘"+n+"’":"Project")),o="Check out my "+a,s="Hey, check out my new "+a+": "+e+(t.mag.is_private?encodeURIComponent("\n")+"Password: "+t.mag.pass:"");window.location.href="mailto:?subject="+o+"&body="+s}}else{if("facebook"===t.tp&&m("http://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(e)),"twitter"===t.tp&&m("https://twitter.com/share?url="+encodeURIComponent(e)+"&text="+encodeURIComponent(i.tweet)),"gplus"===t.tp&&m("https://plus.google.com/share?url="+encodeURIComponent(e)),"pinterest"===t.tp&&m("http://pinterest.com/pin/create/button/?url="+encodeURIComponent(e)+"&media="+encodeURIComponent(i.image)+"&description="+encodeURIComponent(i.title)),"linkedin"===t.tp&&m("http://www.linkedin.com/shareArticle?mini=true&url="+encodeURIComponent(e)+"&title="+encodeURIComponent(i.title)+(i.description?"&summary="+encodeURIComponent(i.description):""),552,460),"email"===t.tp){var c="Check out "+encodeURIComponent(i.title),l=c+encodeURIComponent("\n\n")+e+(t.mag.is_private?encodeURIComponent("\n")+"Password: "+t.mag.pass:"");window.location.href="mailto:?subject="+c+"&body="+l}if("report"===t.tp){var d="Report "+encodeURIComponent(e),u=encodeURIComponent("Please tell us why are you reporting this: ");window.location.href="mailto:support@readymag.com?subject="+d+"&body="+u}}if("report"!==t.tp){var p=t.source+" / "+t.tp+" ("+(t.forProject?"project":"page")+") / "+i.title+" ("+e+")";t.analytics&&t.analytics.sendEvent("Share",p)}}}},371:function(){}}]);